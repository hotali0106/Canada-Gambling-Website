"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}angular.module("casino",["ui.bootstrap","ui.router","ui.scrollpoint","ngSanitize","ngCookies","chieffancypants.loadingBar","pascalprecht.translate","casino.filters","casino.services","casino.directives","casino.controllers","casino.constants","casino.providers","timer","angular.lazyimg","myscrollfix","cgNotify","LocalStorageModule","infinite-scroll","angular-nicescroll","wt.responsive","zxcvbn","wt.responsive","casino.profile","ngFileUpload","vcRecaptcha","base64","oc.lazyLoad","ngTouch","rzSlider","licenseSGA","licenseMGA"]).config(["$httpProvider",function(e){e.defaults.withCredentials=!0,e.interceptors.push("apiHeaders")}]).config(["localStorageServiceProvider",function(e){e.setPrefix("")}]).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|bitcoin):/)}]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"/i18n/",suffix:".json"}).useSanitizeValueStrategy("").fallbackLanguage("en").useMissingTranslationHandler("missingTranslationHandlerFactory")}]).factory("missingTranslationHandlerFactory",function(){return function(e){var t=e;if(!e.includes(" ")){var n=_.last(e.split("."));t=n.charAt(0).toUpperCase()+n.slice(1)}return t}}).factory("sessionExpiredInterceptor",["$q","$location","$window","$timeout",function(e,t,n,a){function r(t){if(t.data&&t.data.errors){Object.keys(t.data.errors).includes("unauthorized")&&a(function(){n.location.reload()},300)}return e.reject(t)}return{responseError:r}}]).config(["$provide","$httpProvider",function(e,t){t.interceptors.push("sessionExpiredInterceptor")}]).config(["$provide",function(e){e.decorator("$state",["$delegate","$rootScope","SYSTEM",function(e,t,n){var a=e.href,r=e.transitionTo,o=function(e){return e=e||{},e.lang||(e.lang=t.currentLocale||n.DEFAULT_LANGUAGE||"en"),e.category&&"all"==e.category&&(e.provider&&"false"==e.provider||!e.provider)&&(e.category=""),e};return e.href=function(e,t,n){var r=a.apply(this,[e,o(t),n]);return _.isString(r)&&(r=r.replace(/%2F/g,"/")),r},e.transitionTo=function(e,t,n){return r.apply(this,[e,o(t),n])},e}])}]).config(["SYSTEM",function(e){e.DOMAIN&&(e.URL_API=e.DOMAIN+e.URL_API,e.URL_BATCH=e.DOMAIN+e.URL_BATCH)}]).config(["$urlRouterProvider",function(e){e.when("/play_for_real",["$state","$rootScope",function(e,t){e.go("app.users_sign_up",{lang:t.currentLocale})}]),e.rule(function(e,t){var n=t.path(),a=n.length;"/"==n[a-1]&&a>1&&(n=n.slice(0,a-1)),t.replace().path(n)})}]).config(["$locationProvider",function(e){e.html5Mode(!0),e.hashPrefix("!")}]).config(["$stateProvider","$urlMatcherFactoryProvider","AUTH_PARAMS","SYSTEM","FLAGS","ALLOW_QUERY_PARAMS",function(e,t,n,a,r,o){t.type("nonURIEncoded",{encode:function(e){return e||""},decode:function(e){return e||""},is:function(e){return!0}});var i=Object.keys(r).join("|"),s=o.join("|");e.state("app",{abstract:!0,url:"/{lang:(?:"+i+")}?"+s+"| *",template:"<ui-view/>",controller:"App",params:{lang:{value:a.DEFAULT_LANGUAGE||"en",squash:!0}},resolve:{language:["siteLanguage",function(e){return e.run()}]}}).state("home",{page_name:"home",url:"",parent:"app",templateUrl:"/app/Home/_home.html",reloadOnSearch:!1,params:{registration:{data:{},fields:{},errors:{}},show2fa:!1,showCaptcha:!1,credentialsAreCorrect:!1,from_game:!1,"back-url":null}}).state("app.game",{page_name:"game",url:"/game/{title}",params:{title:null,currency:null,identifier:null},controller:"Game",templateUrl:"/app/Game/_game_modal.html"}).state("app.games",{page_name:"games",url:"/games/{category}/{provider}",params:{filters:null,category:{value:null,squash:!0},provider:{value:"false",squash:!0},has_multiple_collections:!1,order:null,show_favorites:!1,jackpot:!1,currency:!1},templateUrl:"/app/Games/_games.html",controller:"GamesCategory"}).state("app.games_category",{page_name:"games_category",url:"/games/{category}",templateUrl:"/app/Games/_games.html",params:{filters:{}}}).state("app.users_sign_up",{page_name:"users_sign_up",url:"/users/sign_up",params:{registration:{data:{},fields:{},errors:{}}},templateUrl:function(){var e="";return"page"==n.SIGN_UP_MODE&&(e="/app/Auth/Registration/_registration.html"),e},controllerProvider:function(){var e="";return"page"==n.SIGN_UP_MODE&&(e="Registration"),"modal"==n.SIGN_UP_MODE&&(e="SignUpRedirectController"),e},data:{AUTH_PARAMS:n}}).state("app.users_sign_in",{page_name:"users_sign_in",url:"/users/sign_in",params:{show2fa:!1,showCaptcha:!1,credentialsAreCorrect:!1,"back-url":null},templateUrl:function(){var e="";return"page"===n.SIGN_IN_MODE&&(e="/app/Auth/Login/_login.html"),e},controllerProvider:function(){return{page:"LoginCtrl",modal:"SignInRedirectController"}[n.SIGN_IN_MODE]},data:{AUTH_PARAMS:n}}).state("app.users_password_new",{page_name:"users_password_new",url:"/users/password/new",controller:"ForgotPassword",templateUrl:"/app/Auth/ForgotPassword/_forgot_password.html"}).state("app.users_password_edit",{page_name:"users_password_edit",url:"/users/password/edit",controller:"ResetPasswordController",templateUrl:"/app/Auth/ResetPassword/_reset_password.html"}).state("app.users_confirmation_new",{page_name:"users_confirmation_new",url:"/users/confirmation/new",controller:"ConfirmationController",templateUrl:"/app/Auth/Confirmation/_confirmation.html"}).state("app.users_confirmation",{page_name:"users_confirmation",url:"/users/confirmation",controller:"ConfirmationController"}).state("app.users_unlock_new",{page_name:"users_unlock_new",url:"/users/unlock/new",controller:"UnlockController",templateUrl:"/app/Auth/Unlock/_unlock.html"}).state("app.users_unlock",{page_name:"users_unlock",url:"/users/unlock",controller:"UnlockController"}).state("app.auth_providers_confirmation",{page_name:"auth_providers_confirmation",url:"/profile/auth_providers/confirm?",controller:["$location","AuthSocialService",function(e,t){var n=e.search().confirmation_token;t.confirm(n)}]}).state("app.my_accounts",{page_name:"111",url:"/my-accounts/history",controller:["$state","ProfileModalService",function(e,t){e.go("home"),t.showProfileModal("history",{subTab:"transactions"})}]}).state("app.user_limit_confirmation",{page_name:"auth_providers_confirmation",url:"/profile/limits/confirm?",reloadOnSearch:!1,controller:["$location","LimitsService",function(e,t){var n=e.search().token;t.confirm(n),e.search("token",null)}]}).state("app.user_manage_subscriptions",{page_name:"auth_providers_confirmation",url:"/profile/subscriptions?",controller:["$location","SubscriptionsService",function(e,t){var n=e.search().subscription_token;t.onRecieveSubscriptionToken(n)}]}).state("app.accounts_payments",{page_name:"home",url:"/accounts/{currency}/{action:(?:deposit|cashout)}?redirected_from_game",parent:"app",controller:"AccountsRouteController"}).state("app.profile",{page_name:"home",url:"/profile",parent:"app",controller:"ProfileRoutesController"}).state("app.profile_urls",{page_name:"home",url:"/profile/{path:.*}",parent:"app",controller:"ProfileRoutesController"}).state("app.accounts_history",{page_name:"home",url:"/accounts/history",parent:"app",controller:"ProfileRoutesController"}).state("app.documents",{page_name:"home",url:"/documents",parent:"app",controller:"ProfileRoutesController"}).state("app.support",{page_name:"support",url:"/support",controller:"Support",templateUrl:"/app/Pages/Support/_support.html"}).state("app.landing",{page_name:"landing",url:"/landing",controller:"Landing",templateUrl:"/app/Pages/Landing/_landing.html"}).state("404",{page_name:"404",templateUrl:"/app/404/_404.html"}).state("app.cms",{page_name:"cms",url:"/{path:nonURIEncoded}",templateUrl:"/app/Pages/_page.html"}).state("app.external",{page_name:"external",url:"/{id:nonURIEncoded}",controller:"External"}).state("app.deposit",{page_name:"home",templateUrl:"/app/Home/_home.html",controller:["profile_routes","$rootScope",function(e,t){t.data.user&&t.data.user.currency?window.location.href=e.deposit[t.data.user.currency]:t.$on("successLoginAfterConfirmation",function(){t.data.user&&t.data.user.currency&&(window.location.href=e.deposit[t.data.user.currency])})}],resolve:{profile_routes:["ProfileRoute",function(e){return e.promise}]}})}]).run(["$rootScope","$location","$modalStack","UTM_PARAMS","Init","Auth","$state","$stateParams","siteLanguage","GamesData","FavoriteList","Autoscroll","$window","External","Ping","SYSTEM","CookiesPolicyService","CurrentIPService","$modal","REDIRECT_IP","Snippets","RzSliderOptions",function(e,t,n,a,r,o,i,s,c,u,l,d,f,m,p,g,h,_,y,v,b,$){function S(){var e=t.search(),n=a.reduce(function(t,n){return e[n]&&(t[n]=null),t},{});i.go(i.current.name,n,{notify:!1})}function w(){var n=t.path().replace(new RegExp(e.currentLocale+"(/|$)"),"");e.pathName=n}try{window!=window.top&&(window.top.location.href=window.location.href)}catch(e){console.error(e)}"object"==_typeof(g.CDN_SERVER)&&p.pongList(g.CDN_SERVER,g.CDN_SERVER[0],function(t){g.CDN_SERVER=t,e.CDN={SERVER:g.CDN_SERVER,ASSETS_PREFIX:g.CDN_ASSETS_PREFIX,COLOR:g.CDN_ASSETS_COLOR||"color"},e.$broadcast("pingedCdn")}),e.Autoscroll=d,e.CDN={SERVER:g.CDN_SERVER,ASSETS_PREFIX:g.ASSETS_PREFIX,COLOR:g.CDN_ASSETS_COLOR||"color"};var C=new MobileDetect(window.navigator.userAgent);e.data={user:{},restrictions:{},state:i,window:f,games:u,favorites:l,device:C.mobile()?"mobile":"desktop",browser:C.userAgent(),OS:C.os()},e.page={title:"",snippet_title:""},e.accessLevels=o.accessLevels,e.user=o.user,e.demo_mode=!1,e.state=i,e.Info={},c.init(),h.init();var A=e.$on("localeChanged",function(){function t(e,t){return e.filter(function(e){return e.country===t.country_code}).find(function(e){return t.region_code===e.region_code})}u.init();var n=_.init();v.enabled&&n.then(function(){var n=t(v.countries,e.data.current_ip);n&&y.open(_defineProperty({template:'<redirect-ip country="$ctrl.country" template="redirect-ip.template"><redirect-ip>',windowClass:"modal-login",controller:"RedirectCtrl",backdrop:"static",keyboard:!1,controllerAs:"$ctrl"},"controller",function(){this.country=n}))}),A()});e.$watch(function(){return t.path()},function(t,n){"app.game"===i.current.name&&e.actualLocation===t&&i.go("app.game",s,{location:"replace"}),"app.game"===i.current.name&&"app.game"!==e.fromState.name&&(e.restoreState=e.fromState,e.restoreStateParams=e.fromStateParams)}),e.$on("$stateChangeStart",function(){e.mainModal.close(),e.page.title=""}),e.$on("$locationChangeSuccess",function(){e.depositModal&&e.depositModal.close(),e.actualLocation=t.path()}),e.$on("localeChanged",function(){w()}),e.$on("$stateChangeSuccess",function(t,n,a,r,o){e.toParams=a,e.fromState=r,e.fromStateParams=o,w()}),e.$on("siteLoaded",function(){m.init({GTM:S})}),e.mainModal={close:function(){try{e.mainModal.modal&&e.mainModal.modal.close()}catch(e){}},modal:null,dismissAll:function(){n.dismissAll()}},$.options({ceil:100}),window.appVersion="6.9.1 (2020-12-9 09:32:36)"}]);var CasinoFilters=angular.module("casino.filters",[]),CasinoServices=angular.module("casino.services",["ngResource"]),CasinoControllers=angular.module("casino.controllers",[]),CasinoDirectives=angular.module("casino.directives",[]),CasinoConstants=angular.module("casino.constants",[]),CasinoProviders=angular.module("casino.providers",[]);angular.module("casino.profile",[]),angular.module("instantpay",["casino"]).run(["$rootScope","$modal","$timeout","$window",function(e,t,n,a){}]),CasinoConstants.constant("SYSTEM",{URL_API:"/api",URL_BATCH:"/batch",DEFAULT_LANGUAGE:"en",API_REQUEST_ACCEPT:"application/vnd.softswiss.v1+json",X_SoftSwiss_Media_Type:"softswiss.v1",notification:{config:{position:"right"}},INVISIBLE_COLLECTIONS:["home","hot","top","hd","accumulating"],CDN_SERVER:["https://cdn2.softswiss.net","https://cdn.softswiss.net/"],CDN_ASSETS_PREFIX:"",CDN_ASSETS_SIZE:["s3","s4"],CDN_ASSETS_TYPE:"",CDN_ASSETS_BACK_TYPE:"",CDN_ASSETS_COLOR:"color",GOOGLE_TAG_MANAGER_ID:"GTM-KLRDNJG",YANDEX_METRIKA:"",STATUSES:{SHOW_CHANGE_STATUS_WINDOW:!0,CURRENT_STATUS_GROUP:""},LIVECHATIC:{license:9691740,chat_between_groups:!1},GAME_NOTIFICATION:{DURATION:6e4,AUTO_SWITCH_CURRENCY:!0,BALANCE:{EUR:{MIN:.5},AUD:{MIN:.5}}},AFTER_LOGIN_REDIRECT:"home",INCOME_ACCESS_AFF_SERVER:"",PASSWORD_STRENGTH:{AVAILABLE:!0,SCORE:0},ENABLE_CONTEXT_EDIT:!0,ENABLE_MULTISTEP_AUTH:!1,ANON_CAN_PLAY_FOR_FUN:!0,MGA:{game_license_hint:[{provider:{except:["netent"]},translate_key:"frontend.game_license_hint.default"}]},ENABLE_TERMS_UPDATED_POPUP:!0,ENABLE_TERMS_TEXT_POPUP:!1,ENABLE_PWA:!1,MOBILE_GAME_ON_CURRENT_DOMAIN:!0,CURRENT_DOMAIN_EXCLUDE_PROVIDERS:["evolution","novomatic","pragmaticexternal","endorphina","relax"],NEW_LOCALE_FLOW:!0,ENABLE_NEW_PROFILE:!0,SHOW_DEFAULT_LOCALE_IN_URL:!1}),function(){angular.module("casino.constants").constant("UTM_PARAMS",["utm_source","utm_medium","utm_campaign","utm_content","utm_term"]).constant("ALLOW_QUERY_PARAMS",["ctag","btag","stag","qtag","refer","subid","token","gclid","__layerref","confirmation_token","unlock_token","reset_password_token","subscription_token","utm_source","utm_medium","utm_campaign","utm_content","utm_term","redirected_from_game","back-url"])}(),CasinoControllers.controller("App",["$rootScope","siteLanguage","language","$translate","Init","Snippets","GamesData","Restrictions","$state","$location","$window","SeoData",function(e,t,n,a,r,o,i,s,c,u,l,d){if(s.checkAuth("auth_actions_forbidden",!0))return!1;u.search().redirected_from_game&&l.sessionStorage.getItem("savedGameState")||l.sessionStorage.removeItem("savedGameState"),n&&(d.init(c),r.data(),o.add(function(){e.page.snippet_title=o.getByName("casino-title").content}))}]),CasinoFilters.filter("unique",function(){return function(e,t){var n,a={},r=e.length,o=[];for(n=0;n<r;n+=1)a[e[n][t]]=e[n];for(n in a)o.push(a[n]);return o}}).filter("casino_currency",["$filter","GamesData",function(e,t){return function(t,n,a){return n&&-1==n.toLowerCase().indexOf("btc")?e("currency")(t,n,a):t+" "+n}}]).filter("humanized_currency",["Info","$filter",function(e,t){function n(t,n,i){var s="-";return r?s=a(t,n,i):!1===o&&(o=!0,e.currencies().$promise.then(function(e){r=e,o=!1})),s}function a(e,n,a){function o(e,t){return{code:t.code,symbol:t.symbol,amount:parseFloat((e/t.subunits_to_unit).toFixed(2))}}var i=r.find(function(e){return e.code===n}),s=function(e,t){if(0===e)return o(e,t);var n=t.subcurrencies||[],a=[t].concat(_toConsumableArray(n)).reverse(),r=function t(n){var a=_toArray(n),r=a[0],o=a[1],i=a.slice(2);return!o||e<o.subunits_to_unit?r:t([o].concat(_toConsumableArray(i)))}(a);return o(e,r)}(e,i),c=s.amount,u=s.symbol,l=s.code;return a&&a.codeFirst?l+" ("+c+")":a&&a.onlyNumber?c:a&&a.showCode?c+" "+l:a&&a.onlyCode?l:t("currency")(c,u)}var r=null,o=!1;return n.$stateful=!0,n}]).filter("currency_code_to_symbol",["$rootScope",function(e){return function(t){if(e.Info){return _.findWhere(e.Info.currencies,{code:t}).symbol}return""}}]).filter("html",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]).filter("anonymize",function(){return function(e,t){for(var n="",a=0;a<t;a++)n+="*";return e.slice(0,-t)+n}}).filter("capitalize",function(){return function(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}}).filter("invertObj",function(){return function(e){return _.invert(e)}}),angular.module("landing",["casino"]).run(["$rootScope","$translate","Init",function(e,t,n){t.use(document.documentElement.lang.slice(0,2)),n.data()}]),angular.module("myscrollfix",[]).directive("uiScrollfix",["$window","$timeout",function(e,t){function n(){return angular.isDefined(e.pageYOffset)?e.pageYOffset:(document.compatMode&&"BackCompat"!==document.compatMode?document.documentElement:document.body).scrollTop}return{require:"^?uiScrollfixTarget",link:function(a,r,o,i){function s(){if(0==e.scrollTop)return!1;var a=u?o.uiScrollfix:f(r[0]).top+l,s=i?d[0].scrollTop:n();-1==a?t(function(){m||e.scrollTo(0,0)},0):a>=0&&(m=!0),!r.hasClass("ui-scrollfix")&&s>a&&a>0?(r.addClass("ui-scrollfix"),c=a):r.hasClass("ui-scrollfix")&&s<c&&r.removeClass("ui-scrollfix")}var c,u=!0,l=0,d=i&&i.$element||angular.element(e),f=function(e){for(var t=0,n=0;e;)t+=parseFloat(e.offsetTop),n+=parseFloat(e.offsetLeft),e=e.offsetParent;return{top:Math.round(t),left:Math.round(n)}};o.uiScrollfix?"string"==typeof o.uiScrollfix&&("-"===o.uiScrollfix.charAt(0)?(u=!1,l=-parseFloat(o.uiScrollfix.substr(1))):"+"===o.uiScrollfix.charAt(0)&&(u=!1,l=parseFloat(o.uiScrollfix.substr(1)))):u=!1,c=u?o.uiScrollfix:f(r[0]).top+l;var m=!1;d.on("scroll",s),a.$on("$destroy",function(){d.off("scroll",s)})}}}]),function(e){var t={roles:["public","user"],accessLevels:{public:"*",anon:["public"],user:["user"]}};e.userRoles=function(e){var t="01",n={};for(var a in e){var r=parseInt(t,2);n[e[a]]={bitMask:r,title:e[a]},t=(r<<1).toString(2)}return n}(t.roles),e.accessLevels=function(e,t){var n={};for(var a in e)if("string"==typeof e[a])if("*"==e[a]){var r="";for(var o in t)r+="1";n[a]={bitMask:parseInt(r,2)}}else console.log("Access Control Error: Could not parse '"+e[a]+"' as access definition for level '"+a+"'");else{var r=0;for(var o in e[a])t.hasOwnProperty(e[a][o])?r|=t[e[a][o]].bitMask:console.log("Access Control Error: Could not find role '"+e[a][o]+"' in registered roles while building access for '"+a+"'");n[a]={bitMask:r}}return n}(t.accessLevels,e.userRoles)}("undefined"==typeof exports?window.routingConfig={}:exports),CasinoServices.factory("apiHeaders",["$q","SYSTEM","$rootScope",function(e,t,n){var a=/^(\/\w{2}([-_]\w{2})?)?\/(profile|oauth|accounts\/)/;return{request:function(e){if(e.headers.Accept=t.API_REQUEST_ACCEPT,!t.NEW_LOCALE_FLOW&&n.currentLocale&&(e.headers["Accept-Language"]=n.currentLocale),e.headers["Content-Type"]="application/json;charset=UTF-8",e.url.indexOf("/api/player/documents")>-1&&(e.headers["Content-Type"]=void 0),t.PASSWORD_SHA256&&e.data&&e.data.user&&(e.data.user.password||e.data.user.password_confirmation||e.data.user.current_password)){var a=function(e){var t=new jsSHA("SHA-256","TEXT");return t.update(e),t.getHash("HEX")};e.data.user.password&&(e.data.user.password=a(e.data.user.password)),e.data.user.password_confirmation&&(e.data.user.password_confirmation=a(e.data.user.password_confirmation)),e.data.user.current_password&&(e.data.user.current_password=a(e.data.user.current_password))}return e},response:function(e){if(-1!=e.config.url.indexOf("api/users")){var t=e.headers("Location")||"";0==t.indexOf("http")&&(window.location.href=t),a.test(t)&&(window.location.href=window.location.origin+t)}return e}}}]).factory("Init",["$rootScope","$location","$http","Batch","Pages","SYSTEM","Info","Auth","Player","$q",function(e,t,n,a,r,o,i,s,c,u){return e.$on("localeChanged",function(t,n){r.files({l:n},function(t){e.Info.files=t})}),i.project().$promise.then(function(t){e.data.license=t.license,e.$broadcast("licenseInited",t)}),{data:function(t){t=t||function(){};var r=["/api/info/currencies","/api/info/time_zones","/api/info/countries"];e.Info=e.Info||{},u.all({batch:a.get({"url[]":r}).$promise,country_codes:function(){var e=u.defer();return n.get("/resources/countrycodes.json").success(function(t){var n=_.mapObject(t,function(e,n){return t[n].dial_code});e.resolve(n)}).error(function(){e.reject("Failed to get countrycodes")}),e.promise}()}).then(function(n){r.forEach(function(t,a){var r=t.split("/"),o=r.pop(),i=r.pop();"games"==i&&"order"==o&&(o=i+"_"+o),e.Info[o]=JSON.parse(n.batch[a]),e.Info.country_codes=n.country_codes}),e.$broadcast("currenciesUpdated"),t()})}}}]).factory("Info",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/info/:action",{},{locales:{method:"GET",params:{action:"locales"},cache:!0,isArray:!0},currencies:{method:"GET",params:{action:"currencies"},cache:!0,isArray:!0},statuses:{method:"GET",params:{action:"statuses"},cache:!0,isArray:!0,transformResponse:function(e){return angular.fromJson(e)}},player_fields:{method:"GET",params:{action:"player_fields"},cache:!0,isArray:!1},profile_fields:{method:"GET",params:{action:"profile_fields"},cache:!0,isArray:!0},profile_routes:{method:"GET",params:{action:"profile_routes"},cache:!0,transformResponse:function(e){return t.DOMAIN&&(e=e.replace(/":"\//g,'":"'+t.DOMAIN+"/")),angular.fromJson(e)}},auth_providers_routes:{method:"GET",params:{action:"auth_providers_routes"},cache:!0,transformResponse:function(e){return t.DOMAIN&&e&&(e=e.replace(/\/users/g,t.DOMAIN+"/users")),angular.fromJson(e)}},auth_providers:{method:"GET",params:{action:"auth_providers"},cache:!0,isArray:!0},project:{method:"GET",params:{action:"project"},cache:!0,isArray:!1}})}]).factory("Pages",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/cms/:action/:id",{},{list:{method:"GET",params:{action:"pages"},cache:!0,isArray:!0},byId:{method:"GET",params:{action:"pages"},cache:!0},files:{method:"GET",params:{action:"files"},cache:!0,isArray:!0,transformResponse:function(e){return t.DOMAIN&&(e=e.replace(/\/system/g,t.DOMAIN+"/system")),angular.fromJson(e)}},snippets:{method:"GET",params:{action:"snippets"},cache:!0,isArray:!0}})}]).factory("Batch",["$resource","SYSTEM",function(e,t){return e(t.URL_BATCH,{},{get:{method:"get",params:{},cache:!1,isArray:!0}})}]).factory("User",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/users/:action",{},{sign_in:{method:"post",params:{action:"sign_in"}},sign_up:{method:"post",params:{action:""}},change_password:{method:"put",params:{action:""}},forgot_password:{method:"post",params:{action:"password"}},reset_password:{method:"put",params:{action:"password"}},sign_out:{method:"delete",params:{action:"sign_out"}},sent_email_confirmation:{method:"post",params:{action:"confirmation"}},email_confirmation:{method:"get",params:{action:"confirmation"}},sent_unlock_email:{method:"post",params:{action:"unlock"}},unlock_email:{method:"get",params:{action:"unlock"}}})}]).factory("Player",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/player/:entity/:device",{},{get:{method:"get",params:{entity:""}},patch:{method:"patch",params:{entity:""}},balance:{method:"get",params:{entity:"accounts"},isArray:!0},select_account:{method:"post",params:{entity:"accounts"}},stats:{method:"get",params:{entity:"stats"},isArray:!1},bonuses:{method:"get",params:{entity:"bonuses"},isArray:!0},freespins:{method:"get",params:{entity:"freespins"},isArray:!0},comp_points:{method:"get",params:{entity:"comp_points"}},settings:{method:"get",params:{entity:"settings"}},games:{method:"GET",params:{entity:"games"},isArray:!0},reality_check:{method:"GET",params:{entity:"reality_check"},isArray:!1},update_bonus_settings:{method:"PATCH",params:{entity:"update_bonus_settings"},isArray:!1},set_bonus_code:{method:"PATCH",params:{entity:"set_bonus_code"},isArray:!1},clear_bonus_code:{method:"DELETE",params:{entity:"clear_bonus_code"},isArray:!1},accumulated_loss:{method:"GET",params:{entity:"accumulated_loss"},isArray:!1},getUnfinishedGamesByDevice:{method:"GET",params:{entity:"unfinished_games",device:"@device"},isArray:!1},status_groups:{method:"GET",params:{entity:"status_groups"},isArray:!0}})}]).factory("FreespinsResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/player/freespins/:id/:action",{},{get:{method:"get",isArray:!0},activateById:{method:"post",params:{id:"@id",action:"activation"}},deactivateById:{method:"delete",params:{id:"@id"}}})}]).factory("PlayerAccounts",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/player/accounts/:currency",{},{balance:{method:"get",params:{currency:null},isArray:!0},select_account:{method:"post",params:{currency:null}},remove:{method:"delete",params:{currency:"@currency"}}})}]).factory("LotteryResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/lotteries/:id/:action",{},{list:{method:"get",params:{action:null,id:null},isArray:!0},statuses:{method:"get",params:{action:"statuses",id:null},isArray:!0}})}]).factory("TournamentResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/tournaments/:id/:action",{},{list:{method:"get",params:{action:null,id:null},isArray:!0},statuses:{method:"get",params:{action:"statuses",id:null},isArray:!0}})}]).factory("WinnersResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/stats/winners/:type/:currency",{},{latest:{method:"get",params:{type:"latest"},cache:!1,isArray:!0},get:{method:"get",params:{type:"top"},cache:!1,isArray:!0},BTC:{method:"get",params:{type:"top",currency:"BTC"},cache:!1,isArray:!0}})}]).factory("AuthProviders",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/auth_providers/:action",{},{update_details:{method:"post",params:{action:"update_details"}}})}]).factory("CurrentIPResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/current_ip",{},{get:{method:"get"}})}]).factory("Locales",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/player/update_locale",{},{update_locale:{method:"patch",params:{locale:"@locale"}}})}]).factory("Jackpots",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/games/jackpots",{},{list:{method:"GET",isArray:!1,cache:!0}})}]),function(){function e(e,t){return e(t.URL_API+"/games/:action/:device/:provider/:identifier",{},{list:{method:"get",params:{action:""},cache:!0,isArray:!0},demo:{method:"get",params:{action:"demo"},cache:!0,isArray:!0},collections:{method:"get",params:{action:"collections"},cache:!1,isArray:!0},providers:{method:"get",params:{action:"providers"},cache:!1,isArray:!0},order:{method:"get",params:{action:"order"},cache:!1,isArray:!1},currencies:{method:"get",params:{action:"currencies"},cache:!0,isArray:!0},jackpots:{method:"get",params:{action:"jackpots"},cache:!0,isArray:!1},limits:{method:"get",params:{action:"limits"},cache:!0,isArray:!1},getByDevice:{method:"get",params:{device:"@device"},cache:!1,isArray:!1},fetchDescription:{method:"get",params:{action:"descriptions",provider:"@provider",identifier:"@identifier"},cache:!0,isArray:!1},getMetaTitle:{method:"get",params:{action:"meta_titles",provider:"@provider",identifier:"@identifier"},cache:!0,isArray:!1},getMetaDescription:{method:"get",params:{action:"meta_descriptions",provider:"@provider",identifier:"@identifier"},cache:!0,isArray:!1}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("Games",e)}(),function(){function e(e,t,n){function a(){_.filter(_.union(r.collections_origin,r.collections),function(e){return e.id===t.params.category}).length||"all"===t.params.category||t.go("404")}e.games_data=n;var r=n.data;t.params.category&&(r.collections_origin&&r.collections_origin.length&&a(),e.$watchCollection("games_data.data.collections_origin",function(e,t){(_.isArray(t)&&_.isArray(e)&&t.length!=e.length||!t&&_.isArray(e)&&e.length)&&a()}))}e.$inject=["$scope","$state","GamesData"],angular.module("casino.profile").controller("GamesCategory",e)}(),function(){function e(e,t){function n(){s=e.CDN_SERVER.replace(/\/$/,""),e.CDN_ASSETS_PREFIX&&(s=[s,e.CDN_ASSETS_PREFIX].join("/"));var t=[];e.CDN_ASSETS_SIZE=e.CDN_ASSETS_SIZE||"s1",t=_.isString(e.CDN_ASSETS_SIZE)?[e.CDN_ASSETS_SIZE]:e.CDN_ASSETS_SIZE,c=t.map(function(e){var t={};return t[e]=[s,"i",e,""].join("/"),t}),u=[s,"b",""].join("/")}function a(e,t){n();for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(e[a].icons=r(e[a],t),e[a].icon_cdn_path=e[a].icons[Object.keys(e[a].icons)[0]],e[a].background_cdn_path=o(e[a]));return e}function r(n,a){return e.MULTI_IMAGES&&(l=t.currentLocale.split("-")[0].toLowerCase(),d=i(n)?"."+l:""),c.reduce(function(e,t){var r=Object.keys(t)[0];return e[r]=t[r]+n.identifier+d+"."+a,e},{})}function o(t){return u+t.identifier+"."+(e.CDN_ASSETS_BACK_TYPE||"jpg")}function i(t){return e.MULTI_IMAGES[t.provider]&&-1!==e.MULTI_IMAGES[t.provider].indexOf(l)}var s,c,u,l,d="";return{iconURIforEach:a}}e.$inject=["SYSTEM","$rootScope"],angular.module("casino.services").factory("GamesCdn",e)}(),function(){function e(e,t,n,a){function r(e,t){p=e,u=t;var n=Object.keys(e[t]).map(function(t){return e[u][t]}),a=_.compact(n.map(function(e){return e.game_info.payout})),r=_.compact(n.map(function(e){return e.game_info.hit_rate}));l=Math.floor(Math.min.apply(Math,_toConsumableArray(a))),d=Math.ceil(Math.max.apply(Math,_toConsumableArray(a))),f=Math.floor(Math.min.apply(Math,_toConsumableArray(r))),m=Math.ceil(Math.max.apply(Math,_toConsumableArray(r))),l=l<0||l>100?0:l,d=d<0||d>100?100:d,f=f<0||f>100?0:f,m=m<0||m>100?100:m}function o(e){return g[e]}function i(e,t){g[e]=new c(t)}function s(){Object.keys(g).forEach(function(e){g[e].changeFilter()})}function c(n){function a(t){var n=p[u];if(!n)return[];if(_.isNumber(l)&&(_.isNumber(g.data.payout.sliderOptions.floor)||(g.data.payout.sliderOptions.floor=l),(g.data.payout.minValue<g.data.payout.sliderOptions.floor||!_.isNumber(g.data.payout.minValue)||_.isNaN(g.data.payout.minValue))&&(g.data.payout.minValue=g.data.payout.sliderOptions.floor,g.data.payout.minValueTemp=g.data.payout.sliderOptions.floor)),_.isNumber(d)&&(_.isNumber(g.data.payout.sliderOptions.ceil)||(g.data.payout.sliderOptions.ceil=d),(g.data.payout.maxValue>g.data.payout.sliderOptions.ceil||!_.isNumber(g.data.payout.maxValue)||_.isNaN(g.data.payout.maxValue))&&(g.data.payout.maxValue=g.data.payout.sliderOptions.ceil,g.data.payout.maxValueTemp=g.data.payout.sliderOptions.ceil)),_.isNumber(f)&&(_.isNumber(g.data.hit_rate.sliderOptions.floor)||(g.data.hit_rate.sliderOptions.floor=f),(g.data.hit_rate.minValue<g.data.hit_rate.sliderOptions.floor||!_.isNumber(g.data.hit_rate.minValue)||_.isNaN(g.data.hit_rate.minValue))&&(g.data.hit_rate.minValue=g.data.hit_rate.sliderOptions.floor,g.data.hit_rate.minValueTemp=g.data.hit_rate.sliderOptions.floor)),_.isNumber(m)&&(_.isNumber(g.data.hit_rate.sliderOptions.ceil)||(g.data.hit_rate.sliderOptions.ceil=m),(g.data.hit_rate.maxValue>g.data.hit_rate.sliderOptions.ceil||!_.isNumber(g.data.hit_rate.maxValue)||_.isNaN(g.data.hit_rate.maxValue))&&(g.data.hit_rate.maxValue=g.data.hit_rate.sliderOptions.ceil,g.data.hit_rate.maxValueTemp=g.data.hit_rate.sliderOptions.ceil)),_.isArray(t.collection)){var a=r(t.collection),o=Object.keys(a).map(function(t){var r=a[t].map(function(t){return e("gameCollections")(n,t)});return _.unique(_.union.apply(null,r))});n=_.intersection.apply(null,o)}else n=e("gameCollections")(n,t.collection);return n=e("gameProvider")(n,t.provider),n=e("gamesWithCurrency")(n,t.currency),
t.with_demo||(n=e("gamesWithFun")(n,t.with_demo)),""!=t.title&&(n=e("gameTitle")(n,t.title)),0!=t.azOrder?n=e("gameOrderAZ")(n,t.azOrder):t.collectionOrder&&(n=e("orderByCollection")(n,t.collectionOrder)),n=e("gameVolatility")(n,t.volatility_rating),n=e("gameLinesAndWays")(n,t.lines_and_ways),n=e("gameHitRate")(n,t.hit_rate),n=e("gamePayout")(n,t.payout)}function r(e){return e.reduce(function(e,t){var n;return n=t.includes("/")?t.split("/")[0]:"unnamed",e[n]=e[n]||[],e[n].push(t),e},{})}function o(e){e=e||{},clearTimeout(c),e.currency&&(g.data.currency=e.currency),e.azOrder&&(g.data.azOrder=e.azOrder),null===e.volatility_rating&&(g.data.volatility_rating=e.volatility_rating),null===e.lines_and_ways&&(g.data.lines_and_ways=e.lines_and_ways),e.hit_rate&&(g.data.hit_rate=e.hit_rate),e.payout&&(g.data.payout=e.payout),e.collection&&!e.collectionOrder&&-1==["novelty","popularity"].indexOf(g.data.collectionOrder)&&("string"==typeof e.collection?e.collectionOrder=e.collection:1==e.collection.length?e.collectionOrder=e.collection[0]:e.collectionOrder="all"),Object.keys(e).forEach(function(t){g.data[t]=e[t]}),e.title&&""!=e.title?c=t(function(){g.games=a(g.data)},500):g.games=a(g.data)}function i(e){if(e.collection&&(e.collection=e.collection.toLowerCase()),e.collection&&"string"==typeof e.collection&&(e.collection=[e.collection]),e.collection&&"all"!==g.data.collection){var t=g.data.collection;"string"==typeof t&&(t=[t]),e.collection=_.union(t,e.collection)}if(e.provider&&"string"==typeof e.provider&&(e.provider=[e.provider]),e.provider){var n=g.data.provider;"string"==typeof n&&(n=[n]),e.provider=_.union(n,e.provider)}if(e.volatility_rating&&(e.volatility_rating=e.volatility_rating.toLowerCase()),e.volatility_rating&&"string"==typeof e.volatility_rating&&(e.volatility_rating=[e.volatility_rating]),e.volatility_rating){var a=g.data.volatility_rating;"string"==typeof a&&(a=[a]),e.volatility_rating=_.union(a,e.volatility_rating)}if(e.lines_and_ways&&"number"==typeof e.lines_and_ways&&(e.lines_and_ways=[e.lines_and_ways]),e.lines_and_ways){var r=g.data.lines_and_ways;"number"==typeof r&&(r=[r]),e.lines_and_ways=_.union(r,e.lines_and_ways)}o(e)}function s(e){var t={};e.collection&&"string"==typeof e.collection&&(e.collection=[e.collection]);var n=g.data.collection;e.collection&&"all"!==g.data.collection&&("string"==typeof n&&(n=[n]),n=_.difference(n,e.collection),n.length||(n="all")),e.provider&&"string"==typeof e.provider&&(e.provider=[e.provider]);var a=g.data.provider;e.provider&&("string"==typeof a&&(a=[a]),a=_.difference(a,e.provider),a.length||(a=!1)),e.volatility_rating&&"string"==typeof e.volatility_rating&&(e.volatility_rating=[e.volatility_rating]);var r=g.data.volatility_rating;e.volatility_rating&&("string"==typeof r&&(r=[r]),r=_.difference(r,e.volatility_rating),r.length||(r=null)),e.lines_and_ways&&"number"==typeof e.lines_and_ways&&(e.lines_and_ways=[e.lines_and_ways]);var i=g.data.lines_and_ways;e.lines_and_ways&&("number"==typeof i&&(i=[lines_and_ways]),i=_.difference(i,e.lines_and_ways),i.length||(i=null)),t.collection=n,t.provider=a,t.volatility_rating=r,t.lines_and_ways=i,o(t)}var c=!1,g=this;g.games=[],g.data={device:u,collection:"all",provider:!1,title:"",with_demo:!0,collectionOrder:"all",azOrder:0,currency:!1,volatility_rating:null,lines_and_ways:null,hit_rate:{minValue:0,maxValue:100,error:{min:!1,max:!1},sliderOptions:{}},payout:{minValue:0,maxValue:100,error:{min:!1,max:!1},sliderOptions:{}}},g.changeFilter=o,g.addMultiplyFilter=i,g.removeMultiplyFilter=s,g.changeFilter(n)}var u,l,d,f,m,p={},g={};return{init:r,getFilterByName:o,createNewFilter:i,changeAllFilters:s}}e.$inject=["$filter","$timeout","$rootScope","SYSTEM"],angular.module("casino.services").factory("GamesDataFilters",e)}(),function(){function e(e,t,n,a,r,o,i,s,c,u,l,d,f,m){function p(e){_.assign(this,e)}function g(){if($e.inited)return!1;v(),t.all({winners:d.getAll(),currencies:f.currencies().$promise,device_games:c.getByDevice({device:"allowed_"+de}).$promise,providers:c.providers().$promise,limits:c.limits().$promise,collections:c.collections({l:e.currentLocale}).$promise,games_info:u.list().$promise}).then(function(e){return h().then(function(t){return e.unfinished_device_games=t,Promise.resolve(e)})}).then(function(t){y({winners:t.winners,currencies:t.currencies,device_games:t.device_games.toJSON(),unfinished_device_games:t.unfinished_device_games,providers:t.providers,limits:t.limits,collections:t.collections,games_info:t.games_info}),$e.inited=!0,e.$broadcast("gamesInitialized",$e.data.games.by_identifier)})}function h(){return e.data.user&&e.data.user.email?m.getUnfinishedGamesByDevice({device:de}).$promise.then(function(e){return e.toJSON()}):Promise.resolve({})}function y(e){ve.currencies=_.indexBy(e.currencies,"code"),pe=ve.currencies,_e=e.limits,ye=e.games_info;var t={};e.device_games=oe(e.unfinished_device_games,e.device_games),t[de]=A(e.device_games),_.assign(ce,t),ve.games.by_identifier=t[de],ve.jackpots=ge,ve.collections_origin=e.collections,ve.collections=I(ve.collections_origin),ve.tags=S(ve.collections),ve.game_info_tags=w(ce[de]),ve.providers=T(e.providers),ve.winners=d.prepareAllWinners(e.winners,ce[de]),ve.providersByCollections=L(ce[de]),l.init(ce,de),l.changeAllFilters(),M(),x(t[de]),t[de]=be.reduce(function(e,t){return t(e)},t[de])}function v(e){if(e=e||function(){},se)e(se);else{var t=new Image;t.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t.onload=function(){se="webp",e("webp")},t.onerror=function(){se="png",e("png")}}}function b(){$e.inited&&($e.inited=!1,ce={},ue={},le=new MobileDetect(window.navigator.userAgent),de=le.mobile()?"mobile":"desktop",fe=[],me=[],pe={},ge={},he={},_e={},ve={games:{by_identifier:{},by_id:ue},jackpots:{},collections:[],providers:[],providersByCollections:{},winners:{},currencies:{}},g())}function $(e){be.push(e)}function S(e){return e.reduce(function(e,t){var n;return n=t.id.includes("/")?t.id.split("/")[0]:"unnamed",e[n]=e[n]||[],e[n].push(t),e},{})}function w(e){var t={hit_rate:[],lines:[],payout:[],volatility_rating:[],ways:[]};Object.keys(e).forEach(function(n){Object.keys(t).forEach(function(a){t[a].push(C(e[n].game_info[a]))})}),Object.keys(t).forEach(function(e){t[e]=_.compact(_.uniq(t[e]))}),t.lines_and_ways=_.uniq(_.union(t.lines,t.ways)),delete t.lines,delete t.ways,["payout","hit_rate"].forEach(function(e){t[e]=t[e].map(function(e){return Number(e)})}),Object.keys(t).forEach(function(e){t[e]=_.sortBy(t[e],function(e){return e})});var n={low:0,"low-medium":1,medium:2,"medium-high":3,high:4,"very-high":5};return t.volatility_rating=_.sortBy(t.volatility_rating,function(e){return n[e]}),t}function C(e){return"string"==typeof e?e.toLowerCase():e}function A(e){var t=_.map(e,function(e,t){return e.identifier=t,e});return ge=k(t),t=t.map(function(e){return _.chain(e).tap(Y).tap(F).tap(N).tap(j).tap(z).tap(W).value(),new p(e)}),_.assign(ue,P(t)),me=R(t),fe=O(t),_.indexBy(t,"identifier")}function E(){ve.collections_origin&&(ve.collections=I(ve.collections_origin),ve.providersByCollections=L(ce[de]))}function I(t){var n=angular.copy(t).filter(V),a=_.pluck(n,"id"),r=_.uniq(a.map(function(e){return e.split(":")[0]})),o=r.map(function(t){return a.indexOf(t+":"+e.currentLocale)>-1?t=t+":"+e.currentLocale:a.indexOf(t)>-1||(t=null),t}).filter(function(e){return!!e});return o=o.map(function(e){var t=n.find(function(t){return t.id===e});return t.id=t.id.split(":")[0],t.selected=!1,t.disabled=!1,t})}function T(e){var t=[];for(var n in e)-1!==fe.indexOf(e[n].id)&&t.push(e[n]);return t}function L(t){var n={};return Object.keys(t).forEach(function(a){var r=t[a];r.collections.filter(function(t){if(t.includes(":")){return r.collections.find(function(n){return t===n.split(":")[0]+":"+e.currentLocale})}return!r.collections.some(function(e){return e.includes(t+":")})}).map(function(e){return e.split(":")[0]}).forEach(function(e){Object.keys(n).indexOf(e)<0&&(n[e]=[]),n[e].indexOf(r.provider)<0&&n[e].push(r.provider)})}),n}function P(e){var t={};return e.forEach(function(e){_.map(e.currencies,function(e,t){return e.code=t,e}).forEach(function(n){t[n.id]=e.identifier})}),t}function k(e){var t={};return e.forEach(function(e){_.mapObject(e.real,function(e,n){e.jackpot&&(t[n]=t[n]||0,t[n]+=e.jackpot)})}),Object.keys(t).forEach(function(e){t[e]=t[e]/pe[e].subunits_to_unit}),t}function R(e){var t=[];return e.forEach(function(e){for(var n in e.collections)t.push(e.collections[n])}),_.uniq(t)}function O(e){return _.uniq(_.pluck(e,"provider"))}function M(){a(function(){d.initLatestWinners(ve.winners,ce[de])},1e4)}function x(t){"object"==_typeof(i.CDN_SERVER)?e.$on("pingedCdn",function(){D(t)}):D(t)}function D(e){v(U(e))}function U(t){return function(n){if(i.MULTI_IMAGES)if(e.currentLocale)s.iconURIforEach(t,n);else var a=e.$on("localeChanged",function(){s.iconURIforEach(t,n),a()});else s.iconURIforEach(t,n)}}function B(e){return Boolean(e.demo)}function N(e){var t=["novelty","popularity"];return e.collections=_.difference(_.keys(e.order),t),e}function F(e){return e.order=angular.copy(e.collections),e}function j(e){return e.currencies=angular.copy(e.real)||[],B(e)&&(e.currencies.FUN={}),_.mapObject(e.currencies,function(t,n){var a={id:t.id||G(e.demo),currency:n,code:n};return pe&&pe[n]&&(a.currency_symbol=pe[n].symbol,a.subunits_to_unit=pe[n].subunits_to_unit),a.limits=H(e.identifier,n),_.assign(t,a)}),e}function G(e){var t=e.lastIndexOf("?")>-1;return e.substring(e.lastIndexOf("/")+1,t?e.lastIndexOf("?"):e.length)}function H(e,t){return _e[e]&&_e[e][t]||{}}function z(e){return _.mapObject(e.currencies,function(t){var n=i.ENABLE_NEW_PROFILE?"":"/en";return t.play_url=i.DOMAIN+n+"/games/"+e.identifier+"/"+t.id,t}),e}function W(e){return _.mapObject(e.currencies,function(e,t){return e.jackpot&&(e.jackpot=e.jackpot/ve.currencies[t].subunits_to_unit),e}),e}function Y(e){e.game_info=_.findWhere(ye,{identifier:e.identifier})||{}}function V(e){return-1===i.INVISIBLE_COLLECTIONS.indexOf(e.id)&&"_"!==e.id[0]}function q(e){var t=!1;return ce[de]&&ce[de][e]&&(t=ce[de][e]),t}function K(e){return q(ue[e])}function J(t,n){if(n&&"FUN"==e.data.user.currency&&t.currencies[n])return t.currencies[n];if(t.currencies[e.data.user.currency])return t.currencies[e.data.user.currency];if(n&&t.currencies[n])return t.currencies[n];for(var a in e.data.user.balances)if(e.data.user.balances[a].code&&t.currencies[e.data.user.balances[a].code])return t.currencies[e.data.user.balances[a].code];for(var r in e.Info.currencies)if(e.Info.currencies[r].code&&t.currencies[e.Info.currencies[r].code])return t.currencies[e.Info.currencies[r].code]}function X(t,n){return e.data.user.currency?n&&t.currencies[n]?t.currencies[n]:J(t):t.currencies.FUN}function Z(e,t,n){var a,r;return e&&(a=Q(e),a.length>1&&t?r=_.find(a,function(e){var a=ee(e.provider)===t,r=!n||n===e.identifier;return a&&r}):1===a.length?r=a[0]:(t=e.split("-").splice(-1,1)[0],e=e.split("-").slice(0,-1).join("-"),r=Z(e,t,n))),r}function Q(e){return _.filter($e.data.games.by_identifier,function(t){return ee(t.title)===e})}function ee(e){return e.replace(/[&-]/g," ").replace(/[^A-Za-z-0-9 ]/g,"").replace(/\s{2,}/g," ").replace(/ /g,"-").toLowerCase()}function te(e){return Q(e).length>1}function ne(e,t){var a=!1,r=J(e,t);return r&&!r.jackpot&&t&&e.currencies[t]&&(r=e.currencies[t]),r&&r.jackpot&&(a=n("casino_currency")(r.jackpot,r.currency_symbol)),a}function ae(t){t=t.replace(/\/[a-z]{2}\/games\//,"/games/");var n=i.ENABLE_NEW_PROFILE?"":"/"+e.currentLocale;return t=t.replace("/games/",n+"/games/")}function re(e){return ge[e]}function oe(e,t){var n=_.assign({},t,e);return Object.keys(n).forEach(function(e){Object.keys(n[e].real).forEach(function(a){n[e].real[a]=n[e].real[a]||t[e].real[a]})}),n}function ie(e){var n={provider:e.split("/")[0],identifier:e.split("/")[1]};return t.all({metaTitle:c.getMetaTitle({provider:n.provider,identifier:n.identifier}).$promise,metaDescription:c.getMetaDescription({provider:n.provider,identifier:n.identifier}).$promise})}var se,ce={},ue={},le=new MobileDetect(window.navigator.userAgent),de=le.mobile()?"mobile":"desktop",fe=[],me=[],pe={},ge={},he={},_e={},ye=[],ve={games:{by_identifier:{},by_id:ue},jackpots:{},collections:[],providers:[],providersByCollections:{},winners:{},currencies:{},tags:{}},be=[];i.DOMAIN=i.DOMAIN||"",i.INVISIBLE_COLLECTIONS=i.INVISIBLE_COLLECTIONS||[],e.$on("localeChanged",E),e.$on("authLoginSuccess",b),e.$on("authLogoutSuccess",b);var $e={inited:!1,init:g,data:ve,getByIdentifier:q,getById:K,getGameByCurrency:J,getGameByUserCurrency:X,getGameByTitle:Z,getGameJackpotByCurrency:ne,getGameUrl:ae,getJackpotByCurrency:re,convertStringToGameUrlPath:ee,registerGamesPostProcessor:$,hasMultipleGamesByTitle:te,getMetaDataByIdentifier:ie,filters:{get:function(e,t){var n=l.getFilterByName(e);return n?t&&n.changeFilter(t):l.createNewFilter(e,t),l.getFilterByName(e)},changeByName:function(e,t){var n=l.getFilterByName(e);n&&n.changeFilter(t)},has:function(e){return l.getFilterByName(e)}}};return p.prototype.getDescription=function(){var e={provider:this.identifier.split("/")[0],identifier:this.identifier.split("/")[1]},t=this;return c.fetchDescription(e).$promise.then(function(e){return t.description=e,e})},$e}e.$inject=["$rootScope","$q","$filter","$timeout","$translate","Restrictions","SYSTEM","GamesCdn","Games","GamesInfo","GamesDataFilters","Winners","Info","Player"],angular.module("casino.services").factory("GamesData",e)}(),CasinoFilters.filter("gameDevice",function(){return function(e,t){return _.filter(e,function(e){return e.devices.indexOf(t)>-1||!t})}}).filter("gameTitle",["$translate","missingTranslationHandlerFactory",function(e,t){return function(n,a){if(a){var r=a.toLowerCase();return n.filter(function(n){var a="games."+n.identifier;return n.title.toLowerCase().indexOf(r)>-1||e.instant(a)!=t(n.identifier)&&e.instant(a).toLowerCase().indexOf(r)>-1})}return n}}]).filter("sortHelper",[function(){return function(e,t){if(t){var n=t.toLowerCase();return _.sortBy(e,function(e){return e.title.toLowerCase().indexOf(n)})}return[]}}]).filter("gameCollections",["$rootScope","GamesData",function(e,t){return function(n,a){"object"!=_typeof(a)&&(a=[a]);return _.filter(n,function(n){var r=!1;for(var o in a){if(r=t.data.collections_origin.some(function(t){return t.id===a[o]+":"+e.currentLocale})?n.collections.indexOf(a[o]+":"+e.currentLocale)>-1||!a[o]:n.collections.indexOf(a[o]+"")>-1||n.collections.indexOf(a[o])>-1||!a[o])break}return r})}}]).filter("withSubCollections",function(){function e(e,t){return-1!==e.indexOf(t,e.length-t.length)}return function(t){return t.filter(function(t,n,a){return a.every(function(n){return!e(t.id,"_"+n.id)})}).map(function(n){return n.sub=t.filter(function(t){return e(t.id,"_"+n.id)}),n})}}).filter("favoriteGames",function(){return function(e,t,n){return _.filter(e,function(e){var a=!0;if(n)for(var r in e.currencies)if(a=t.indexOf(e.currencies[r].id)>-1)break;return a})}}).filter("lastPlayedGames",function(){return function(e,t,n){return e.filter(function(e){return!(n&&-1===t.indexOf(e.id))})}}).filter("orderByArray",function(){return function(e,t,n){return _.sortBy(e,function(e){return n.indexOf(e[t])})}}).filter("gameProvider",function(){return function(e,t){return"object"!=_typeof(t)&&(t=[t]),e.filter(function(e){var n=!0;for(var a in t)if(n=e.provider.toLowerCase()==t[a]||!t[a])break;return n})}}).filter("gameVolatility",function(){return function(e,t){return"object"!=_typeof(t)&&(t=[t]),e.filter(function(e){var n=!0;for(var a in t)if(n=e.game_info.volatility_rating&&(e.game_info.volatility_rating.toLowerCase()==t[a]||!t[a]))break;return n})}}).filter("gameLinesAndWays",function(){return function(e,t){return"object"!=_typeof(t)&&(t=[t]),e.filter(function(e){var n=!0;for(var a in t)if(n=(e.game_info.lines||e.game_info.ways)&&(e.game_info.lines===t[a]||e.game_info.ways===t[a]||!t[a]))break;return n})}}).filter("gameHitRate",function(){function e(e,t,n){return t<=e&&e<=n}return function(t,n){return t.filter(function(t){return!t.game_info.hit_rate&&n.minValue===n.sliderOptions.floor&&n.maxValue===n.sliderOptions.ceil||t.game_info.hit_rate&&e(t.game_info.hit_rate,n.minValue,n.maxValue)})}}).filter("gamePayout",function(){function e(e,t,n){return t<=e&&e<=n}return function(t,n){return t.filter(function(t){return!t.game_info.payout&&n.minValue===n.sliderOptions.floor&&n.maxValue===n.sliderOptions.ceil||t.game_info.payout&&e(t.game_info.payout,n.minValue,n.maxValue)})}}).filter("gamesWithFun",function(){return function(e,t){return e.filter(function(e){var n=!0,a=Object.keys(e.currencies).length;return!t&&1==a&&e.currencies.FUN&&(n=!1),n})}}).filter("gameCanPlay",["Game","AvailableGamesService",function(e,t){return function(n){var a=e.data.games_grid;return n.filter(t.isGameAlreadyOpened(a)).filter(t.isAmaticAlreadyOpened(a)).filter(t.isLiveGameForFun(a))}}]).filter("gamesWithCurrency",function(){return function(e,t){return _.filter(e,function(e){var n=!0;if(t)for(var a in e.currencies)if(n=a==t)break;return n})}}).filter("gameCurrency",function(){return function(e,t){return e.filter(function(e){return e.currency==t||!t})}}).filter("gameByCurrency",["GamesData",function(e){return function(t){return e.getGameByCurrency(t)}}]).filter("gameJackpot",function(){return function(e,t){return e.filter(function(e){var n=!0;return t&&(n=e.jackpot),n})}}).filter("gameJackpotByCurrency",["GamesData",function(e){return function(t,n,a){return e.getGameJackpotByCurrency(t,a)}}]).filter("gameOrder",["$filter",function(e){return function(t,n){return e("orderBy")(t,function(e){var t=0;return e.order&&e.order[n]&&(t=e.order[n]),t})}}]).filter("gameOrderAZ",["$filter",function(e){return function(t,n){var a=t;return n&&(a=e("orderBy")(t,"title")),a}}]).filter("collectionsOrder",["$filter",function(e){return function(t,n){return e("orderBy")(t,function(e){return e.position})}}]).filter("orderByCollection",["$filter","$rootScope",function(e,t){return function(n,a){return e("orderBy")(n,function(e){var n=0;return e.order&&e.order[a]?n=e.order[a]:e.order&&!_.isUndefined(e.order[a+":"+t.user_locale])&&(n=e.order[a+":"+t.user_locale]),n})}}]).filter("latestWinners",["$rootScope",function(e){return function(t,n){return _.filter(t,function(t){var n=!0;return t.nickname==e.data.user.nickname&&(n=!1),n})}}]).filter("difference",function(){return function(e,t,n){return _.filter(e,function(e){var a=!0;return t&&t.indexOf(e[n])>-1&&(a=!1),a})}}).filter("asArray",function(){return function(e){return"object"!=_typeof(e)&&(e=[e]),e}}),function(){function e(e,t){return e(t.URL_API+"/games_info/:identifier/:allowed",{},{list:{method:"get",params:{allowed:"allowed"},cache:!0,isArray:!0},getByIdentifier:{method:"get",params:{identifier:"@identifier"},cache:!0,isArray:!0}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("GamesInfo",e)}(),function(){function e(e,t,n,a,r){function o(){return e.all({top:r.get().$promise,latest:r.latest().$promise,top_BTC:r.BTC().$promise})}function i(e,t){var n={};n.top=s(e.top,t),n.latest=s(e.latest,t);var a=s(e.top_BTC,t);return n.top.length<15&&c(n.top,a),n}function s(e,t){var a=[];return e.forEach(function(e){""==e.nickname&&Object.defineProperty(e,"nickname",{get:function(){return n("translate")("common.player")}}),t[e.game_identifier]&&t[e.game_identifier].currencies[e.currency]?(e.data=t[e.game_identifier],a.push(e)):t[e.game_identifier+"Flash"]&&t[e.game_identifier+"Flash"].currencies[e.currency]&&(e.data=t[e.game_identifier+"Flash"],e.game_identifier=e.game_identifier+"Flash",a.push(e))}),a}function c(e,t){for(var n in t){for(var a=!1,r=0;r<e.length;r++)if(u(t[n],e[r])){a=!0;break}a||e.push(t[n])}}function u(e,t){return e.win_amount_cents===t.win_amount_cents&&e.nickname===t.nickname&&e.game_identifier===t.game_identifier}function l(e,r){a.subscribe("public:wins",function(a){var o=a.data;o.round.bet<o.round.win&&r[o.game.identifier]&&r[o.game.identifier].currencies[o.round.currency]&&(t.data.user&&t.data.user.nickname&&o.player.nickname==t.data.user.nickname||(o.data=r[o.game.identifier],o.nickname=o.player.nickname,o.win_amount_cents=o.round.win,o.currency=o.round.currency,o.humanized_win=n("humanized_currency")(o.round.win,o.round.currency),""==o.nickname&&(o.nickname=n("translate")("common.player")),e.latest.unshift(o),t.$broadcast("latestWinnerAdd",o)))})}return{getAll:o,prepareAllWinners:i,initLatestWinners:l}}e.$inject=["$q","$rootScope","$filter","RealTime","WinnersResource"],angular.module("casino.services").factory("Winners",e)}(),CasinoControllers.controller("External",["$scope","$rootScope","$state","$stateParams","Pages","Info",function(e,t,n,a,r,o){var i=[];r.list({l:t.currentLocale},function(e){for(var r=0,o=e.length;r<o;r++)if(i.push(e[r].path),e[r].children&&e[r].children.length)for(var s=0,c=e[r].children.length;s<c;s++)i.push(e[r].children[s].path);var u=a.id||a.path;i.indexOf(u)>-1?(n.go("app.cms",{path:u,lang:t.currentLocale}),i=[]):n.go("404",{lang:t.currentLocale})})}]),function(){function e(){function e(e,a){return t(e,a)||n(e,a)}function t(e,n){var r;return e.id===a[n].id?r=e:e.children&&e.children.forEach(function(e){r=t(e,n)}),r}function n(e,t){var r;return e.categories.includes(a[t].category)?r=e:e.children&&e.children.forEach(function(e){r=n(e,t)}),r}var a={PRIVACY_POLICY:{id:"privacy-policy",category:"privacy-policy-page"},TERMS_AND_CONDITIONS:{id:"terms-and-conditions",category:"terms-page"}};return{getLinkMenuItem:e}}angular.module("casino.services").factory("PagesService",e)}(),function(){function e(e){var t=this;t.ProfileModalService=e,t.tabs=e.tabs}e.$inject=["ProfileModalService"],angular.module("casino.profile").component("profileModal",{templateUrl:["$element","$attrs",function(e,t){return"/app/Profile/_"+(t.template||"main")+".html"}],controller:e,bindings:{close:"&",dismiss:"&",params:"="}}),angular.module("casino.profile").controller("ProfileModalController",e)}(),function(){function e(e,t,n,a,r,o,i,s,c,u,l){function d(e){p.selectedTab=m[e];var t=$(".modal");a.scrollUp(0,t)}function f(a,r){if(e.data.user.email){if(a=a||"dashboard",n.checkAuth("auth_actions_forbidden",!1))return!1;e.mainModal.close(),p.changeTab(a),e.mainModal.modal=t.open({template:'<profile-modal resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"params="$ctrl.params"></profile-modal>',controller:function(){this.params=r},windowClass:"modal-profile",controllerAs:"$ctrl"})}else console.error("can't open profile for anonymous user")}var m={dashboard:c,profile:s,bonuses:l,lotteries:u,history:o,limits:i,verification:r},p={changeTab:d,selectedTab:c,showProfileModal:f,tabs:m};return p}e.$inject=["$rootScope","$modal","Restrictions","ScrollUpService","VerificationTabService","HistoryTabService","LimitsTabService","ProfileInfoTabService","DashboardTabService","LotteriesTabService","BonusesTabService"],angular.module("casino.profile").factory("ProfileModalService",e)}(),function(){function e(e,t,n){t.go("home",{lang:e.currentLocale});var a,r;switch(t.current.name){case"app.profile":a="dashboard";break;case"app.accounts_history":a="history",r="transactions";break;case"app.documents":a="verification";break;case"app.profile_urls":switch(t.params.path.split("/")[0]){case"limits":a="limits";break;case"info":case"edit":a="profile";break;case"bonuses/actual":a="bonuses";break;case"bets":a="history",r="bets";break;case"bonuses":a="history",r="bonuses";break;default:a="dashboard"}break;default:a="dashboard"}n.showProfileModal(a,{subTab:r})}e.$inject=["$rootScope","$state","ProfileModalService"],angular.module("casino.controllers").controller("ProfileRoutesController",e)}(),function(){function e(e,t,n){var a={};return e.$on("authLoginSuccess",function(e,t){a=t.user}),{data:a,statuses:t,compoints:n}}e.$inject=["$rootScope","StatusesService","Compoints"],angular.module("casino.services").factory("UserService",e)}(),CasinoConstants.constant("AUTH_PARAMS",{SIGN_UP_MODE:"modal",SIGN_IN_MODE:"modal"}),CasinoProviders.provider("Ping",[function(){var e=function e(t,n){n=n||function(){};var a=!1,r=!1,o=e.statuses.unchecked,i=!1,s=0,c=function(c,l){s++,l=l||n,c=c||t,s>3&&(o=e.statuses.blocked,l(u)),r=new Image,r.onload=function(){o=e.statuses.responded,l(u),clearTimeout(a)},r.onerror=function(t){o=e.statuses.blocked,l(u),clearTimeout(a)},i=(new Date).getTime(),r.src=c+"/ping.png?"+i,a=setTimeout(function(){o=e.statuses.timeout,l(u)},1500*s)};c();var u={getUrl:function(){return t},getStatus:function(){return o},getTime:function(){var e=!1;return i&&(e=(new Date).getTime()-i),e},rePing:c};return u};e.statuses={unchecked:"unchecked",checking:"checking",responded:"responded",timeout:"timeout",blocked:"blocked"};var t=function(t,n,a){for(var r=void 0,o=[],i=function(e){var t=!1;e.getUrl()==n||!1===r?t=e.getUrl():o.push(e),t&&a(t)},s=0;s<t.length;s++)new e(t[s],function(t){switch(t.getStatus()){case e.statuses.responded:i(t);break;case e.statuses.timeout:case e.statuses.blocked:t.getUrl()==n&&(r=!1,o.length&&i(o[0]))}})};return{$get:function(){return{pong:function(t,n){return new e(t,n)},pongList:t,statuses:e.statuses}},pong:function(t,n){return new e(t,n)},pongList:t,statuses:e.statuses}}]),function(){angular.module("casino").component("redirectIp",{templateUrl:["$attrs",function(e){return"/app/redirect-ip/"+(e.template||"redirect-ip.template")+".html"}],bindings:{country:"<"},controller:"RedirectIpCtrl"})}(),CasinoConstants.constant("REDIRECT_IP",{enabled:!1,countries:[{country:"BY",region_code:"MI",redirect_url:"https://s7.casino.softswiss.com",template_url:"",redirect_timeout:2},{country:"RU",region_code:"",redirect_url:"",template_url:"",redirect_timeout:!1},{country:"US",region_code:"CA",redirect_url:"https://s2.casino.softswiss.com",template_url:"",redirect_timeout:3},{country:"DE",region_code:"RP",redirect_url:"https://s5.casino.softswiss.com",template_url:"",redirect_timeout:!1},{country:"US",region_code:"FL",redirect_url:"",template_url:"",redirect_timeout:!1}]}),function(){function e(){var e=this;this.$onInit=function(){this.country.redirect_timeout&&setTimeout(this.redirect,1e3*this.country.redirect_timeout)},this.redirect=function(){location.replace(e.country.redirect_url)}}angular.module("casino").controller("RedirectIpCtrl",e)}(),function(){function e(e,t,n){function a(a,r,o,i,u,l){var d=jQuery(".game-modal"),f=jQuery(".sga-container"),m=jQuery(d).find(".right_panel"),p=m.length<=0?0:m.width(),g=jQuery(d).find(".bottom_panel"),h=g.length<=0?0:g.height(),_=u||$("#game-block").length&&$("#game-block")||$("#game-block-0").length&&$("#game-block-0"),y=void 0!==a?a:_.hasClass("hd-game"),v={screen:{width:screen.width,height:screen.height},window:{width:window.innerWidth,height:window.innerHeight}},b=!1,S=!1;if(p=l?0:m.length<=0?0:m.width(),i=i||1,(c.mobile&&e.data.is_mobile||v[c.origin].width<c.width||v[c.origin].height<c.height||o&&"ezugi"===o.provider&&v[c.origin].height<769)&&(b=!0),b=void 0!==r?r:b,S="mobile"===e.data.device&&t.MOBILE_GAME_ON_CURRENT_DOMAIN,b||S?document.querySelector("body").classList.add("game-full"):document.querySelector("body").classList.remove("game-full"),S){document.querySelector("body").classList.add("game-full-mobile");var w=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(w,"px")),o&&["pragmatic","booming","playngo","wazdan","bsg","egt"].includes(o.provider)&&document.querySelector(".gm-block__wrapper > iframe").removeAttribute("allowfullscreen"),o&&["amatic"].includes(o.provider)&&n(s),window.scrollTo(0,1)}var C=4,A=3;y&&(C=16,A=9),o&&"ezugi"==o.provider&&(C=48,A=31),o&&"gameart"==o.provider&&(C=1209,A=756);var E=i>1?4:C,I=i>1?3:A,T=i<=1?1:2,L=i<=2?1:2,P=f.height()-h-50,k=P*(E*T)/(I*L)+p;k>.9*f.width()&&(k=.9*f.width(),P=(k-p-h)/(E*T)*(I*L));var R=(k-p)/T,O=R/C*A;R=2*Math.round(R/2),O=2*Math.round(O/2),o&&"quickfire"===o.provider&&y&&(O>675||R>1200)&&(O=675,R=1200),_&&!S&&_.css({width:R,height:O});var M=$(".game_box");M&&(i>1||1===i&&!o)?M.css({width:k,height:P}):M&&1===i&&M.css({width:"auto",height:"auto"}),b&&$("#game-block").length&&(_.css({width:"100%",height:"100%"}),M.css({width:"100%",height:"100%"}))}function r(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen(),a(null)}function o(){s(),a(null)}function i(e){n(function(){a(void 0,void 0,e)})}function s(){(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen())}var c={width:1e3,height:650,origin:"window",mobile:!0};return t.GAME&&t.GAME.full_view&&(c=_.extend(c,t.GAME.full_view)),{gameBoxResize:a,enableFullScreen:r,cancelFullScreen:o,gameBoxResizeTimeout:i}}e.$inject=["$rootScope","SYSTEM","$timeout"],angular.module("casino.services").factory("GameActions",e)}(),function(){function e(e,t,n,a,r,o,i,s,c,u,l,d,f,m,p){function g(e,a){"mobile"===t.data.device?window.location.href=a?e.play_url_fun:e.play_url:n.go("app.game",E(e,a))}function h(e,t){var n=E(e,t),a="#game-"+n.type+"-"+n.name;return n.id&&(a+="-"+n.id),a=s.path()+a}function y(e,t,n){var a=o.data,r=a.games_grid,s=a.numberOfGames,c=Object.values(r).findIndex(function(e){return!e.game}),u=m.isGameAlreadyOpened(r)(e)&&m.isAmaticAlreadyOpened(r)(e);1===s?v(e,t,n):u&&(m.isLiveGameForFun(r)(e)?-1===c?p.openModal(v,[r[0]],e,t,n):o.openGridGame(e,c):i.show("frontend.notifications.live_game_in_multi_view",{classes:"alert-danger"}))}function v(e,n,a){f.ENABLE_CONTEXT_EDIT&&t.data.user.email&&"FUN"!==n&&!d.isAllContextFieldsFilled(e.provider)?d.showEditByContextModal({context:e.provider,successCallback:function(){b(e,n,a)}}):o.hasRightsToPlay()?b(e,n,a):u.showLogin()}function b(e,n,a){var o,s,d=c.getGameByUserCurrency(e,n);if(-1!==Object.keys(e.currencies).indexOf("FUN")||t.data.user.email)if(o=c.convertStringToGameUrlPath(e.title),c.hasMultipleGamesByTitle(o)&&(s=c.convertStringToGameUrlPath(e.provider),o+="-"+s),"mobile"===t.data.device)l.add(e.identifier),r.sessionStorage.setItem("savedGameState",JSON.stringify({title:o,currency:d.currency})),f.MOBILE_GAME_ON_CURRENT_DOMAIN&&!f.CURRENT_DOMAIN_EXCLUDE_PROVIDERS.includes(e.provider)?$(e,o,d):window.location.href=c.getGameUrl(d.play_url);else if(S(c.getGameByTitle(o,null,e.identifier)))$(e,o,d);else{i.show("Can't open the game",{classes:"alert-error"})}else t.data.gameInPending=e,u.showLogin();t.$broadcast("gameIframeReady",e)}function $(e,t,a){if(S(c.getGameByTitle(t,null,e.identifier)))n.go("app.game",{title:t,currency:a.currency,identifier:e.identifier},{reload:!0});else{i.show("Can't open the game",{classes:"alert-error"})}}function S(e){return a("gameCanPlay")([e])[0]}function w(e,t){var n=c.getGameByUserCurrency(e,t);window.location.href=c.getGameUrl(n.play_url)}function C(t,n){var a=e.openGame.modal(t,n);s.hash(a.slice(a.indexOf("#")+1))}function A(t,n){var a=c.getByIdentifier(t);a?e.openGame.modalByCurrency(a,n):console.warn('No game with identifier "'+t+'" has been found.')}function E(e,n){n=n||t.demo_mode||!1;var a=e.identifier.split("/"),r=n?e.demo_id:e.id;return{type:a[0],name:a[1],id:r,lang:t.currentLocale}}function I(){p.openModal(n.go,[o.data.games_grid[0]],"home")}var T=e.$on("openGameAfterLogin",function(){t.data.gameInPending&&e.openGame.modalByCurrency(t.data.gameInPending)});e.$on("$destroy",function(){T()}),e.showCloseSessionsModal=I,e.game_url=!1,e.openGame={page:g,modal:h,modalByCurrency:_.throttle(y,500,{trailing:!1}),pageByDirect:w,showModal:C,openGameModalByIdentifier:A}}
e.$inject=["$scope","$rootScope","$state","$filter","$window","Game","Notification","$location","GamesData","AuthModalService","LastPlayedList","ProfileEditService","SYSTEM","AvailableGamesService","CloseSessions"],angular.module("casino.controllers").controller("Game",e)}(),function(){angular.module("casino.directives").directive("casinoGame",["$rootScope","SYSTEM",function(e,t){return{restrict:"E",replace:!0,scope:{},templateUrl:function(){return"mobile"===e.data.device&&t.MOBILE_GAME_ON_CURRENT_DOMAIN?"/app/Game/_game_mobile.html":"/app/Game/_game_modal.html"},controller:"casinoGameController",controllerAs:"casinoGameController"}}])}(),function(){function e(e,t,n,a,r,o,i,s,c,u,l,d,f,m,p){function g(){Object.keys(I.games_grid).forEach(function(e,t){l.gameBoxResize(I.games_grid[e].isHd,void 0,I.games_grid[e].game,I.numberOfGames,$("#game-block-"+e).length&&$("#game-block-"+e),I.isToggled)}),r(function(){I.isFullscreenMode=t.isFullscreenMode()})}function h(){I.game=angular.copy(t.data.game),I.game_url=angular.copy(t.data.game_url),I.isHd=t.data.isHd,I.isToggled=t.data.isToggled,I.games_grid=angular.copy(t.data.games_grid),I.numberOfGames=t.data.numberOfGames,e.game_url=angular.copy(t.data.game_url),e.isHd=t.data.isHd,e.isToggled=t.data.isToggled,1===I.numberOfGames&&I.games_grid[0]&&!I.games_grid[0].game_url&&g()}function y(){t.setIsToggled(!I.isToggled),r(g)}function v(e){t.toggleFavorite(e)}function b(e){var n=t.data,a=n.numberOfGames,r=n.games_grid,o=Object.values(r).slice(e);e>a||!o.some(function(e){return e.game})?S(e):p.openModal(S,o,e)}function S(e){t.split(e),r(g)}function w(e){122===e.which&&(I.isFullscreenMode||(e.preventDefault(),l.enableFullScreen()))}function C(){t.cleanGameData()}function A(){e.game_url=!1,Object.keys(I.games_grid).forEach(function(e){I.games_grid[e].game_url=!1}),r(function(){h(),r(g)},100)}function E(t){if($(".game-modal iframe").remove(),e.game_url)e.game_url=!1,o.restoreState&&o.restoreState.name?c.go(o.restoreState.name,{path:o.restoreStateParams.path||null,category:o.restoreStateParams.category||null,order:o.restoreStateParams.order||!1,show_favorites:o.restoreStateParams.show_favorites||!1,provider:o.restoreStateParams.provider||!1,lang:o.currentLocale,from_game:!0}):c.go("home");else if(!t){var n=m.AFTER_LOGIN_REDIRECT||"home";c.go(n)}r(function(){C(),o.$broadcast("gameCloseSuccess")})}var I=this;e.favorites=i,e.accessLevels=s.accessLevels,e.GameActions=l,I.GameActions=l,I.isFullscreenMode=null,I.isToggled=null,I.game=null,I.game_url=null,I.isHd=null,I.games_grid=null,I.numberOfGames=null,e.game_url=null,e.isToggled=null,e.isHd=null,I.openGame=t.openGridGame,I.toggleFavorite=v,I.split=b,I.toggleRightPanel=y,I.closeGame=t.closeGridGame,I.close=E,e.close=E,o.close_game=E,angular.element(a).bind("resize",g),angular.element(f).bind("keydown",w),e.$on("preloadHide",g),e.$on("authLoginSuccess",function(){r(g)}),e.$on("authLogoutSuccess",function(){"app.game"===c.current.name&&r(function(){t.hasRightsToPlay()?r(g):(C(),c.go("app.users_sign_in"))})}),e.$on("gameDataUpdated",h),e.$on("onResize",g),e.$on("paymentSubmitSuccess",A),e.$watch("isHd",function(e,t){void 0!==e&&t!=e&&g()}),e.$watch("isToggled",function(e,n){void 0!==e&&n!=e&&(t.setIsToggled(e),r(g))}),a.onbeforeunload=function(e){"app.game"===c.current.name&&a.sessionStorage.setItem("savedGameState",JSON.stringify(u))},h(),function(){if(a.location.hash){var t=a.location.hash.replace(/%2F/g,"/"),r=new RegExp("#game-(.*-.*)-([0-9]*)","i"),i=r.exec(t);if(null==i&&(r=new RegExp("#game-(.*-.*)","i"),i=r.exec(t)),null!=i&&i.length>1)if(d.inited){var s=d.getByIdentifier(i[1].replace("-","/")),u=_.find(s.currencies,function(e){return Number(e.id)===Number(i[2])});s&&c.go("app.game",{provider:s.provider.split(" ").join("-").replace(/[^A-Za-z-0-9]/g,"").toLowerCase(),title:s.title.split(" ").join("-").replace(/[^A-Za-z-0-9]/g,"").toLowerCase(),currency:u&&u.currency}),n.hash("")}else{o.$broadcast("preloadShow");var l=e.$on("gamesInitialized",function(e,t){var a=d.getByIdentifier(i[1].replace("-","/")),r=_.find(a.currencies,function(e){return Number(e.id)===Number(i[2])});a&&c.go("app.game",{provider:a.provider.split(" ").join("-").replace(/[^A-Za-z-0-9]/g,"").toLowerCase(),title:a.title.split(" ").join("-").replace(/[^A-Za-z-0-9]/g,"").toLowerCase(),currency:r&&r.currency}),n.hash(""),l()})}}}()}e.$inject=["$scope","Game","$location","$window","$timeout","$rootScope","FavoriteList","Auth","$state","$stateParams","GameActions","GamesData","$document","SYSTEM","CloseSessions"],angular.module("casino.controllers").controller("casinoGameController",e)}(),function(){function e(e,t,n,a,r,o,i,s,c,u,l,d,f,m,p,g,h){function y(t){e.getMetaDataByIdentifier(t.identifier).then(function(e){i.page.title=e.metaTitle[i.currentLocale]||l.instant("frontend.game.meta.title",{provider:t.provider,title:t.title}),i.page.description=e.metaDescription[i.currentLocale]||l.instant("frontend.game.meta.description",{provider:t.provider,title:t.title})})}function v(){Object.keys(x.data.games_grid).forEach(function(e){var t=x.data.games_grid[e].game,n=t&&t.currencies.FUN&&t.currencies.FUN.id,a=t&&t.identifier;n?w(a,n,e):A(e)})}function b(){Object.keys(x.data.games_grid).forEach(function(e){x.data.games_grid[e].isFavorite=n.isFavorite(x.data.games_grid[e].game)}),i.$broadcast("gameDataUpdated")}function S(e){n.favorite(e.game),b()}function w(s,u,l){var f=e.getByIdentifier(s),p=!1;if(i.data.user.currency&&"FUN"!==i.data.user.currency){for(var g in f.currencies)if(f.currencies[g].id==u){p=f.currencies[g];break}}else f.currencies&&(p=f.currencies.FUN);if(!p){if(!i.data.games.inited)return!1;if(!p)return c.go("404",{lang:i.currentLocale}),!1}d.MOBILE_GAME_ON_CURRENT_DOMAIN||"mobile"!==i.data.device||(window.location.href=e.getGameUrl(p.play_url)),l=l||0,x.data.game_url=a.trustAsResourceUrl(e.getGameUrl(p.play_url)),x.data.isHd=f.collections.indexOf("_hd")>-1||f.collections.indexOf("hd")>-1,x.data.games_grid[l]={game_url:x.data.game_url,isHd:x.data.isHd,isFavorite:n.isFavorite(f),game:f},x.data.game_url&&("game"!==c.current.name&&$("body").addClass("page-game"),k(f,p),"FUN"!==p.currency&&i.data.user.currency!==p.currency&&(i.data.user.currency=i.data.currency=p.currency,m.changeCurrency(i.data.user.currency),c.go(".",{currency:i.data.user.currency},{notify:!1})),x.data.currency=p.currency,t.add(s)),x.data.game=f,o(function(){o(function(){$(r).resize(),i.$broadcast("preloadHide")},0)},0),i.$broadcast("gameDataUpdated"),i.$broadcast("gameOpenSuccess",f,p,x.data.games_grid)}function C(e,t,n){f.check(function(a){if(i.data.games.inited)w(e,t,n);else var r=i.$watch("data.games.inited",function(){i.data.games.inited&&(w(e,t,n),r())})})}function A(e){$("#game-block-"+e).attr("src",""),x.data.games_grid[e]={},i.$broadcast("gameDataUpdated"),i.$broadcast("gridGameClosedSuccess",{games_grid:x.data.games_grid})}function E(e){switch(x.data.numberOfGames=e,e){case 1:delete x.data.games_grid[1],delete x.data.games_grid[2],delete x.data.games_grid[3];break;case 2:x.data.games_grid[1]=x.data.games_grid[1]||{},delete x.data.games_grid[2],delete x.data.games_grid[3];break;case 4:x.data.games_grid[1]=x.data.games_grid[1]||{},x.data.games_grid[2]={},x.data.games_grid[3]={};break;default:console.warn("Invalid Number of Games selected. Only 1, 2 or 4 games are available.")}i.$broadcast("splitGamesSuccess",{numberOfGames:e,games_grid:x.data.games_grid}),i.$broadcast("gameDataUpdated")}function I(e,t){d.ENABLE_CONTEXT_EDIT&&i.data.user.email&&"FUN"!==x.data.currency&&!g.isAllContextFieldsFilled(e.provider)?g.showEditByContextModal({context:e.provider,successCallback:function(){T(e,t),i.$broadcast("onResize")}}):O()?(T(e,t),i.$broadcast("onResize")):h.showLogin()}function T(e,t){x.data.games_grid[t]={};var n=u.currency||i.data.user.currency||"FUN",a=e.currencies[n]&&e.currencies[n].id;C(e.identifier,a,t)}function L(){$("body").removeClass("page-game game-full game-full-mobile"),$(".game-modal iframe").each(function(){$(this).remove()}),x.data.game_url=!1,x.data.games_grid={},x.data.numberOfGames=1,i.page.game_title=!1,i.$broadcast("gameDataUpdated")}function P(){var e=s.defer();if(m.balances&&m.balances.length>0)e.resolve(m.balances);else var t=i.$on("balanceRefreshSuccess",function(n,a){a.length&&(e.resolve(a),t())});return e.promise}function k(e,t){if(d.GAME_NOTIFICATION){var n=i.data.currency||i.data.user.currency,a=[],r=d.GAME_NOTIFICATION;P().then(function(i){var s=_.findWhere(i,{code:n});r.AUTO_SWITCH_CURRENCY&&n&&t.currency!==n&&!e.currencies[n]&&(a.push({text:"frontend.notifications.game_auto_switch",class:"alert-success",translate_value:{from_currency:n,to_currency:t.currency}}),n=t.currency,s=_.findWhere(i,{code:n})),r.BALANCE&&s&&s.code===t.currency&&r.BALANCE[n]&&r.BALANCE[n].MIN&&s.amount_cents/s.subunits_to_unit<r.BALANCE[n].MIN&&a.push({text:"frontend.notifications.game_small_deposit",class:"alert-warning",translate_value:{from_currency:n,min_balance:r.BALANCE[t.currency].MIN}}),_.each(a,function(e,t){o(function(){p.show(e.text,{templateUrl:"/app/Game/Messages/template.html",classes:e.class,duration:r.DURATION||5e3},e.translate_value)},1500*t)})})}}function R(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)}function O(){return i.data.user.email||!d.hasOwnProperty("ANON_CAN_PLAY_FOR_FUN")||d.hasOwnProperty("ANON_CAN_PLAY_FOR_FUN")&&d.ANON_CAN_PLAY_FOR_FUN}function M(e){x.data.isToggled=e,i.$broadcast("gameDataUpdated")}var x={showGame:C,split:E,openGridGame:I,closeGridGame:A,cleanGameData:L,isFullscreenMode:R,hasRightsToPlay:O,setIsToggled:M,toggleFavorite:S,data:{games_grid:{},numberOfGames:1,isToggled:!1,game_url:"",game:null,isHd:null,currency:null}};return function(){if(n.inited)b();else var e=i.$on("favoriteListInitialized",function(){b(),e()})}(),i.$on("favoriteListUpdated",b),i.$on("$stateChangeSuccess",function(t,n,a,r,o){var s,l,d=u.currency||i.data.user.currency||"FUN";if("app.game"===c.current.name)if(O())if($("body").addClass("page-game"),i.$broadcast("preloadShow"),e.inited)s=e.getGameByTitle(u.title,u.provider,u.identifier),s?(l=s.currencies[d]&&s.currencies[d].id,y(s),C(s.identifier,l)):c.transitionTo("404",{lang:i.currentLocale});else{i.$broadcast("preloadShow");var f=i.$on("gamesInitialized",function(t,n){s=e.getGameByTitle(u.title,u.provider,u.identifier),s?(l=s.currencies[d]&&s.currencies[d].id,y(s),C(s.identifier,l)):c.transitionTo("404",{lang:i.currentLocale}),f()})}else c.go("app.users_sign_in");else L()}),i.$watch("data.user.currency",function(){if(!1===i.data.user.currency||"FUN"===i.data.user.currency)if(i.data.games.inited)v();else var e=i.$watch("data.games.inited",function(){i.data.games.inited&&(v(),e())})}),i.$on("userCurrencyChangedSuccessfully",function(){if(c.go(".",{currency:i.data.user.currency},{notify:!1}),1===Object.keys(x.data.games_grid).length){var t=e.getGameByUserCurrency(x.data.games_grid[0].game),n=x.data.games_grid[0].game.currencies[t.currency].id;C(x.data.games_grid[0].game.identifier,n)}else Object.keys(x.data.games_grid).forEach(function(e){var t,n=x.data.games_grid[e].game;n&&(t=n.currencies[i.data.user.currency]),t&&t.id?C(n.identifier,t.id,e):n&&(p.show("frontend.notifications.game_is_not_available_for_currency",{classes:"alert-danger"},{gameTitle:n.title}),A(e))}),i.$broadcast("gameDataUpdated")}),x}e.$inject=["GamesData","LastPlayedList","FavoriteList","$sce","$window","$timeout","$rootScope","$q","$state","$stateParams","$translate","SYSTEM","Auth","Balance","Notification","ProfileEditService","AuthModalService"],angular.module("casino.services").factory("Game",e)}(),CasinoDirectives.directive("accessLevel",["$rootScope","Auth",function(e,t){return{restrict:"A",link:function(n,a,r){function o(){if(s&&c){!(t.authorize(c,s)&&m)?a.css("display","none"):a.css("display",u)}}function i(e){return e.replace(/\s/g,"").split(",")}var s,c,u=a.css("display");n.user=t.user;var l,d=r.accessGroupsShow&&i(r.accessGroupsShow),f=r.accessGroupsHide&&i(r.accessGroupsHide),m=!0;n.$watch("user",function(e){m=!0,e.role&&(s=e.role);var t=d||f;e.data.statuses&&t&&(l=e.data.statuses.map(function(e){return e.id}),f&&(m=!_.intersection(l,f).length),d&&(m=m&&!!_.intersection(l,d).length)),o()},!0),r.$observe("accessLevel",function(t){t&&(c=e.$eval(t)),o()}),o()}}}]),CasinoServices.factory("Auth",["$rootScope","$q","User","Player","$window","$state","AuthModalService","Compoints","Notification","SYSTEM","RecaptchaService",function(e,t,n,a,r,o,i,s,c,u,l){function d(t){t=t?t.toJSON():{},t.email?(t.compoints=s,$.role=b.user,$.data=t,_.isEqual(t,e.data.user)?e.data.user=t:(e.data.user=t,e.$broadcast("authLoginSuccess",t))):($.role=b.public,$.data={}),u.hasOwnProperty("ENABLE_TERMS_UPDATED_POPUP")&&!u.ENABLE_TERMS_UPDATED_POPUP&&t.auth_fields_missed&&t.auth_fields_missed.includes("terms_acceptance")&&(t.auth_fields_missed=t.auth_fields_missed.filter(function(e){return"terms_acceptance"!==e})),t.auth_fields_missed&&t.auth_fields_missed.length&&i.showUpdate(t.auth_fields_missed),t.currency?e.data.user=t:(e.data.user={},e.data.user.currency=!1),f()}function f(){a.stats(function(t){t=t.toJSON();var n={};g(t.messages),r.dataLayer||(r.dataLayer=[]),_.assign(n,t),n.bets_sum&&(n.bets_sum=m(t.bets_sum)),n.cashouts_sum&&(n.cashouts_sum=m(t.cashouts_sum)),n.deposits_sum&&(n.deposits_sum=m(t.deposits_sum)),r.dataLayer.push(n),e.data.user_stats=t,e.$broadcast("userStatsUpdated",t)})}function m(e){return Object.keys(e).map(function(t){return{currency:t,value:e[t]}})}function p(){a.stats(function(e){g(e.messages)})}function g(e){e&&Object.keys(e).forEach(function(t){c.show(e[t],{duration:1e4,classes:"alert-success"})})}function h(t){var n=["app.users_sign_up","app.users_sign_in","app.users_password_new","app.users_password_edit","app.users_unlock_new","app.users_unlock"],a=t?t.email:e.data.user.email;n.indexOf(o.current.name)>-1&&a&&o.go("home",{lang:e.currentLocale})}function y(t,a,r){n.sign_up(t.data,function(t){e.$broadcast("authRegistrationSuccess",t),e.$broadcast("authCheckUser",t),a&&a(t)},function(n){e.$broadcast("authRegistrationError",n),n.data&&n.data.errors&&(t.errors=n.data.errors,r&&r(n.data.errors))})}var v=routingConfig.accessLevels,b=routingConfig.userRoles,$={role:b.public,data:{}},S={data:{user:{email:"",password:""}}};e.$on("authLoginSuccess",function(e,t){h(t)}),e.$on("$stateChangeSuccess",function(){h()}),e.$on("localeChanged",function(e,t){$.data.email&&a.stats()}),e.$on("getFlashMessages",p),e.$on("authCheckUser",function(){w.check()});var w={data:S,check:function(e){e=e||function(){};var t=a.get().$promise;return t.then(function(t){d(t),e(t)}),t},login:function(e,t,a){n.sign_in(e.data,function(n){e.data.user.email="",e.data.user.password="",e.data.user.otp_attempt="",e.errors={},n.redirect?r.location.href=n.redirect:(d(n),t(n))},function(t){(t.data.errors||t.data.required)&&(t.data.errors&&(t.data.errors.password||t.data.errors.email||t.data.errors.unauthorized)&&(e.data.user.password=""),e.data.user.otp_attempt="",e.errors=t.data.errors,a&&a(t.data))})},registration:function(e,t,n){l.key?l.captchaV3(function(a){e.data.user.captcha=a,y(e,t,n)}):y(e,t,n)},logout:function(t,a){n.sign_out().$promise.then(function(){e.$broadcast("authLogoutSuccess"),e.data.user.email=null,w.check()})},authorize:function(e,t){return void 0===t&&(t=$.role),e.bitMask&t.bitMask},changeUser:function(e){d(e)},getCurrentUser:function(){var e;return e=t.defer(),e.resolve($),e.promise},fetchUser:function(){return a.get().$promise.then(function(n){e.data.user=n,$.data=n;var a;return a=t.defer(),a.resolve(n),a.promise})},accessLevels:v,userRoles:b,user:$};return w}]),function(){function e(e,t){function n(){return t.get().$promise.then(function(t){e.data.current_ip=t})}return{init:n}}e.$inject=["$rootScope","CurrentIPResource"],angular.module("casino.services").factory("CurrentIPService",e)}(),CasinoServices.factory("Restrictions",["$rootScope","$state","Notification",function(e,t,n){var a=[],r={currency:function(e){var t=!1;for(var n in a.currency)a.currency[n].code.indexOf(e.toUpperCase())>-1&&(t=!0);return t},auth:function(e){var t=!1;for(var n in a.auth)n==e&&(t=!0);return t}};return{init:function(t,n){a=[];for(var r in n)for(var o in t)t[o].mark==n[r]&&(a[t[o].resource]||(a[t[o].resource]={}),a[t[o].resource][n[r]]=t[o].scope);e.data.restrictions=a},isRestricted:function(e,t){var n=!1;return a[e]&&(n=r[e](t)),n},checkAuth:function(a,r){var o=!1;return this.isRestricted("auth",a)&&(o=!0,r&&-1==t.current.name.indexOf("users")&&(o=!1)),o&&(n.show("restriction.registration_restricted_in_country",{classes:"alert-danger"}),t.go("home",{lang:e.currentLocale})),o}}}]),CasinoDirectives.directive("restrictionsHide",["$rootScope","Restrictions",function(e,t){return{restrict:"EA",replace:!1,scope:{restrict:"@"},controller:["$rootScope","$scope","$element",function(e,t,n){var a=t.restrict+"_currencies_forbidden",r=!1;_.contains(_.keys(e.data.restrictions.currency),a)&&(r=!0),r&&n.remove()}]}}]),CasinoServices.factory("Autoscroll",[function(){var e=!1;return{check:function(t){var n=!1;return e?n=!0:setTimeout(function(){e=!0},1e3),n}}}]),CasinoServices.factory("External",["SYSTEM","$window","$rootScope","$http","$templateCache","$compile","$timeout","$location","PushNotifications","CHATRA_LOCALES",function(e,t,n,a,r,o,i,s,c,u){function l(e){var t=e.createElement("link"),n=e.getElementsByTagName("head")[0];t.rel="manifest",t.href="/manifest.json",n.appendChild(t)}function d(e,t){var n=e.createElement("script"),a=e.getElementsByTagName("head")[0];n.async=!0,n.src="https://cdn.onesignal.com/sdks/OneSignalSDK.js",n.type="text/javascript",n.addEventListener("load",t,!1),a.appendChild(n)}function f(){"serviceWorker"in navigator&&!navigator.serviceWorker.controller&&navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(function(e){},function(e){console.log("ServiceWorker registration failed: ",e)})}var m={GTM:function(n){function a(e){for(var t=window.location.search.substring(1),n=t.split("&"),a=0;a<n.length;a++){var r=n[a].split("=");if(r[0]==e)return r[1]}return!1}t.dataLayer||(t.dataLayer=[]),e.GOOGLE_TAG_MANAGER_ID&&(!function(e,t,n,r,o){e[r]=e[r]||[],e[r].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=t.getElementsByTagName(n)[0],c=t.createElement(n);if(c.async=!0,c.src="//www.googletagmanager.com/gtm.js?id="+o,i.parentNode.insertBefore(c,i),a("__layerref")){var u=decodeURIComponent(a("__layerref"));Object.defineProperty(document,"referrer",{get:function(){return u}}),s.search("__layerref",null)}}(window,document,"script","dataLayer",e.GOOGLE_TAG_MANAGER_ID),i(n,5e3))},YM:function(){e.YANDEX_METRIKA&&function(t,n,a){(n[a]=n[a]||[]).push(function(){try{n.yaCounter=new Ya.Metrika({id:e.YANDEX_METRIKA,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})}catch(e){}});var r=t.getElementsByTagName("script")[0],o=t.createElement("script"),i=function(){r.parentNode.insertBefore(o,r)};o.type="text/javascript",o.async=!0,o.src="https://mc.yandex.ru/metrika/watch.js","[object Opera]"==n.opera?t.addEventListener("DOMContentLoaded",i,!1):i()}(document,window,"yandex_metrika_callbacks")},Livechatinc:function(){if(e.LIVECHATIC){t.__lc=e.LIVECHATIC;var a=function(){if(n.user.data&&n.user.data.email){var e=n.user.data.nickname;n.user.data.first_name&&n.user.data.last_name&&(e=n.user.data.first_name+" "+n.user.data.last_name),t.__lc.visitor={name:e||"",email:n.user.data.email}}};n.$watch("user",function(e,t){n.user&&e!=t&&a()},!0),a();var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src=("https:"==document.location.protocol?"https://":"http://")+"cdn.livechatinc.com/tracking.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(r,o)}},Zopim:function(){if(e.ZOPIM){var t=function(){if(n.user.data&&n.user.data.email){var e=n.user.data.nickname;n.user.data.first_name&&n.user.data.last_name&&(e=n.user.data.first_name+" "+n.user.data.last_name),window.$zopim.livechat?(window.$zopim.livechat.setName(e||""),window.$zopim.livechat.setEmail(n.user.data.email),r()):window.$zopim(function(){window.$zopim.livechat.setName(e||""),window.$zopim.livechat.setEmail(n.user.data.email),r()})}},a=function(e){var t="en";switch(e){case"zh":t="zh_CN"}return t},r=function(){window.$zopim.livechat.setLanguage(a(n.currentLocale))};n.$watch("user",function(e,a){n.user&&e!=a&&t()},!0),n.$on("localeChanged",function(e,t){r()}),window.$zopim||function(n,a){var r=window.$zopim=function(e){r._.push(e)},o=r.s=n.createElement(a),i=n.getElementsByTagName(a)[0];r.set=function(e){r.set._.push(e)},r._=[],r.set._=[],o.async=!0,o.setAttribute("charset","utf-8"),o.src="//v2.zopim.com/?"+e.ZOPIM,r.t=+new Date,o.type="text/javascript",i.parentNode.insertBefore(o,i),t()}(document,"script")}},ServiceWorkersManager:function(){e.ONESIGNAL&&!e.ENABLE_PWA?(console.log("Start Init service worker for One Signal"),l(document),d(document,c.init)):!e.ONESIGNAL&&e.ENABLE_PWA?(console.log("Start Init service worker PWA"),l(document),f()):e.ONESIGNAL&&e.ENABLE_PWA&&(console.log("Start Init service worker for One Signal and PWA"),l(document),d(document,c.init),f())},Chatra:function(){if(e.CHATRA){var t=function(e){return Math.floor(Math.random()*Math.floor(e))},a=function(e){var t="en";return e&&(t=e),"zh"===e&&(t="zh_CN"),"nn"===e&&(t="nb"),t},r=function(t){return e.CHATRA.customLocales&&e.CHATRA.customLocales.includes(t)&&Object.keys(u).includes(t)?u[t]:""},o=function(o){if(o)i=l=(e.CHATRA.prefix||"")+"anonym_"+t(2e6),s=a(n.currentLocale);else if(n.user.data&&n.user.data.email)var i=(e.CHATRA.prefix||"")+n.user.data.id,s=a(n.currentLocale),c=n.user.data.nickname,u=n.user.data.email,l=n.user.data.first_name||u.substring(0,u.indexOf("@")),d=n.user.data.last_name;else i=l=(e.CHATRA.prefix||"")+"anonym_"+t(2e6),s=a(n.currentLocale);window.ChatraSetup={language:s,clientId:i,groupId:e.CHATRA.groupId,locale:r(n.currentLocale)},window.ChatraIntegration={nickname:c||"",email:u||"",name:l||"",last_name:d||""}};!function(t,n,a){n.ChatraID=e.CHATRA.id,o();var r=t.createElement("script");n[a]=n[a]||function(){(n[a].q=n[a].q||[]).push(arguments)},r.async=!0,r.src="https://call.chatra.io/chatra.js",t.head&&t.head.appendChild(r)}(document,window,"Chatra"),n.$on("authLoginFormSuccess",function(){o(),window.Chatra&&window.Chatra.restart()}),n.$on("authLogoutSuccess",function(){o(!0),window.Chatra&&window.Chatra.restart()}),n.$on("localeChanged",function(){window.ChatraSetup.language=a(n.currentLocale),window.ChatraSetup.locale=r(n.currentLocale),window.Chatra.restart()})}},Kayako:function(){function t(){if(window.user_data={name:"",email:""},n.user.data&&n.user.data.email){var e=n.user.data.nickname;n.user.data.first_name&&n.user.data.last_name&&(e=n.user.data.first_name+" "+n.user.data.last_name),window.user_data.email=n.user.data.email||"",window.user_data.name=e||""}}if(!e.KAYAKO)return!1;var i=[],s=e.KAYAKO.is_button?"HTMLButton":"SiteBadge",c=function(){};async.series([function(t){a.get("/app/services/templates/Kayako/"+s+".html",{cache:r}).success(function(a){a=a.replace(new RegExp("{KAYAKO_ID}","g"),e.KAYAKO.ID),document.body.appendChild(o(a)(n)[0]),t()})},function(t){window["swiftscriptelem"+e.KAYAKO.ID]=document.createElement("script"),window.swiftrandom=Math.floor(1001*Math.random()),window.swiftuniqueid=e.KAYAKO.ID,i.push("//softswiss.kayako.com/visitor/index.php?"),i.push(e.KAYAKO.TEMPLATE),i.push("LiveChat"),i.push("HTML"),i.push(s),i.push(window.swiftrandom+e.KAYAKO.HASH),window["swifttagurl"+e.KAYAKO.ID]=i.join("/"),setTimeout(function(){window["swiftscriptelem"+e.KAYAKO.ID].src=window["swifttagurl"+e.KAYAKO.ID],document.getElementById("swifttagcontainer"+e.KAYAKO.ID).appendChild(window["swiftscriptelem"+e.KAYAKO.ID])},1),window["swiftscriptelem"+e.KAYAKO.ID].onload=function(){t()}},function(t){var n;e.KAYAKO.is_button?document.querySelectorAll("#swifttagdatacontainer"+e.KAYAKO.ID+" a")&&(n=document.querySelectorAll("#swifttagdatacontainer"+e.KAYAKO.ID+" a")[0].href.match(/.*?_(.*?)\(/)[1]):document.getElementById("kayako_sitebadgecontainer")&&(n=(document.getElementById("kayako_sitebadgecontainer").onclick+"").match(/.*?_(.*?)\(/)[1]),c=function(t){window["isChatRunning_"+n]=1,docWidth=(winW-599)/2,docHeight=(winH-679)/2,_chatWindowURL="http://softswiss.kayako.com/visitor/index.php?/"+e.KAYAKO.TEMPLATE+"/LiveChat/Chat/Request/_sessionID="+window["sessionid_"+n]+"/_proactive="+t+"/_randomNumber="+window["doRand_"+n]()+"/_fullName="+encodeURIComponent(window.user_data.name)+"/_email="+encodeURIComponent(window.user_data.email)+"/_promptType=chat",chatwindow=window.open(_chatWindowURL,"customerchat"+window["doRand_"+n](),"toolbar=0,location=0,directories=0,status=1,menubar=0,scrollbars=yes,resizable=1,width=599,height=679,left="+docWidth+",top="+docHeight),window["hideProactiveChatData_"+n]()},window["startChat_"+n]=c,t()}]),n.$watch("user",function(e,n){e!=n&&t()},!0),t()}};return{services:m,inited:!1,init:function(e){if(!this.inited){for(var t in m){var n=e[t]||function(){};m[t](n)}this.inited=!0}}}}]),CasinoServices.service("PushNotifications",["SYSTEM","$window","$timeout","$rootScope",function(e,t,n,a){function r(){s=t.OneSignal||[],s.push(function(){s.init({appId:e.ONESIGNAL.CONFIG.appId,safari_web_id:e.ONESIGNAL.CONFIG.safari_web_id,autoResubscribe:!0,notifyButton:{enable:!1},allowLocalhostAsSecureOrigin:e.ONESIGNAL.CONFIG.allowLocalhostAsSecureOrigin})}),e.ONESIGNAL&&e.ONESIGNAL.SEND_USER_DATA&&s.push(function(){o()})}function o(e){e=e||i(),s.push(function(){s.sendTags(e)})}function i(t){var n={};if((t=t||e.ONESIGNAL.SEND_USER_DATA)&&t.length&&a.data.user.email)for(var r in t)switch(t[r]){case"name":n.name=a.data.user.first_name;break;case"freespins":break;default:a.data.user&&a.data.user[t[r]]?n[t[r]]=a.data.user[t[r]]:a.data.user_stats&&void 0!=a.data.user_stats[t[r]]&&(n[t[r]]=a.data.user_stats[t[r]])}return n}var s;return{init:r,sendTags:o,getTags:i}}]),CasinoServices.factory("RealTime",["$rootScope","Player","$timeout",function(e,t,n){var a={config:{},user:""},r=[],o=[],i=!1,s=function(){var e=_.flatten([o,r]);o=[],r=[],i&&i.disconnect(),i=new Centrifuge(a.config);for(var t in e)u(e[t].channel,e[t].callback);i.connect()},c=function(){t.settings(function(e){a.config=e.cent,a.config.user=e.cent.user,s()})},u=function(e,t){if(!i||"#"==e[e.length-1]&&""==a.config.user)r.push({channel:e,callback:t});else{var n=e;"#"==e[e.length-1]&&(n=e+a.config.user),i.subscribe(n,t),o.push({channel:e,callback:t})}};return n(function(){c(),e.$on("authLoginSuccess",function(){c()}),e.$on("authLogoutSuccess",function(){c()})},1e3),{subscribe:u}}]),CasinoServices.factory("SeoData",["$rootScope","Pages",function(e,t){function n(e){return e&&"false"!==e?"/"+e:""}e.page={title:"",snippet_title:""};var a=function(){e.page.id="",e.page.title="",e.page.keywords="",e.page.description="",e.page.content="",e.page.game_title=!1,e.page.layout="default"},r=function(n){t.list({l:e.currentLocale}).$promise.then(function(r){function o(e){return e.some(function(e){return e.path===n||(e.children?o(e.children):void 0)})}o(r)?t.byId({id:n,l:e.currentLocale}).$promise.then(function(t){e.page.id=t.id,e.page.title=t.blocks.title,e.page.keywords=t.blocks.keywords,e.page.description=t.blocks.description,e.page.content=t.content,e.page.layout=t.layout,e.page.blocks=t.blocks}).catch(function(e){a()}):a()})};return e.$on("$stateChangeSuccess",function(t,a,o,i,s){if("external"!=a.page_name&&""!=i.page_name){var c="cms"===a.page_name?o.path:a.page_name;c="games"==a.page_name?"games"+n(o.category)+n(o.provider):c,"404"==a.page_name&&(c="404"),r(c);for(var u in e.sidebar)e.sidebar[u].visible=!1}}),e.$on("$stateChangeStart",function(e,t,a,o,i){if("external"!=t.page_name&&""!=o.page_name){var s="cms"==t.page_name?a.path:t.page_name,s="games"==t.page_name?"games"+n(a.category)+n(a.provider):s;r(s)}}),{init:function(e){var t="cms"==e.current.page_name?e.params.path:e.current.page_name,t="games"==e.current.page_name?"games"+n(e.params.category)+n(e.params.provider):t;r(t)},get:r}}]),function(){function e(e,t,n,a,r,o,i,s,c,u,l,d,f,m,p,g,h,_){function y(){var n=Object.assign({},a.search());Object.keys(a.search()).forEach(function(e){u.includes(e)||a.search(e,null)}),["ctag","btag","stag","qtag","refer","subid"].forEach(function(e){a.search(e,null)});var o=new Date;o.setTime(o.getTime()+2592e6),c.forEach(function(e){var t=a.search();t[e]&&r.put(e,t[e],{expires:o.toGMTString()})});var i=["/api/restrictions","/api/restrictions/marks"],s=d.get().$promise,g=e.all({locales:l.locales(n).$promise,user:s,batch:m.get({"url[]":i}).$promise});g.then(function(e){f.init(JSON.parse(e.batch[0]),JSON.parse(e.batch[1])),p.changeUser(e.user),t.Info.locales=e.locales,A.data.locales=e.locales;var n=e.user.toJSON();t.user_locale=n.language,A.data.user_locale=n.language,t.$on("authLoginSuccess",function(e,n){t.currentLocale!==n.language&&(A.data.current_locale=null,A.data.user_locale=null,t.currentLocale=null,t.user_locale=null),$(n.language),C()}),t.$on("authLogoutSuccess",function(){C()})});var h=t.$on("$stateChangeStart",function(e,t,n){h(),e.preventDefault(),g.then(function(){A.checkLocaleAndRunState(t,n)})})}function v(){var n=e.defer();return t.currentLocale?n.resolve(!0):t.$watch("currentLocale",function(e,t){e!==t&&n.resolve(!0)}),n.promise}function b(e,n){var r,i;h.DEFAULT_LANGUAGE||(h.DEFAULT_LANGUAGE="en"),!A.data.current_locale&&n.lang!==h.DEFAULT_LANGUAGE&&(i=A.data.locales.some(function(e){return e.code===n.lang})),r=i?n.lang:A.data.user_locale,A.data.current_locale||t.$broadcast("localeDetected",r),i&&n.lang!==A.data.user_locale||E?(E&&(i||(r=h.DEFAULT_LANGUAGE)),$(r)):S(r),a.hash()&&(n["#"]=a.hash()),n.lang=r,o.go(e,n)}function $(e){return A.data.current_locale!==e||E?(g.update_locale({locale:e}).$promise.then(function(t){t.language!==e&&A.data.current_locale?console.error("locale has not been changed!"):S(t.language)}),e):e}function S(e){var r={lang:e};a.hash()&&(r["#"]=a.hash()),o.current.abstract||s(function(){o.go(o.current,r,{reload:!1})}),n.use(e.slice(0,2)),A.data.current_locale=e,A.data.user_locale=e,t.currentLocale=e,t.user_locale=e,t.$broadcast("localeChanged",e)}function w(e){return A.data.current_locale!==e&&A.setLocale(e),e}function C(){var e=["/api/restrictions","/api/restrictions/marks"];m.get({"url[]":e}).$promise.then(function(e){f.init(JSON.parse(e[0]),JSON.parse(e[1]))})}var A={data:{current_locale:!1,default_locale:!1,user_locale:!1,locales:[]},init:y,run:v,checkLocaleAndRunState:b,setLocale:$,change:w},E="Prerender"===window.navigator.userAgent;return A}e.$inject=["$q","$rootScope","$translate","$location","$cookies","$state","$stateParams","$timeout","UTM_PARAMS","ALLOW_QUERY_PARAMS","Info","Player","Restrictions","Batch","Auth","Locales","SYSTEM","FLAGS"],angular.module("casino.services").factory("siteLanguage",e)}(),function(){function e(e){this.showAvailableGamesModal=e.showAvailableGamesModal}e.$inject=["AvailableGamesService"],angular.module("casino").component("casinoAvailableGames",{templateUrl:["$element","$attrs",function(e,t){return"/app/Games/AvailableGames/_"+(t.template||"main")+".html"}],controller:e,bindings:{close:"&",dismiss:"&",games:"<",currency:"<"}}),angular.module("casino").controller("AvailableGamesCtrl",e)}(),function(){function e(e,t,n){function a(n){n=n||{},n.template=n.template||"main",e.mainModal.modal=t.open({template:'<casino-available-games template="'+n.template+'"games="$ctrl.games"currency="$ctrl.currency"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></casino-available-games>',controller:function(){this.games=n.games,this.currency=n.currency},windowClass:"modal-available-games",controllerAs:"$ctrl"})}function r(e){return function(t){return!Object.keys(e).some(function(n){return!!e[n].game&&(e[n].game.identifier===t.identifier&&1!==Object.keys(e).length)})}}function o(e){return function(t){
return!Object.keys(e).some(function(n){if(e[n].game){return!(Object.keys(e).length<2)&&"amatic"===e[n].game.provider&&"amatic"===t.provider}return!1})}}function i(e){return function(t){var a=n.data.current_game,r=Object.keys(e).length>1,o=t.collections.includes("live")&&a&&"FUN"===a.currency;return!(r&&o)}}return{showAvailableGamesModal:a,isGameAlreadyOpened:r,isAmaticAlreadyOpened:o,isLiveGameForFun:i}}e.$inject=["$rootScope","$modal","GameSelector"],angular.module("casino.services").factory("AvailableGamesService",e)}(),CasinoControllers.controller("GamesBlock",["$scope","$rootScope","GamesData","Auth","$stateParams","FavoriteList","LastPlayedList","GamesBlockStateService","$timeout","$state",function(e,t,n,a,r,o,i,s,c,u){function l(){if(_.keys(e.filters.data).indexOf("collection")>-1&&_.keys(e.filters.data).indexOf("provider")>-1){var n,a,r,o=d(e.filters.data.collection),i=d(e.filters.data.provider);1==i.length&&(a=i[0]),i.length>1&&(a="false"),1==o.length&&(n=o[0]),o.length>1&&1==i.length&&(n="all",r=!0),o.length>1&&i.length>1&&(n=""),u.go("app.games",{category:n,provider:a,lang:t.currentLocale,filters:e.filters.data,has_multiple_collections:r})}}function d(e){return _.isArray(e)||(e=[e]),e}var f=!1,m=!1,p=!1;e.isolated||(f=r.category||!1,m=r.provider||!1,p=r.order||!1);var g=null;if("home"!==u.current.name&&t.fromState&&"app.game"===t.fromState.name||"home"===u.current.name&&r.from_game){var h=s.getByName(e.name);h&&(g=h.limit_count,angular.element(document).ready(function(){window.scrollTo(0,s.getScrollY())}))}t.$broadcast("rzSliderForceRender"),e.$on("$destroy",function(){"app.game"!==t.fromState.name&&(s.setByName(e.name,{limit_count:e.limit_count}),s.setScrollY(window.scrollY))}),m="false"!==m&&m,e.limit_count=g||e.limit_count,e.limit=e.limit_count,e.accessLevels=a.accessLevels,e.data=t.data,e.state=u,e.favorites=o,e.favorites.show=r.show_favorites||!1,e.lastPlayed=i,e.gamesData=n,e.isString=_.isString,r.filters&&Object.keys(r.filters).length&&(e.default_filters=_.extend(e.default_filters,r.filters)),f&&e.default_filters&&!r.has_multiple_collections&&(e.default_filters.collection=f),m&&e.default_filters&&(e.default_filters.provider=m),p&&e.default_filters&&(e.default_filters.collectionOrder=p),n.filters.has(e.name)&&t.fromState&&"app.game"===t.fromState.name&&"home"!==u.current.name&&"app.games"!==u.current.name?e.filters=n.filters.get(e.name):e.filters=n.filters.get(e.name,e.default_filters),e.onSliderChange=function(){e.addMultiplyFilter({hit_rate:e.filters.data.hit_rate,payout:e.filters.data.payout}),e.filters.data.hit_rate&&(e.filters.data.hit_rate.minValueTemp=e.filters.data.hit_rate.minValue,e.filters.data.hit_rate.maxValueTemp=e.filters.data.hit_rate.maxValue,e.filters.data.hit_rate.error.min=!1,e.filters.data.hit_rate.error.max=!1),e.filters.data.payout&&(e.filters.data.payout.minValueTemp=e.filters.data.payout.minValue,e.filters.data.payout.maxValueTemp=e.filters.data.payout.maxValue,e.filters.data.payout.error.min=!1,e.filters.data.payout.error.max=!1)},e.changeFilter=function(t){e.filters.changeFilter(t),l()},e.addMultiplyFilter=function(t){e.filters.addMultiplyFilter(t),l()},e.removeMultiplyFilter=function(t){e.filters.removeMultiplyFilter(t),l()},e.initSliderOptions=function(t,n){n.floor=_.isNumber(n.floor)?n.floor:e.filters.data[t].sliderOptions.floor,n.ceil=_.isNumber(n.ceil)?n.ceil:e.filters.data[t].sliderOptions.ceil,n.minValueTemp=n.floor,n.maxValueTemp=n.ceil,_.assign(e.filters.data[t].sliderOptions,n)},e.onRangeSliderInputChange=function(t){if("min"===t.minMaxType){e.filters.data[t.filterType].minValueTemp>e.filters.data[t.filterType].sliderOptions.floor-1&&e.filters.data[t.filterType].minValueTemp<e.filters.data[t.filterType].maxValue&&_.isNumber(e.filters.data[t.filterType].minValueTemp)?(e.filters.data[t.filterType].minValue=e.filters.data[t.filterType].minValueTemp,e.filters.data[t.filterType].error.min=!1,e.onSliderChange()):e.filters.data[t.filterType].error.min=!0}if("max"===t.minMaxType){e.filters.data[t.filterType].maxValueTemp>e.filters.data[t.filterType].sliderOptions.floor&&e.filters.data[t.filterType].maxValueTemp>e.filters.data[t.filterType].minValue&&_.isNumber(e.filters.data[t.filterType].minValueTemp)?(e.filters.data[t.filterType].maxValue=e.filters.data[t.filterType].maxValueTemp,e.filters.data[t.filterType].error.max=!1,e.onSliderChange()):e.filters.data[t.filterType].error.max=!0}};var y=function(e){for(var t=0,n=0;e;)t+=parseFloat(e.offsetTop),n+=parseFloat(e.offsetLeft),e=e.offsetParent;return{top:Math.round(t),left:Math.round(n)}};e.loadMore=function(t,n){e.limit_count=parseInt(e.limit_count)+t,n&&"function"==typeof n&&c(function(){n()})},e.stateGo=function(e,n){n=n||{},n.lang=t.currentLocale;var a=$(".casino-filter-inner"),r=0;a[0]&&(r=y(a[0].parentNode).top+parseInt(a.attr("casino-games-filter"))),r!=$(window).scrollTop()?$("body").animate({scrollTop:r},{duration:300,complete:function(){e&&u.transitionTo(e,n)}}):e&&u.transitionTo(e,n)}}]),CasinoDirectives.directive("casinoGamesBlock",[function(){return{restrict:"E",replace:!0,scope:{name:"@name",template:"@template",default_filters:"=filters",limit_count:"<limit",isolated:"@isolated",gridItemNumber:"="},templateUrl:function(e,t){return"/app/Games/Block/_"+(t.template||"block")+".html"},controller:"GamesBlock"}}]),function(){function e(e){function t(e){return i[e]}function n(e,t){i[e]=t}function a(t){s||(s=!0,o=t,e(function(){s=!1},100))}function r(){return o}var o,i={},s=!1;return{getByName:t,setByName:n,setScrollY:a,getScrollY:r}}e.$inject=["$timeout"],angular.module("casino.services").factory("GamesBlockStateService",e)}(),CasinoServices.factory("Favorite",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/player/favorite_games/:id",{id:"@id"},{list:{method:"GET",isArray:!0},add:{method:"PUT"},remove:{method:"DELETE"}})}]).factory("FavoriteList",["Favorite","Auth","$rootScope","GamesData",function(e,t,n,a){var r=[],o=t.user,i=!1,s=function(){!i&&t.authorize(t.accessLevels.user,o.role)&&a.inited&&e.list(function(e){if(a.inited){for(var t=0;t<e.length;t++){a.getById(e[t])&&r.push(e[t])}i=!0,n.$broadcast("favoriteListInitialized",r)}},function(){r=[]})},c=function(t){e.add({id:t}),r.push(t)},u=function(t){var n=r.indexOf(t);n>-1&&(e.remove({id:t}),r.splice(n,1))},l=function(e){var t;if(t="object"==_typeof(e)?a.getGameByCurrency(e,"FUN").id:e,d(e))if("object"==_typeof(e))for(var o in e.currencies)u(e.currencies[o].id);else u(t);else c(t);n.$broadcast("favoriteListUpdated",r)},d=function(e){var t=!1;if("object"==_typeof(e)){for(var n in e.currencies)if(r.indexOf(e.currencies[n].id)>-1){t=!0;break}}else r.indexOf(e)>-1&&(t=!0);return t},f=function(){for(;r.length;)r.pop()};return n.$watch("data.user.email",function(e,t){i=!1,f(),n.data.user.email&&e!=t&&s()},!0),n.$watch("data.games.inited",function(e){n.data.user.email&&e&&s()},!0),{list:r,inited:i,favorite:l,isFavorite:d,get_list:function(){return r}}}]),CasinoDirectives.directive("casinoGamesFilter",["$window",function(e){return{require:"^?casinoGamesFilterTarget",link:function(t,n,a){var r=function(e){for(var t=0,n=0;e;)t+=parseFloat(e.offsetTop),n+=parseFloat(e.offsetLeft),e=e.offsetParent;return{top:Math.round(t),left:Math.round(n)}};angular.element(document.getElementsByClassName("casino-games-filter-scroll")).on("click",function(){e.scrollTo(0,r(n[0].parentNode).top+parseInt(a.casinoGamesFilter))})}}}]),function(){angular.module("casino.directives").directive("casinoGameSelector",[function(){return{restrict:"E",replace:!0,scope:{},templateUrl:"/app/Games/GameSelector/_game_selector.html",controller:["$rootScope","$scope","GameSelector","$stateParams",function(e,t,n,a){t.data=n.data,t.numberOfGames=1,t.$watch("data",function(){t.game=n.data.game,t.numberOfGames=n.data.numberOfGames,n.data.current_game?t.current_game_currency=n.data.current_game.currency:t.current_game_currency=a.currency||e.data.user.currency},!0)}]}}])}(),function(){function e(e){function t(t){var o=n(t);r.game=angular.copy(t[o]&&t[o].game),r.origin_game=angular.copy(r.game),r.current_game=angular.copy(r.game?r.game.currencies[r.current_game&&r.current_game.currency]||r.game.currencies[e.data.user.currency]:null),a()}function n(e){return Object.keys(e).find(function(t){return e[t].game})}function a(){if(r.game&&r.balances&&r.balances.length){var e=[];r.game.collections.indexOf("live")<0&&e.push("FUN"),r.balances.forEach(function(t){e.push(t.code)});var t={};for(var n in r.origin_game.currencies)e.indexOf(n)>-1&&(t[n]=r.origin_game.currencies[n]);r.game.currencies=t}}var r={game:null,current_game:null,balances:null,numberOfGames:1};return e.$on("gameOpenSuccess",function(t,n,o,i){r.game=JSON.parse(JSON.stringify(n)),r.origin_game=angular.copy(r.game),r.current_game=o,e.$broadcast("balanceRefresh"),a()}),e.$on("balanceRefreshSuccess",function(e,t){r.balances=t,a()}),e.$on("gameCloseSuccess",function(){r.current_game_currency=null,r.game=null,r.origin_game=null}),e.$on("splitGamesSuccess",function(e,n){r.numberOfGames=n.numberOfGames,t(n.games_grid)}),e.$on("gridGameClosedSuccess",function(e,n){t(n.games_grid)}),{data:r}}e.$inject=["$rootScope"],angular.module("casino.services").factory("GameSelector",e)}(),CasinoDirectives.directive("casinoGamesFillingLucky",["$stateParams","$filter",function(e,t){return{restrict:"E",replace:!0,scope:{filter_name:"@filterName"},templateUrl:function(e,t){return"/app/Games/FillingLucky/_"+(t.template||"filling_lucky")+".html"},controller:["$scope","GamesData",function(e,t){e.play=function(n){void 0==n&&(n=!0);var a=!1,r=t.filters.get(e.filter_name);return a=r.games[Math.floor(Math.random()*r.games.length)],n&&(window.location.href=t.getGameUrl(a.play_url)),a}}]}}]),CasinoDirectives.directive("casinoGamesAutocomplete",[function(){return{restrict:"E",replace:!0,scope:{name:"@name",default_filters:"=filters",limit_count:"@limit"},templateUrl:"/app/Games/GamesAutocomplete/_games_autocomplete.html",controller:"GamesBlock"}}]),CasinoDirectives.directive("casinoGamesSlider",[function(){return{restrict:"E",replace:!0,scope:{name:"@name",template:"@template",default_filters:"=filters",limit_count:"@limit",isolated:"@isolated"},templateUrl:function(e,t){return"/app/Games/GamesSlider/_"+t.template+"_slider.html"},controller:"GamesBlock"}}]).directive("uixBxslider",function(){return{restrict:"A",link:function(e,t,n,a){var r=n.uixBxslider?e.$eval("{"+n.uixBxslider+"}"):{mode:"horizontal",pager:!1,controls:!0,minSlides:1,maxSlides:20,slideWidth:250,adaptiveHeight:!0,slideMargin:0,infiniteLoop:!1,moveSlides:4};e.$on("repeatFinished",function(){e.slider?e.slider.reloadSlider():e.$apply(function(){e.slider=$(t).bxSlider(r)})}),e.$watch(function(){return t[0].children.length},function(t,n){t!=n&&e.slider&&e.slider.reloadSlider()})}}}).directive("notifyWhenRepeatFinished",["$timeout",function(e){return{restrict:"A",link:function(t,n,a){!0===t.$last&&e(function(){t.$emit("repeatFinished")})}}}]),function(){function e(e,t,n,a){function r(){var r,i,s,c,u=e.data.user.currency,l=(u||o.defaultCurrency||"EUR").toUpperCase();n.currencies().$promise.then(function(e){var n=a.getJackpotByCurrency(l);if(n){var u=e.find(function(e){return e.code===l}),d=u.symbol;c=t("casino_currency")(n,d),s=c.indexOf("."),i=c.substr(s+1),r=c.substr(0,s),o.totalJackpotIntWithSymbol=r,o.fractionalSymbol=".",o.totalJackpotFractional=i,o.totalJackpotFullFormatted=c}})}var o=this;o.totalJackpotIntWithSymbol=null,o.fractionalSymbol=null,o.totalJackpotFractional=null,o.totalJackpotFullFormatted=null,e.$on("balanceRefreshSuccess",r),e.$on("gamesInitialized",r),r()}e.$inject=["$rootScope","$filter","Info","GamesData"],angular.module("casino").component("casinoJackpotsTotal",{templateUrl:"/app/Games/JackpotsTotal/_jackpots_total.html",controller:e,bindings:{defaultCurrency:"@"}})}(),CasinoServices.factory("LastPlayedList",["localStorageService","$rootScope","GamesData",function(e,t,n){function a(){return c}function r(t){t&&(o(t,s),o(t,c),e.set("last_played_ids",s))}function o(e,t){var n=t.indexOf(e);-1!==n&&t.splice(n,1),t.unshift(e)}function i(){var e=s.filter(function(e){return n.getByIdentifier(e)});[].push.apply(c,e),u()}var s=e.get("last_played_ids")||[],c=[],u=t.$on("gamesInitialized",i);return{get_list:a,add:r,init:i,last_played_list:c}}]),CasinoDirectives.directive("casinoLazySrc",["$compile","$timeout",function(e,t){return{restrict:"A",link:function(e,n,a){var r=function(){if(!a.loading&&0!==n[0].getBoundingClientRect().top&&n[0].getBoundingClientRect().top<1.2*$(window).height()){var e=a.src;n.on("error",function(){a.$set("src",e)}),a.$set("src",a.casinoLazySrc),a.$set("loading",!0),n[0].style.opacity=1}};t(r,0),$(window).scroll(r),$(window).resize(r),a.$observe("repeatPosition",function(){r()}),a.$observe("casinoLazySrc",function(){a.$set("loading",!1),r()})}}}]),CasinoDirectives.directive("casinoFooter",function(){return{replace:!0,restrict:"E",templateUrl:"/app/Layout/Footer/_footer.html"}}),CasinoDirectives.directive("casinoHeader",function(){return{replace:!0,restrict:"E",templateUrl:"/app/Layout/Header/_header.html"}}),CasinoConstants.constant("FLAGS",{ar:"ae",af:"za",bg:"bg",cs:"cs",da:"dk",de:"de","de-AT":"at",el:"gr",en:"gb","en-AU":"au","en-CA":"ca","en-IE":"ie","en-IN":"in","en-NZ":"nz","en-ZA":"za",es:"es","es-MX":"mx",et:"et",fi:"fi",fr:"fr","fr-CA":"ca",hi:"in",hr:"hr",hu:"hu",id:"id",is:"is",it:"it",ja:"jp",ka:"ka",kk:"kz",ko:"kr",ms:"my",nb:"no",nl:"nl",nn:"no",no:"no",tl:"ph",pl:"pl",pt:"pt","pt-BR":"pt",ro:"ro",ru:"ru",sk:"sk",sl:"si",sq:"al",sr:"rs",sv:"se",th:"th",tr:"tr",vi:"vi",uk:"ua","zh-CN":"cn"}),CasinoDirectives.directive("casinoLocalesSelector",["FLAGS",function(e){return{restrict:"E",replace:!0,scope:{order:"@order"},templateUrl:function(e,t){return"/app/Layout/Locales/_"+(t.template||"locales")+".html"},controller:["$scope","$filter","siteLanguage",function(t,n,a){var r=function(e){var a=[];if(t.order&&e){var r=t.order.toLowerCase().split(",");a=n("orderBy")(e,function(t){var n=r.indexOf(t.code.toLowerCase());return-1!=n?n:e.length})}else a=e;return a},o=function(){for(var e=0,n=0,r=t.locales,o=r.length;n<o;n++)if(r[n].code==a.data.current_locale){e=n;break}return e},i=function(e){t.locale=e,t.locales=r(a.data.locales),t.localesCount=a.data.locales.length,t.localeIndex=o()};t.localeIndex=0,t.data=a.data,t.flags=e,t.changeLocale=function(e){t.locale=a.change(e),t.localeIndex=o()},t.$on("localeDetected",function(e,t){i(t)}),t.$on("localeChanged",function(e,n){t.localeIndex=o()}),a.data.current_locale&&i(a.data.current_locale)}]}}]).directive("casinoLocaleActive",["FLAGS","siteLanguage",function(e,t){return{restrict:"E",replace:!0,scope:{},templateUrl:"/app/Layout/Locales/_currentLocale.html",controller:["$rootScope","$scope",function(n,a){a.flags=e,t.data.current_locale&&(a.locale=t.data.current_locale),a.$on("localeChanged",function(e,t){a.locale=t})}]}}]),CasinoDirectives.directive("casinoMenu",[function(){return{restrict:"E",replace:!0,scope:{type:"@type",template:"@template"},templateUrl:function(e,t){var n=t.type;return t.template&&(n=t.template),"/app/Layout/Menu/_"+n+".html"},controller:["$scope","Pages","Auth","$rootScope","$state","Info","$timeout",function(e,t,n,a,r,o,i){var s=[],c=r.get();e.accessLevels=n.accessLevels,e.state=r,e.menu=s,e.currentLocale=a.currentLocale,e.root=a,e.get_sref=function(e){var t="app.external({id:'"+e+"', lang:'"+a.currentLocale+"'})";for(var n in c)if(c[n]&&""!=c[n].name&&(c[n].name=="app."+e||c[n].name==e)){t=c[n].name+"({lang:'"+a.currentLocale+"'})";break}if("games"===e.split("/")[0]){t="app.games({"+("category:'"+(e.split("/")[1]||"")+"'")+(",provider:'"+(e.split("/")[2]||"")+"'")+",lang:'"+a.currentLocale+"'})"}return t=t.replace("/","/")};var u=function(){t.list({l:a.currentLocale},function(t){for(var n=[],a=0,r=t.length;a<r;a++)if(-1!=t[a].categories.indexOf(e.type)&&n.push(t[a]),t[a].children&&t[a].children.length)for(var o=0,i=t[a].children.length;o<i;o++)-1!=t[a].children[o].categories.indexOf(e.type)&&n.push(t[a].children[o]);e.menu=n})};e.$on("localeChanged",function(t,n){e.currentLocale=n,u()}),a.currentLocale&&u(),e.scrollPageTo=function(e,t){return e=e||0,t=t||850,i(function(){$("body,html").animate({scrollTop:e},t)}),!1}}]}}]),CasinoDirectives.directive("casinoMobileMenu",["$rootScope","$timeout","$window",function(e,t,n){return{restrict:"E",replace:!0,templateUrl:"/app/Layout/MobileMenu/_mobile_menu.html",link:function(a,r,o){var i,r=$(r),s=o.menuConfig?a.$eval("{"+o.menuConfig+"}"):{},c=function(){var t=r.mmenu(s);i=t.data("mmenu"),e.data.mobile_menu=i};e.$on("preloadHide",function(){t(function(){c()})}),angular.element(n).bind("resize",function(){i&&!r.find("input:focus").length&&i.close()}),e.$on("$stateChangeStart",function(){i&&i.close()})}}}]),CasinoServices.factory("Notification",["SYSTEM","notify","$filter",function(e,t,n){var a={duration:5e3,position:"right"};return e.notification&&e.notification.config&&Object.keys(e.notification.config).forEach(function(t){a[t]=e.notification.config[t]}),t.config(a),{show:function(e,a,r){a=a||{},r=r||{},a.message=n("translate")(e,r),t(a)}}}]),CasinoDirectives.directive("casinoPreloader",[function(){return{restrict:"E",replace:!0,scope:{duration:"@duration"},templateUrl:"/app/Layout/Preloader/_preloader.html",controller:["$rootScope","$scope","$timeout",function(e,t,n){function a(){u&&c&&(!o&&e.$broadcast("siteLoaded"),t.show_preloader&&e.$broadcast("preloadHide"),o=!0)}var r=t.duration||8e3,o=!1,i=!1,s=0,c=!1,u=!1;window.performance&&window.performance.timing&&(r-=Date.now()-window.performance.timing.connectStart),t.is_slow=!1,t.$on("preloadShow",function(){t.show_preloader=!0,i=n(function(){t.is_slow=!0},r)}),t.$on("preloadHide",function(){t.show_preloader=!1,i&&n.cancel(i),t.is_slow=!1}),t.$broadcast("preloadShow"),e.$on("cfpLoadingBar:loaded",function(){s++}),e.$on("gamesInitialized",function(){c=!0,a()}),e.$on("cfpLoadingBar:completed",function(){s>20&&(u=!0,a())})}]}}]),function(){function e(e){function t(t,n){e(function(){n.animate({scrollTop:t||0},"fast")})}return{scrollUp:t}}e.$inject=["$timeout"],angular.module("casino.services").factory("ScrollUpService",e)}(),function(){function e(e,t){return{link:function(n,a,r){a.bind("click",function(){var n=$(r.sRef).offset(),a=n?n.top:0,o=$("html, body");r.scrollUpElement?t(function(){n=$(r.sRef).position(),a=n?n.top:0,o=$(r.scrollUpElement),e.scrollUp(a,o)}):e.scrollUp(a,o)})}}}e.$inject=["ScrollUpService","$timeout"],angular.module("casino").directive("scrollUp",e)}(),CasinoDirectives.directive("casinoSideBar",[function(){return{restrict:"A",controller:["$scope","$rootScope",function(e,t){t.sidebar={},$(".opener").on("click",function(){var e=$(this).parents(".slide-panel");return e.hasClass("visible")?e.removeClass("visible"):e.addClass("visible"),!1}),e.$on("localeChanged",function(e,t){$(".slide-panel").removeClass("visible")})}]}}]),function(){function e(e,t,n,a,r){function o(){v=n.authorize(t.accessLevels.user,t.user.role)?"user":"anon",b=t.Info.files.map(l).filter(i).filter(g).filter(c).map(u),e.enableOrder?e.slides=_.sortBy(b,function(e){return e.order}):e.slides=b}function i(e){var n=!0,a=s(e,"hide"),r=s(e,"show");if(t.data.user.statuses){var o=t.data.user.statuses.map(function(e){return e.id});a.length&&(n=!_.intersection(o,a).length),r.length&&(n=n&&!!_.intersection(o,r).length)}else(a.length||r.length)&&(n=!1);return n}function s(e,t){var n=e.categories.filter(function(e){return e.includes("".concat(t,"-["))}),a=n.reduce(function(e,t){return e.push(t.split("[")[1].split("]")[0].split(",")),e},[]);return _.flatten(a)}function c(e){return d(e)?!!e.categories.includes(v)&&e:e}function u(t){if(t.image=t.url,h(t.description)||(t.description=r.trustAsHtml(t.description.toString())),e.enableOrder){var n=t.categories.find(function(e){return e.indexOf("slider-order-")>-1});n&&(t.order=+n.replace("slider-order-",""))}return t}function l(e){return f(e)&&(e.categories=e.categories.filter(m).filter(p)),e}function d(e){return e.categories.includes("user")||e.categories.includes("anon")}function f(e){return e.categories.includes("user")&&e.categories.includes("anon")}function m(e){return"user"===e}function p(e){return"anon"===e}function g(e){return y.every(function(t){return e.categories.includes(t)})}function h(e){try{JSON.parse(e)}catch(e){return!1}return!0}var y=[e.category],v="",b=[];e.enableOrder=!angular.isDefined(e.enableOrder)||e.enableOrder,e.state=a;var $=t.$watch("user.data",function(){t.Info.files&&o()}),S=t.$watch("Info.files",function(){t.Info.files&&o()});e.$on("$destroy",function(){$(),S()})}e.$inject=["$scope","$rootScope","Auth","$state","$sce"],angular.module("casino.profile").directive("casinoSlider",[function(){return{restrict:"E",replace:!0,scope:{category:"@",enableOrder:"@"},templateUrl:function(e,t){return"/app/Layout/Slider/_"+(t.template||"slider")+".html"},controller:e}}])}(),function(){function e(e,t){function n(){f.forEach(i)}function a(){console.log("BTCRealtime ws closed")}function r(t){var n=JSON.parse(t.data);n.chanId&&n.pair&&(d[n.chanId]=n.pair);var a=_.find(n,function(e){return Array.isArray(e)});if(a&&Array.isArray(a[0])&&(a=a[0]),a&&a.length>3){var r=a[a.length-1];e.$apply(function(){var e=d[n[0]];m[e](e,r)})}}function o(){c.close()}function i(e){c.send(e)}function s(t,n){p.prices[t]=n,e.$broadcast("BTCRateChanged",p.prices)}var c,u=t,l="wss://api.bitfinex.com/ws/2",d={},f=u.map(function(e){return'{"event": "subscribe", "channel": "trades", "symbol": "t'+e+'"}'}),m=u.reduce(function(e,t){return e[t]=_.throttle(s,5e3),e},{}),p={prices:u.reduce(function(e,t){return e[t]=null,e},{})};return function(){c=new WebSocket(l),c.onopen=n,c.onclose=a,c.onmessage=r,c.onerror=o}(),p}e.$inject=["$rootScope","BTC_CONVERTER_PAIRS"],angular.module("casino.services").factory("BTCRealtime",e)}(),function(){function e(e,t){function n(){s.myCurrency=r(s.myBTC),c.BTC=!0,c.currency=!1}function a(){s.myBTC=o(s.myCurrency),c.BTC=!1,c.currency=!0}function r(e){return(e*s.price/1e3).toFixed(2)}function o(e){return(e/s.price*1e3).toFixed(2)}function i(){s.price=t.prices["BTC"+s.currencyCode];var e=c.BTC||c.currency;c.currency||!e?a():n()}var s=this;s.currencyCode=s.currencyCode||"USD",s.price=0,s.myCurrency=1e3,s.myBTC=0;var c={BTC:!1,currency:!1};e.$on("BTCRateChanged",i),s.onMyBTCChange=n,s.onMyCurrencyChange=a}e.$inject=["$scope","BTCRealtime"],angular.module("casino").component("bitcoinConverter",{templateUrl:["$element","$attrs",function(e,t){return"/app/Blocks/BitcoinConverter/_"+(t.template||"main")+".html"}],controller:e,bindings:{currencyCode:"@"}})}(),function(){angular.module("casino.constants").constant("BTC_CONVERTER_PAIRS",["BTCUSD","BTCEUR"])}(),CasinoDirectives.directive("casinoBitcoinConverter",[function(){return{restrict:"E",replace:!0,scope:{},templateUrl:"/app/Blocks/BitcoinConverter/_bitcoinConverter.html",controller:["$scope","BTCRealtime",function(e,t){console.warn("Deprecated from 1.31.4");var n=0,a=1e3;e.price=0,e.btc=function(t){return angular.isUndefined(t)||(n=t,a=(n*e.price/1e3).toFixed(2)),arguments.length?n=t:n},e.currency=function(t){return angular.isUndefined(t)||(a=t,n=(a/e.price*1e3).toFixed(2)),arguments.length?a=t:a},e.$on("BTCRateChanged",function(){e.price=t.prices.BTCUSD,e.currency(a)}),e.refreshRate=function(){}}]}}]),CasinoServices.factory("BitcoinConverter",["$http",function(e){return console.warn("Deprecated from 1.31.4"),{get:function(t){e({method:"GET",url:"https://api.bitfinex.com/v1/pubticker/btcusd",cache:!1,useXDomain:!0,withCredentials:!1,responseType:"json"}).then(function(e){t(e.data.last_price)})}}}]),CasinoDirectives.directive("casinoChristmassCalendar",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"/app/Blocks/ChristmassCalendar/_christmass-calendar.html",scope:{start_day:"=startDay",end_day:"=endDay"},controller:["$rootScope","$scope","Auth","User","localStorageService","CHRISTMASS_CALENDAR","$http",function(e,t,n,a,r,o,i){t.storageType="Local storage",t.currency=e.user.data.currency;var s,c=(e.currentLocale,{});t.days=c,t.days_images=o;var u=[];r.get("days_opened")?u=r.get("days_opened"):r.set("days_opened",u);var l=function(e){s=t.debug?r.get("cday")||e.getUTCDate():e.getUTCDate(),t.curDay=s,t.elementOpened=!1,u.indexOf(s)>-1?t.descriptionOpened=!0:t.descriptionOpened=!1;for(var n=t.start_day;n<=t.end_day;n++){var a={number:n,current:!1,currentOpened:!1,previusClosed:!1,previusOpened:!1};n==s&&!u.indexOf(n)>-1&&(a.current=!0),n<s&&u.indexOf(n)>-1&&(a.previusClosed=!1,a.previusOpened=!0,a.currentOpened=!0),n==s&&u.indexOf(n)>-1?(a.previusOpened=!1,a.currentOpened=!0):n<s&&!u.indexOf(n)>-1&&(a.previusClosed=!0),c[a.number]=a}};t.openDescription=function(e){e==s&&-1==u.indexOf(e)&&(t.descriptionOpened=!0,u.push(s),r.set("days_opened",u),c[s].currentOpened=!0)},i({method:"HEAD",url:"/"}).then(function(e){l(new Date(e.headers().date))},function(){l(new Date)})}]}}]),CasinoConstants.constant("CHRISTMASS_CALENDAR",[{images_close:"/resources/images/calendar/boxes-grey/2.png",images_open:"/resources/images/calendar/boxes-color/2.png"},{images_close:"/resources/images/calendar/boxes-grey/1.png",images_open:"/resources/images/calendar/boxes-color/1.png"},{images_close:"/resources/images/calendar/boxes-grey/4.png",images_open:"/resources/images/calendar/boxes-color/4.png"},{images_close:"/resources/images/calendar/boxes-grey/3.png",images_open:"/resources/images/calendar/boxes-color/3.png"},{images_close:"/resources/images/calendar/boxes-grey/1.png",images_open:"/resources/images/calendar/boxes-color/1.png"},{images_close:"/resources/images/calendar/boxes-grey/4.png",images_open:"/resources/images/calendar/boxes-color/4.png"},{images_close:"/resources/images/calendar/boxes-grey/3.png",images_open:"/resources/images/calendar/boxes-color/3.png"},{images_close:"/resources/images/calendar/boxes-grey/2.png",images_open:"/resources/images/calendar/boxes-color/2.png"},{images_close:"/resources/images/calendar/boxes-grey/4.png",images_open:"/resources/images/calendar/boxes-color/4.png"},{images_close:"/resources/images/calendar/boxes-grey/3.png",images_open:"/resources/images/calendar/boxes-color/3.png"},{images_close:"/resources/images/calendar/boxes-grey/2.png",images_open:"/resources/images/calendar/boxes-color/2.png"},{images_close:"/resources/images/calendar/boxes-grey/1.png",images_open:"/resources/images/calendar/boxes-color/1.png"}]),CasinoControllers.controller("ClockWidget",["$scope","ClockWidget",function(e,t){e.time=t.time,t.config(e.time_zone,e.time_format)}]),CasinoDirectives.directive("casinoClockWidget",[function(){return{replace:!0,restrict:"E",scope:{time_zone:"@timeZone",time_format:"@timeFormat"},templateUrl:"/app/Blocks/ClockWidget/_clockWidget.html",controller:"ClockWidget"}}]),CasinoServices.factory("ClockWidget",["$timeout","$rootScope",function(e){var t={},n=new Date,a={time_format:"HH:mm",offset:-1*n.getTimezoneOffset()};return function r(){n=new Date;var o=n.getTime()+60*n.getTimezoneOffset()*1e3,i=new Date(o+60*a.offset*1e3);t.current=i.toString(a.time_format),e(function(){r()},1e3)}(),{config:function(e,t){a.offset=parseInt(e)==e?60*e:a.offset,a.time_format=t||a.time_format},time:t}}]),CasinoDirectives.directive("casinoCmsContent",["$compile","$parse","Auth",function(e,t,n){return{restrict:"E",replace:!0,transclude:!0,scope:{text:"@text"},template:'<div ng-bind-html="content"></div>',link:function(n,a,r){var o=t(r.ngBindHtml);n.$watch(function(){return(o(n)||"").toString()},function(){e(a,null,-9999)(n)})},controller:["$scope","Snippets","$sce",function(e,t,a){e.accessLevels=n.accessLevels,t.add(function(){e.content=a.trustAsHtml(e.text)})}]}}]),CasinoDirectives.directive("casinoDepositButton",[function(){return{restrict:"E",replace:!0,scope:{anonI18nKey:"@anonI18nKey",userI18nKey:"@userI18nKey"},templateUrl:function(e,t){return"/app/Blocks/DepositButton/_"+(t.type||"deposit")+"_button.html"},controller:["$scope","$rootScope","$state","Auth","Player",function(e,t,n,a,r){e.accessLevels=a.accessLevels,e.anonI18nKey=e.anonI18nKey||"frontend.links.sign_up",e.userI18nKey=e.userI18nKey||"frontend.links.deposit"}]}}]),CasinoFilters.filter("CountryFilter",function(){return function(e,t){if(t){var n={};for(var a in e)e[a].slice(0,t.length).toLocaleLowerCase()===t.toLocaleLowerCase()&&(n[a]=e[a]);return n}return e}}).filter("objLength",function(){return function(e){return Object.keys(e).length}}),CasinoDirectives.directive("countryTooltip",[function(){return{restrict:"A",link:function(e){function t(){if(e.search){for(var t in e.data.inclusion.in)if(e.data.inclusion.in[t].toLowerCase()===e.search.toLowerCase())return e.value=t,void(e.tooltip=!1);e.search=""}e.tooltip=!1,e.value=""}function n(t){13===t.which&&e.closeTooltip()}e.closeTooltip=t,e.clickEnter=n}}}]),CasinoDirectives.directive("dropdownTooltip",[function(){return{restrict:"A",scope:{dropdownTooltipValue:"=",dropdownTooltipKey:"="},link:function(e){function t(){if(e.$parent.search)if(e.$parent.data.inclusion.in[e.dropdownTooltipKey]===e.$parent.search)r(e.dropdownTooltipKey);else{var t=!1;for(var n in e.$parent.data.inclusion.in)e.$parent.data.inclusion.in[n].toLowerCase()===e.$parent.search.toLowerCase()&&(r(n),t=!0);t||a()}else a()}function n(e){13===e.which&&t()}function a(){e.$parent.search="",e.$parent.tooltip=!1,e.dropdownTooltipValue="",e.dropdownTooltipKey=""}function r(t){e.dropdownTooltipValue=e.$parent.data.inclusion.in[t],e.dropdownTooltipKey=t,e.$parent.search=e.$parent.data.inclusion.in[t],e.$parent.tooltip=!1}e.$parent.closeTooltip=t,e.$parent.clickEnter=n,e.$parent.onItemSelect=r}}}]),CasinoDirectives.directive("casinoFormElement",["$rootScope","$http","$timeout","$templateCache","SYSTEM","Pages","$compile","$translate","PagesService","$sce","Notification",function(e,t,n,a,r,o,i,s,c,u,l){return{restrict:"E",replace:!0,transclude:!0,scope:{data:"=data",value:"=ngModel",customFields:"=customFields",errors:"=errors",ngDisabled:"<ngDisabled",isProfileForm:"<isProfileForm",isEditMode:"<isEditMode",ngChange:"&ngChange",elementTemplate:"@elementTemplate"},link:function(n,l){function d(e,t){e===t||n.isProfileForm||n.data.onChangeCallback&&n.data.onChangeCallback()}r.PASSWORD_STRENGTH=r.PASSWORD_STRENGTH||{};var f,m="",p=n.data.scope;n.isDisabled=n.data.readonly||n.ngDisabled,n.name=(n.data.scope||"")+"_"+n.data.field,n.elementTemplate=n.elementTemplate||"_element.html","profile"===p&&(p="profile/user"),p||(p="profile/user"),f=n.label=n.data.label?n.data.label:"activerecord.attributes."+p+"."+n.data.field,n.placeholder=n.data.placeholder?n.data.placeholder:"activerecord.attributes."+p+"."+n.data.field,void 0!==n.data.localData.value&&(n.value=n.data.localData.value),n.$watch("value",d,!0);var g=n.isProfileForm?"profile/":"";switch(m="/app/Blocks/FormElements/"+g+"_input.html",n.data.localData.type){case"currency":case"country":case"nationality":case"language":case"time_zone":case"select":m="/app/Blocks/FormElements/"+g+"_select.html";break;case"cascade_select":m="/app/Blocks/FormElements/"+g+"_cascade_select.html";break;case"date":m="/app/Blocks/FormElements/"+g+"_date.html";break;case"date_simple":m="/app/Blocks/FormElements/"+g+"_date_simple.html";break;case"country_smart":m="/app/Blocks/FormElements/"+g+"_country_smart.html";break;case"radio":m="/app/Blocks/FormElements/"+g+"_radio.html";break;case"checkbox":m="/app/Blocks/FormElements/"+g+"_checkbox.html";break;case"double_email":m="/app/Blocks/FormElements/"+g+"_double_email.html";break;case"email":"user"===n.data.scope||"profile/user"===n.data.scope?!0===r.PASSWORD_SAVE_FORBIDDEN&&"email"===n.data.field&&(m="/app/Blocks/FormElements/"+g+"_email_with_fake_password.html"):m="/app/Blocks/FormElements/"+g+"_input.html";break;case"password":r.PASSWORD_STRENGTH.AVAILABLE&&"password"===n.data.field&&(m="/app/Blocks/FormElements/"+g+"_password.html");break;case"password_with_toggle":m="/app/Blocks/FormElements/"+g+"_password_with_toggle.html";break;case"captcha":
m="/app/Blocks/FormElements/"+g+"_captcha.html";break;case"card_expiry_date":m="/app/Blocks/FormElements/"+g+"_card_expiry_date.html";break;case"crypto_address":n.data.app_path?(n.data.qrCodeURL="https://chart.googleapis.com/chart?cht=qr&chl="+n.data.app_path+"&chs=160x160&chld=L|0",m="/app/Blocks/FormElements/"+g+"_crypto_address.html"):m="/app/Blocks/FormElements/"+g+"_input.html";break;case"amount":m="/app/Blocks/FormElements/"+g+"_amount.html";break;case"cvv":m="/app/Blocks/FormElements/"+g+"_cvv.html";break;case"textarea":m="/app/Blocks/FormElements/"+g+"_textarea.html";break;case"tel":m="/app/Blocks/FormElements/"+g+"_tel.html";break;case"tel_smart":m="/app/Blocks/FormElements/"+g+"_tel_smart.html";break;case"banner":n.data.content=u.trustAsHtml(n.data.html_content),n.elementTemplate="_element_no_label.html",m="/app/Blocks/FormElements/"+g+"_banner.html";break;default:m="/app/Blocks/FormElements/"+g+"_input.html"}if("terms_acceptance"==n.data.name||"age_terms_acceptance"==n.data.name){m="/app/Blocks/FormElements/"+g+"_terms_acceptance.html";var h=function(){o.list({l:e.currentLocale}).$promise.then(function(t){var a,o;a=t.find(function(e){return c.getLinkMenuItem(e,"TERMS_AND_CONDITIONS")}),o=t.find(function(e){return c.getLinkMenuItem(e,"PRIVACY_POLICY")});var i="";a&&!n.data.hasCombinedLabel&&(i+='<a href="'+(e.currentLocale?"/"+e.currentLocale+"/":"")+a.path+'" target="_blank">'),a&&n.data.hasCombinedLabel&&(r.ENABLE_TERMS_TEXT_POPUP?i+='<a href="#" onclick="window.termsModal.open({pageName: \'terms-and-conditions\'});">':i+='<a href="#terms-and-conditions">'),i+=s.instant("frontend.links.terms_and_conditions"),(a||n.data.hasCombinedLabel)&&(i+="</a>");var l="";o&&!n.data.hasCombinedLabel&&(l+='<a href="'+(e.currentLocale?"/"+e.currentLocale+"/":"")+o.path+'" target="_blank">'),o&&n.data.hasCombinedLabel&&(r.ENABLE_TERMS_TEXT_POPUP?l+='<a href="#" onclick="window.termsModal.open({pageName: \'privacy-policy\'});" >':l+='<a href="#privacy-policy">'),l+=s.instant("frontend.links.privacy_policy"),(o||n.data.hasCombinedLabel)&&(l+="</a>");var d=s.instant("frontend.and"),m=i+" "+d+" "+l;n.label=s.instant(f,_.extend(n.data.localData.translate_value||{},{text:m})),n.label=u.trustAsHtml(n.label.replace(/&lt;/g,"<").replace(/&gt;/g,">"))})};h(),e.$on("$translateChangeSuccess",function(){h()})}n.data.localData.template&&(m="/app/Blocks/FormElements/"+g+"_"+n.data.localData.template+".html"),t.get("/app/Blocks/FormElements/"+g+n.elementTemplate,{cache:a}).success(function(e){t.get(m,{cache:a}).success(function(t){var a=i(e.replace("\x3c!--element--\x3e",t))(n);if(n.data.onBlurCallback){var r=function(e){var t=e[0].querySelectorAll("input");if(t.length){var n=t[t.length-1];return angular.element(n)}}(a);r&&r.on("blur",n.data.onBlurCallback)}l.replaceWith(a)})})},controller:["$scope",function(e){if("amount"===e.data.localData.type&&(e.value=e.data.localData.defaultvalue),"date"==e.data.localData.type&&(e.open=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!0},e.datepickerOptions={"show-button-bar":!1,showWeeks:!1}),"date_simple"===e.data.localData.type){var t=function(t){if(t=t||{},"dd"===t.type&&e.date.dd&&(e.date.dd>31&&(e.date.dd=31),2===e.date.dd.toString().length||1===e.date.dd.toString().length&&"0"===t.previousValue)){var n=document.querySelectorAll('[birthday-group] [ng-model="date.mm"]');n.length&&n[n.length-1].focus()}if("mm"===t.type&&e.date.mm&&(e.date.mm>12&&(e.date.mm=12),2===e.date.mm.toString().length||1===e.date.mm.toString().length&&"0"===t.previousValue)){var a=document.querySelectorAll('[birthday-group] [ng-model="date.yyyy"]');a.length&&a[a.length-1].focus()}if("yyyy"===t.type&&e.date.yyyy&&(e.date.yyyy>(new Date).getFullYear()&&(e.date.yyyy=parseInt(t.previousValue)),4===e.date.yyyy.toString().length&&e.date.yyyy<1900&&(e.date.yyyy="")),e.date.dd&&e.date.mm&&e.date.yyyy)if(r(e.date.dd,e.date.mm,e.date.yyyy)){var o=e.date.dd.toString().length<2?"0"+e.date.dd:e.date.dd,i=e.date.mm.toString().length<2?"0"+e.date.mm:e.date.mm,s=e.date.yyyy+"-"+i+"-"+o;e.date.yyyy>1900&&(e.value=new Date(s.replace(/-/g,"/")))}else e.value="invalid_date";else e.value=null},a=function(n){"yyyy"===n.type&&e.date.yyyy<1900&&(e.date.yyyy="",t())},r=function(e,t,n){return(t=parseInt(t,10)-1)>=0&&t<12&&e>0&&e<=o(t,n)},o=function(e,t){switch(e){case 1:return t%4==0&&t%100||t%400==0?29:28;case 8:case 3:case 5:case 10:return 30;default:return 31}};if(e.value){var i=function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}(e.value);e.date={dd:parseInt(i.split("-")[2]),mm:parseInt(i.split("-")[1]),yyyy:parseInt(i.split("-")[0])}}else e.date={dd:null,mm:null,yyyy:null};e.onDateChange=t,e.onBlur=a}if("password_with_toggle"===e.data.localData.type){var s=null;e.isPasswordShown=!1,e.toggleInputType=function(t){s=s||$(t.currentTarget).closest(".password_with_toggle").find(".password_with_toggle__input"),"text"===s.attr("type")?s.attr("type","password"):s.attr("type","text"),e.isPasswordShown=!e.isPasswordShown}}if("cascade_select"===e.data.localData.type&&(e.value={},e.secondaryInclusion={},e.selectValue=function(t,n){e.value[e.data[t]]=n,"primary"===t&&(e.secondaryInclusion=_.findWhere(e.data.values,{value:n}).inclusion,e.value[e.data.secondary]=Object.keys(e.secondaryInclusion.in)[0])}),"crypto_address"===e.data.localData.type){var c=function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select();var n=t.contentEditable,a=t.readOnly,r=document.createRange();r.selectNodeContents(t);var o=window.getSelection();o.removeAllRanges(),o.addRange(r),t.setSelectionRange(0,999999),t.contentEditable=n,t.readOnly=a;try{document.execCommand("copy")&&l.show("frontend.crypto_address.copied",{classes:"alert-success"})}catch(e){}document.body.removeChild(t)},u=function(e,t){if(!navigator.clipboard)return void c(e);navigator.clipboard.writeText(e).then(function(){l.show("frontend.crypto_address."+t+".copied",{classes:"alert-success"}),console.log("Async: Copying to clipboard was successful!")},function(e){console.error("Async: Could not copy text: ",e)})};e.copyTextToClipboard=u}if("tel"===e.data.localData.type){var d=function(){e.value=e.value||e.data.localData.default};e.data.onDefaulValueChange=n(d,1)}if("tel_smart"===e.data.localData.type){var f=function(){e.search&&e.data.inclusion.in[e.country_code]!==e.search&&(e.country_code=_.invert(e.data.inclusion.in)[e.search]),e.phoneNumber.dial_code=e.data.inclusion.in[e.country_code]||"",e.value=e.phoneNumber.dial_code+e.phoneNumber.number},m=function(){e.search=e.data.localData.default,n(f,1)};e.onPhoneChange=f,e.data.onDefaulValueChange=m,e.country_code="",e.phoneNumber={dial_code:"",number:""},m()}if("country"===e.data.localData.type||"nationality"===e.data.localData.type){var p=function(){e.value=e.data.localData.default};e.data.onDefaulValueChange=n(p,1)}if("country_smart"===e.data.localData.type){var g=function(){e.search=e.data.inclusion.in[e.data.localData.default]};e.data.onDefaulValueChange=g,g()}}]}}]),CasinoFilters.filter("SearchByObjFilter",function(){return function(e,t){if(t){var n={};for(var a in e)e[a].slice(0,t.length).toLocaleLowerCase()===t.toLocaleLowerCase()&&(n[a]=e[a]);return n}return e}}).filter("objLength",function(){return function(e){return Object.keys(e).length}}),CasinoDirectives.directive("casinoInsertCmsImages",[function(){return{restrict:"E",replace:!0,scope:{category:"@category",default:"@"},templateUrl:"/app/Blocks/InsertCmsImages/_images.html",controller:["$scope","$rootScope","$state",function(e,t,n){function a(){r=[],o=[];for(var n=0;n<t.Info.files.length;n++)t.Info.files[n].categories.indexOf(e.category)>=0&&r.push({image:t.Info.files[n].url}),t.Info.files[n].categories.indexOf(e.default)>=0&&o.push({image:t.Info.files[n].url});r.length||(r=o),e.images=r}var r=[],o=[];e.state=n,t.$watch("Info.files",function(){t.Info.files&&a()}),e.$watch("category",function(e,n){t.Info.files&&n!=e&&t.Info.files.$promise.then(function(){a()})}),t.$on("$stateChangeSuccess",function(){t.Info.files&&t.Info.files.$promise.then(function(){a()})}),t.Info.files&&a()}]}}]),CasinoDirectives.directive("casinoPushNotificationButton",["$rootScope","PushNotifications","$window",function(e,t,n){return{restrict:"E",template:function(){return n.Notification?"<div ng-include=\"'/app/Blocks/PushNotificationButton/_push_notification_button.html'\"></div>":"<div></div>"},link:function(e,a,r){var o=n.OneSignal||[];o.push(function(){o.isPushNotificationsEnabled(function(t){t&&(e.subscribed=!0)})}),e.subscribe=function(){o.push(function(){o.registerForPushNotifications()}),o.push(["setSubscription",!0]),t.sendTags(),e.subscribed=!0},e.unsubscribe=function(){o.push(["setSubscription",!1]),e.subscribed=!1}}}}]),function(){function e(e,t){function n(e){o.value=e}function a(e){o.widgetId=e}function r(){t.reload(o.widgetId),o.value=null}var o=this;o.value=null,o.widgetId=null,o.setResponse=n,o.setWidgetId=a,e.$on("authRegistrationError",r),e.$on("authLoginFormError",r),e.$on("forgotPasswordFormError",r),e.$on("unlockFormError",r),e.$on("confirmationFormError",r)}e.$inject=["$rootScope","vcRecaptchaService"],angular.module("casino").component("casinoRecaptchaModel",{templateUrl:"/app/Blocks/Recaptcha/_recaptcha-model.html",bindings:{key:"=",value:"=",type:"=",theme:"="},controller:e})}(),function(){function e(e,t){var n=this;n.enabled=!1,n.key=null,this.$onInit=function(){e.settings(function(e){n.key=e.recaptcha,3===e.recaptcha_version&&(t.key=n.key,t.action=n.action),2===e.recaptcha_version&&(n.enabled=!0)})}}e.$inject=["Player","RecaptchaService"],angular.module("casino").component("casinoRecaptcha",{templateUrl:"/app/Blocks/Recaptcha/_recaptcha.html",bindings:{value:"=",type:"=",theme:"@",action:"@"},controller:e})}(),function(){function e(e){this.captchaV3=function(t){var n=this;window.grecaptcha?window.grecaptcha.execute(n.key,{action:n.action}).then(function(e){t(e)}):e.load(["https://www.recaptcha.net/recaptcha/api.js?render="+n.key]).then(function(){window.grecaptcha.ready(function(){window.grecaptcha.execute(n.key,{action:n.action}).then(function(e){t(e)})})})}}e.$inject=["$ocLazyLoad"],CasinoServices.service("RecaptchaService",e)}(),CasinoDirectives.directive("casinoSoftswissFooterLink",[function(){return{restrict:"E",replace:!0,scope:{},templateUrl:"/app/Blocks/SoftswissFooterLink/_link.html"}}]),CasinoDirectives.directive("casinoTimeWidget",[function(){return{replace:!0,restrict:"E",scope:{},templateUrl:"/app/Blocks/TimeWidget/_timeWidget.html",controller:["$scope","$rootScope","localStorageService",function(e,t,n){e.time=!1;var a=function(e){var t=(new Date).getTime();return n.set(window.btoa("user_time_"+e),t),t},r=function(e){var t=n.get(window.btoa("user_time_"+e))||!1;return t||(t=a(e)),t};e.$on("authLoginFormSuccess",function(){e.time=a(t.data.user.id)}),e.$on("authLoginSuccess",function(t,n){e.time=r(n.id)}),t.data.user.email&&(e.time=r(t.data.user.id))}]}}]),function(){function e(){}angular.module("casino").component("casinoTimer",{templateUrl:["$element","$attrs",function(e,t){return"/app/Blocks/Timer/_"+(t.template||"main")+".html"}],controller:e,bindings:{countdown:"<",finishCallback:"&"}})}(),CasinoDirectives.directive("casinoContent",["$compile","$stateParams","Pages","$rootScope","$state","Info","PagesService",function(e,t,n,a,r,o,i){return{restrict:"E",replace:!0,scope:{content:"=content",pageId:"@"},link:function(o,s,c){var u=function(){function c(t){n.byId({id:t,l:a.currentLocale},function(t){for(var n=0;n<s.length;n++)s[n].innerHTML="";t.content.trim().length&&s.append(e(t.content)(o))},function(){o.pageId?console.warn(o.pageId+" page doesn't exist."):r.go("404")})}"404"==t.path&&r.go("404");var u=o.pageId&&o.pageId.toUpperCase().split("-").join("_");if("TERMS_AND_CONDITIONS"===u||"PRIVACY_POLICY"===u)n.list({l:a.currentLocale}).$promise.then(function(e){var t=e.find(function(e){return i.getLinkMenuItem(e,u)});t?c(t.id):console.warn(o.pageId+" page doesn't exist.")});else{c(o.pageId||t.path)}};o.$on("localeChanged",function(e,t){u()}),a.currentLocale&&u()}}}]),CasinoControllers.controller("Landing",["$scope","$state","$rootScope",function(e,t,n){t.go("home",{lang:n.currentLocale})}]),CasinoControllers.controller("OpenPageModal",["$scope","$rootScope","$compile","Pages","$modal",function(e,t,n,a,r){e.openPage=function(e,n){a.byId({id:e,l:t.currentLocale},function(e){t.mainModal.close(),t.mainModal.modal=r.open({templateUrl:n||"/app/Pages/OpenPageModal/_main.html",windowClass:"modal-page",controller:["$scope","$rootScope",function(t,n){t.close=function(){n.mainModal.close()},t.content=e.content}]})})}}]).directive("bindHtmlCompile",["$compile",function(e){return{restrict:"A",link:function(t,n,a){t.$watch(function(){return t.$eval(a.bindHtmlCompile)},function(a){n.html(a),e(n.contents())(t)})}}}]),CasinoDirectives.directive("casinoSnippet",["$compile","$parse","Auth",function(e,t,n){return{restrict:"E",replace:!0,scope:{type:"@type"},template:'<div ng-bind-html="content"></div>',link:function(n,a,r){var o=t(r.ngBindHtml);n.$watch(function(){return(o(n)||"").toString()},function(){e(a,null,-9999)(n)})},controller:["$scope","Snippets","$sce",function(e,t,a){e.accessLevels=n.accessLevels,t.add(function(){var n=t.getByName(e.type);e.content=a.trustAsHtml(n.content)})}]}}]),CasinoServices.factory("Snippets",["Pages","$rootScope",function(e,t){var n=[],a=[],r=!1,o=function(t){e.snippets({l:t},function(e){n=e;for(var t in a)a[t]();r=!0})};return t.$on("authLoginSuccess",function(e,n){n.language!==t.currentLocale&&(r=!1)}),t.$on("localeChanged",function(e,t){r=!1,o(t)}),{add:function(e){r?e():a.push(e)},getByName:function(e){var t={};for(var a in n)if(n[a].id==e){t=n[a];break}return t}}}]),CasinoServices.factory("Contact",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/send_contact_message",{},{post:{method:"post",params:{}}})}]),CasinoControllers.controller("Support",["$scope","$rootScope","Auth","$state","Contact","Notification",function(e,t,n,a,r,o){var i={data:{contact:{email:"",content:""}}};e.user=n.user,e.$watchCollection("user",function(){e.user.data&&e.user.data.email&&(i.data.contact.email=e.user.data.email)}),e.support=i,i.submit=function(){r.post(i.data,function(){a.go("home",{lang:t.currentLocale}),o.show("notification.contact_form.sender_notice",{classes:"alert-success"}),i.data.contact.content=""},function(t){e.support.errors=t.data.errors})}}]),function(){function e(e,t,n,a,r){function o(){n.data.allUserBalances?(l.allUserCurrencies=n.data.allUserBalances.filter(function(e){var t=n.data.balances.map(function(e){return e.currency}).includes(e.currency);return e.deposit_available||t}),l.currentUserCurrency=e.data.user.currency):(l.allUserCurrencies=[],l.currentUserCurrency=null)}function i(e){n.changeCurrency(e).then(function(){}).catch(function(){})}function s(e){n.onHideAccount(e).then(function(){}).catch(function(){})}function c(e){r.showPaymentsModal({selectedCurrency:e,selectedTab:"deposit"})}function u(e){r.showPaymentsModal({selectedCurrency:e,selectedTab:"cashout"})}var l=this;l.currentUserCurrency=null,l.$onInit=o,l.onSelectAccount=i,l.onHideAccount=s,l.onMakeDeposit=c,l.onMakeCashout=u,l.showWalletSettingsModal=n.showWalletSettingsModal,e.$on("balanceRefreshSuccess",o)}e.$inject=["$rootScope","$window","Balance","ProfileRoute","Payments"],angular.module("casino").component("casinoBalance",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Balance/_"+(t.template||"main")+".html"}],controller:e,bindings:{close:"&",dismiss:"&"}}),angular.module("casino").controller("BalanceCtrl",e)}(),function(){function e(e,t,n,a,r){function o(t){return t=t||{},p&&!t.forcibly||!e.data.user.email?t.promised?Promise.reject():void 0:(e.$broadcast("balanceRefreshStart"),p=!0,r.all({allUserBalances:n.balance({compatibility:!1}).$promise,balances:n.balance().$promise}).then(function(t){function n(){for(a=a||function(){},a();f.length;)f.pop();for(;m.length;)m.pop();return t.allUserBalances=t.allUserBalances.filter(function(t){return _.findWhere(e.Info.currencies,{code:t.currency})}),t.allUserBalances.forEach(function(n){var a=_.extend(n,e.Info.currencies.find(function(e){return e.code===n.currency}));a.isUserActiveCurrency=!!t.balances.find(function(e){return e.currency===a.currency}),a.isSelected=e.data.user.currency===a.code,a.isSelected&&(a.isDisabled=t.balances.length<=1),a.isHidden=!!a.hidden_at,a.isUserCurrency=a.isUserActiveCurrency||a.isHidden,"BTC"===a.code&&a.amount_cents<a.subunits_to_unit&&0!=a.amount_cents&&(a.subunits_to_unit=1e5,a.symbol="mBTC",a.currency="mBTC"),m.push(a),a.isUserActiveCurrency&&f.push(a)}),e.$broadcast("balanceRefreshSuccess",f),Promise.resolve()}if(p=!1,e.Info.currencies)return n();var a=e.$on("currenciesUpdated",function(){return n()})}))}function i(t,a){return a=a||{},a.reload=!a.hasOwnProperty("reload")||a.reload,n.select_account({currency:t}).$promise.then(function(t){return e.data.user.currency=t.currency,e.data.currency=t.currency,a.reload?o({promised:!0,forcibly:!0}).then(function(){return e.$broadcast("userCurrencyChangedSuccessfully",t.currency),Promise.resolve()}):Promise.resolve()}).then(function(){return Promise.resolve()}).catch(function(e){return Promise.reject(e)})}function s(t){if(t===e.data.user.currency){if(f.length>1){var n=c(t);return i(n,{reload:!1}).then(function(){return u(t,{reload:!1}).then(function(){return o({promised:!0,forcibly:!0}).then(function(){return e.$broadcast("userCurrencyChangedSuccessfully",n),Promise.resolve()})})}).catch(function(){return Promise.reject()})}return console.error("Only 1 currency available, so can't hide"),Promise.reject()}return u(t)}function c(e){return f[0].currency!==e?f[0].currency:f[1].currency}function u(e,t){return t=t||{},t.reload=!t.hasOwnProperty("reload")||t.reload,n.remove({currency:e}).$promise.then(function(){return t.reload?o({promised:!0}):Promise.resolve()}).catch(function(){return Promise.reject()})}function l(){f=[],m=[],g.balances=f,g.data={balances:f,allUserBalances:m},e.$broadcast("balanceRefreshSuccess",g.data.balances)}function d(n){n=n||{},n.template=n.template||"profile-wallet-settings",e.mainModal.modal=t.open({template:'<casino-balance template="'+n.template+'"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></casino-balance>',controller:function(){},windowClass:"profile-modal-currency-settings",controllerAs:"$ctrl"})}var f=[],m=[],p=!1;e.$on("authLoginSuccess",o),e.$on("balanceRefresh",o),e.$on("gameCloseSuccess",o),e.$on("exchangedCompointsForMoneySuccess",o),e.$on("playerPaymentsRefreshSuccess",o),e.$on("authLogoutSuccess",l);var g={refreshBalance:o,balances:f,data:{balances:f,allUserBalances:m},changeCurrency:i,onHideAccount:_.throttle(s,500),showWalletSettingsModal:d};return g}e.$inject=["$rootScope","$modal","PlayerAccountsResource","PlayerPaymentsService","$q"],angular.module("casino.services").factory("Balance",e)}(),function(){function e(e,t){return e(t.URL_API+"/player/accounts/:currency/:action",{},{balance:{method:"get",params:{currency:null},isArray:!0},select_account:{method:"post",params:{currency:null}},remove:{method:"delete",params:{currency:"@currency"}},select_lottery:{method:"post",params:{currency:"@currency",action:"select_lottery"}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("PlayerAccountsResource",e)}(),function(){function e(e,t){function n(){o.bonuses=t.data.bonuses}function a(n){t.activateById(n).then(function(){e.$broadcast("balanceRefresh")})}function r(n){t.deactivateById(n).then(function(){e.$broadcast("balanceRefresh")})}var o=this;o.deactivateById=r,o.activateById=a,e.$on("bonusesRefreshSuccess",n),n(),function(){t.refresh()}()}e.$inject=["$rootScope","BonusesService"],angular.module("casino").component("casinoBonuses",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Bonuses/_"+(t.template||"main")+".html"}],controller:e}),angular.module("casino").controller("BonusesCtrl",e)}(),function(){function e(e,t){return e(t.URL_API+"/bonuses/:action",{},{applyBonusCode:{method:"POST",params:{action:"coupon"}},registrationPreview:{method:"GET",params:{action:"registration"},paramSerializer:"$httpParamSerializerJQLike",isArray:!0},depositPreview:{method:"GET",params:{action:"deposit"},paramSerializer:"$httpParamSerializerJQLike",isArray:!0}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("BonusesResource",e)}(),function(){function e(e,t,n,a,r){function o(){e.data.user&&e.data.user.email&&(s(),L||(n.subscribe("bonuses_changes#",function(e){g(e.data)}),L=!0))}function i(e){return _.findWhere(T.bonuses,{id:e})}function s(){return r.get().$promise.then(c)}function c(t){if(T.bonuses=t.map(y).map(v).map(h),e.Info.currencies)l();else var n=e.$on("currenciesUpdated",function(){l(),n()});if(a.inited)u();else var r=e.$on("gamesInitialized",function(){u(),r()});return Promise.resolve()}function u(){T.bonuses=T.bonuses.map($),d("games"),k.every(f)&&e.$broadcast("bonusesRefreshSuccess",T.bonuses)}function l(){T.bonuses=T.bonuses.filter(A),d("currencies"),k.every(f)&&e.$broadcast("bonusesRefreshSuccess",T.bonuses)}function d(e){k.find(function(t){return t.name===e}).isInited=!0}function f(e){return e.isInited}function m(e){return r.activateById({id:e}).$promise.then(function(){return g(i(e)),Promise.resolve()})}function p(e){return r.deactivateById({id:e}).$promise}function g(t){var n=i(t.id);n?(_.assign(n,t),n=_.chain(n).tap(h).tap(y).tap(v).tap($).value(),e.$broadcast("bonusUpdated",n)):(t=_.chain(t).tap(h).tap(y).tap(v).tap($).value(),T.bonuses.push(t),e.$broadcast("newBonusAdded",t)),e.$broadcast("bonusesRefreshSuccess",T.bonuses)}function h(e){return e.diff=(new Date).getTime()-new Date(e.created_at).getTime(),e}function y(e){return e.activatable?e.timer=new Date(e.activatable_until).getTime()-(new Date).getTime():e.timer=new Date(e.valid_until).getTime()-(new Date).getTime(),e.timer<=0&&(e.timer=0),e}function v(e){return e.wageredPercent=Math.round(e.amount_wager_cents/(e.amount_wager_requirement_cents||1)*100),e}function b(e){return P.indexOf(e.stage)>-1}function $(e){return e.games&&"string"==typeof e.games[0]&&(e.games=e.games.map(S),e.games=e.games.filter(w)),e}function S(e){return a.getByIdentifier(e.replace(":","/"))}function w(e){return e}function C(e){return e.activatable&&"issued"===e.stage}function A(t){return!!e.Info.currencies.find(function(e){return e.code===t.currency})}function E(){T.bonuses=[],L=!1,e.$broadcast("bonusesRefreshSuccess",T.bonuses)}function I(n){n=n||{},n.template=n.template||"bonus-item-modal",e.mainModal.modal=t.open({template:'<casino-bonus-item template="'+n.template+'"bonus="$ctrl.bonus"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></casino-bonus-item>',controller:function(){this.bonus=n.bonus},windowClass:"modal-bonus",controllerAs:"$ctrl"})}var T={bonuses:[]},L=!1,P=["handle_bets","issued","wait"],k=[{name:"currencies",isInited:!1},{name:"games",isInited:!1}];return e.$on("authLoginSuccess",o),e.$on("bonusesRefresh",s),e.$on("authLogoutSuccess",E),o(),{data:T,refresh:o,activateById:m,deactivateById:p,getAll:s,getById:i,showBonusModal:I,isBonusActive:b,isBonusActivatable:C,addTimerField:y}}e.$inject=["$rootScope","$modal","RealTime","GamesData","PlayerBonusesResource"],angular.module("casino.services").factory("BonusesService",e)}(),function(){function e(e,t){return e(t.URL_API+"/player/bonuses/:id/:action",{},{get:{method:"GET",isArray:!0},activateById:{method:"POST",params:{id:"@id",action:"activation"}},deactivateById:{method:"DELETE",params:{id:"@id"}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("PlayerBonusesResource",e)}(),function(){function e(e,t,n){function a(){r()}function r(){t.games().$promise.then(function(t){if(l.bets=t,n.inited)o();else var a=e.$on("gamesInitialized",function(){o(),a()})})}function o(){l.bets=l.bets.map(i),s("games"),d.every(c)&&e.$broadcast("betsRefreshSuccess",l.freespins)}function i(e){return e.game_title=n.getByIdentifier(e.game).title,e}function s(e){d.find(function(t){return t.name===e}).isInited=!0}function c(e){return e.isInited}function u(){l.bets=[],e.$broadcast("betsRefreshSuccess")}var l={bets:[]},d=[{name:"games",isInited:!1}];return e.$on("authLogoutSuccess",u),{data:l,init:a}}e.$inject=["$rootScope","Player","GamesData"],angular.module("casino.services").factory("BetsService",e)}(),function(){function e(e,t){function n(){r.editableFields=angular.copy(t.data.fields),r.errors=t.data.errors}function a(){var e={};e=r.editableFields.reduce(function(e,t){return null!==t.model&&void 0!==t.model&&(e[t.field]=t.model),e},e),t.changePassword(e).then(function(e){r.close()}).catch(function(e){})}var r=this;r.submit=a,r.showChangePasswordModal=t.showChangePasswordModal,r.editableFields=[],r.errors={},e.$on("changePasswordRefreshSuccess",n),n()}e.$inject=["$rootScope","ChangePasswordService"],angular.module("casino").component("casinoChangePassword",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Change-password/_"+(t.template||"main")+".html"}],bindings:{close:"&",dismiss:"&"},controller:e}),angular.module("casino").controller("ChangePasswordCtrl",e)}(),function(){function e(e,t,n,a,r){function o(t){return t.email=e.data.user.email,s.errors={},r.change_password({user:t}).$promise.then(function(){return e.$broadcast("passwordUpdated"),n.show("devise.registrations.updated",{classes:"alert-success"}),Promise.resolve()}).catch(function(e){return s.errors=e.data.errors,Promise.reject(s.errors)}).finally(function(){e.$broadcast("changePasswordRefreshSuccess")})}function i(n){n=n||{},n.template=n.template||"change-password-modal",e.mainModal.modal=t.open({template:'<casino-change-password template="'+n.template+'"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></casino-change-password>',controller:function(){},windowClass:"modal-change-password",controllerAs:"$ctrl"})}var s={fields:[],errors:{}},c=["password","password_confirmation"],u={data:s,changePassword:o,showChangePasswordModal:i};return function(){a.player_fields().$promise.then(function(t){s.fields=t.fields.filter(function(e){return c.indexOf(e.field)>-1});var n=s.fields.find(function(e){return"password"===e.field}),a=angular.copy(n);a.field="current_password",s.fields.unshift(a),s.fields=s.fields.map(function(e){return e.localData={type:"password"},e.scope="user",e}),e.$broadcast("changePasswordRefreshSuccess")})}(),u}e.$inject=["$rootScope","$modal","Notification","Info","User"],angular.module("casino.services").factory("ChangePasswordService",e)}(),function(){function e(e,t,n){var a=this;a.compoints=e,a.isExchangeAvailable=t.available,a.isStatusesAvailable=n.available}e.$inject=["Compoints","CompointsExchangeService","StatusesService"],angular.module("casino").component("casinoCompoints",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Compoints/_"+(t.template||"main")+".html"}],controller:e}),angular.module("casino.controllers").controller("CompointsCtrl",e)}(),function(){angular.module("casino.services").factory("CompointsResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/comp_points/:action/:type",{},{getMoneyRates:{method:"get",params:{action:"rates",type:"money"},isArray:!0},getFreespinsRates:{method:"get",params:{action:"rates",type:"freespins"},isArray:!0},getLotteriesRates:{method:"get",params:{action:"rates",type:"lotteries"},isArray:!0},exchange:{method:"post",params:{action:"exchange",type:"@type"}}})}])}(),function(){function e(e,t,n,a,r){function o(){i(),a.subscribe("comps_award#",function(t){c.data=t.data,c.data.chargeable=c.data.chargeable||{points:0},c.data.persistent=c.data.persistent||{points:0},e.$broadcast("compointsUpdated",c.data)}),e.$on("testUpdateCompoints",function(t,n){var a={persistent:{points:n},chargeable:{points:0}};c.data=a,c.data.chargeable=c.data.chargeable||{points:0},c.data.persistent=c.data.persistent||{points:0},e.$broadcast("compointsUpdated",c.data)})}function i(){c.available&&n.comp_points().$promise.then(function(t){c.data=t.toJSON(),c.available=!!Object.keys(c.data).length,c.data.chargeable=c.data.chargeable||{points:0},c.data.persistent=c.data.persistent||{points:0},c.available&&e.$broadcast("compointsUpdated",c.data)})}function s(n){n.template=n.template||"profile-compoints-exchange",e.mainModal.modal=t.open({template:'<compoints-exchange template="'+n.template+'"opened-tab="$ctrl.openedTab"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></compoints-exchange>',controller:function(){this.openedTab=n.openedTab},windowClass:"modal-compoints-exchange",controllerAs:"$ctrl"})}var c={data:{},available:!0,exchange:r,showExchangeModal:s};return e.$on("refreshCompoints",i),e.$on("authLoginSuccess",o),e.$on("authLogoutSuccess",function(){c.data={},e.$broadcast("compointsUpdated",c.data)}),c}e.$inject=["$rootScope","$modal","Player","RealTime","CompointsExchangeService"],angular.module("casino.services").factory("Compoints",e)}(),function(){function e(e){this.CompointsBoostersService=e}e.$inject=["CompointsBoostersService"],angular.module("casino").component("casinoCompointsBoosters",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Compoints-boosters/_"+(t.template||"main")+".html"}],controller:e})}(),function(){angular.module("casino.services").factory("CompointsBoostersResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/comp_points_boosters/:id/:type",{},{getAll:{method:"get",isArray:!0},getById:{method:"get",params:{id:"@id"},isArray:!1},getStatuses:{method:"get",params:{type:"statuses"},isArray:!0},getStatusById:{method:"get",params:{id:"@id",type:"status"},isArray:!1}})}])}(),function(){function e(e,t){function n(){t.getAll().$promise.then(function(t){u=t,e.data.user&&e.data.user.email?a():e.$on("authLoginSuccess",a)})}function a(){t.getStatuses().$promise.then(function(e){var t=e;c.data.compointsBoosters=u.map(function(e){var n=t.find(function(t){return t.id===e.id});return n&&_.assign(e,n),e.isUserCompointsBooster=Boolean(n),e}).map(r).map(o).map(i)})}function r(e){return e.finished_at||(e.timer=new Date(e.start_at).getTime()-(new Date).getTime(),e.startAtTimer=new Date(e.start_at).getTime()-(new Date).getTime(),e.endAtTimer=new Date(e.end_at).getTime()-(new Date).getTime()),e.startAtTimer<=0&&(e.startAtTimer=0),e.endAtTimer<=0&&(e.endAtTimer=0),e}function o(e){return(new Date).getTime()<new Date(e.start_at).getTime()&&(e.status="not_started"),(new Date).getTime()>=new Date(e.start_at).getTime()&&(new Date).getTime()<new Date(e.end_at).getTime()&&(e.status="in_progress"),(new Date).getTime()>new Date(e.end_at).getTime()&&(e.status="finished"),e}function i(e){return e.multiplier=Number(e.multiplier),e}function s(){c.data.compointsBoosters=[]}e.$on("authLogoutSuccess",s);var c={data:{compointsBoosters:[]},refresh:n};n();var u=[];return c}e.$inject=["$rootScope","CompointsBoostersResource"],angular.module("casino.services").factory("CompointsBoostersService",e)}(),function(){function e(e,t){function n(){i.documents=t.data.list}function a(){var e=i.type+":"+i.description;t.upload(i.file,e).then(function(e){e&&e.data&&e.data.errors?i.errors=e.data.errors:i.errors={}}),i.file=null,i.description=""}function r(e){t.remove(e).then(function(){}).catch(function(){})}function o(){i.file=null}var i=this;i.description="",i.errors={},i.documents=[],i.uploadFile=a,i.removeFileById=r,i.cancel=o,e.$on("documentsListChanged",n),n()}e.$inject=["$rootScope","Documents"],angular.module("casino").directive("fileModel",["$parse",function(e){return{restrict:"A",link:function(t,n,a){var r=e(a.fileModel),o=r.assign;n.bind("change",function(){t.$apply(function(){a.multiple?o(t,n[0].files):o(t,n[0].files[0])})})}}}]).component("userDocuments",{
templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Documents/_"+(t.template||"main")+".html"}],controller:e,bindings:{type:"<"}})}(),function(){angular.module("casino.services").factory("DocumentsResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/player/documents/:id",{},{get:{method:"GET",isArray:!0},remove:{method:"DELETE",params:{id:"@id"}},update:{method:"PATCH",params:{id:"@id"}},upload:{method:"POST",transformRequest:angular.identity,headers:{"Content-Type":void 0,Accept:"multipart/form-data"}}})}])}(),function(){function e(e,t,n,a,r){function o(){r.get().$promise.then(function(t){c.data.list=t,e.$broadcast("documentsListChanged",c.data.list)})}function i(e){return r.remove({id:e}).$promise.then(function(){n.show("flash.documents.destroy.notice",{classes:"alert-success"}),o()}).catch(function(e){Promise.reject(e)})}function s(e,r){return a.upload({url:t.URL_API+"/player/documents",headers:{"Content-Type":void 0,Accept:"multipart/form-data"},data:{document:{attachment:e,description:r}}}).then(function(){n.show("flash.documents.create.notice",{classes:"alert-success"}),o()}).catch(function(e){return e.data.errors||o(),e})}var c={data:{list:[]},remove:i,upload:s};return e.$on("authLoginSuccess",o),e.$on("authLogoutSuccess",function(){c.data={}}),e.data.user&&e.data.user.email&&o(),c}e.$inject=["$rootScope","SYSTEM","Notification","Upload","DocumentsResource"],angular.module("casino.services").factory("Documents",e)}(),function(){function e(e,t){function n(){o.freespins=t.data.freespins}function a(e){t.activateById(e).then(function(){})}function r(e){t.deactivateById(e).then(function(){})}var o=this;o.activateById=a,o.deactivateById=r,e.$on("freespinsRefreshSuccess",n),n()}e.$inject=["$rootScope","Freespins"],angular.module("casino").component("casinoFreespins",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Freespins/_"+(t.template||"main")+".html"}],controller:e}),angular.module("casino").controller("FreespinsCtrl",e)}(),function(){function e(e,t,n,a,r){function o(){e.data.user&&e.data.user.email&&(i(),E||(n.subscribe("freespins_changes#",function(e){f(e.data)}),E=!0))}function i(){a.get().$promise.then(c)}function s(e){e.forEach(function(e){var t=A.freespins.find(function(t){return t.id===e.id});t&&t.activatable!==e.activatable&&f(e)})}function c(t){if(s(t),A.freespins=t.map(m),r.inited)u();else var n=e.$on("gamesInitialized",function(){u(),n()})}function u(){A.freespins=A.freespins.map(h).map(b),l("games"),T.every(d)&&e.$broadcast("freespinsRefreshSuccess",A.freespins)}function l(e){T.find(function(t){return t.name===e}).isInited=!0}function d(e){return e.isInited}function f(t){var n=A.freespins.find(function(e){return e.id===t.id});n?(_.assign(n,t),n=_.chain(n).tap(b).tap(m).tap(h).value(),e.$broadcast("freespinUpdated",n)):(t=_.chain(t).tap(b).tap(m).tap(h).value(),A.freespins.push(t),e.$broadcast("newFreespinAdded",t)),e.$broadcast("freespinsRefreshSuccess",A.freespins)}function m(e){return e.activatable?e.timer=new Date(e.activatable_until).getTime()-(new Date).getTime():e.timer=new Date(e.valid_until).getTime()-(new Date).getTime(),e.timer<=0&&(e.timer=0),e}function p(e){return a.activateById({id:e}).$promise}function g(e){return a.deactivateById({id:e}).$promise}function h(e){return e.games&&(e.games=e.games.map(y),e.games=e.games.filter(v)),e}function y(e){return r.getByIdentifier(e.replace(":","/"))}function v(e){return e}function b(e){return e.diff=(new Date).getTime()-new Date(e.created_at).getTime(),e}function $(e){return I.indexOf(e.stage)>-1}function S(e){return e.activatable&&"issued"==e.stage}function w(){A.freespins=[],E=!1,e.$broadcast("freespinsRefreshSuccess",A.freespins)}function C(n){n=n||{},n.template=n.template||"freespin-item-modal",e.mainModal.modal=t.open({template:'<casino-freespin-item template="'+n.template+'"freespin="$ctrl.freespin"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></casino-freespin-item>',controller:function(){this.freespin=n.freespin},windowClass:"modal-freespins",controllerAs:"$ctrl"})}var A={freespins:[]},E=!1,I=["issued","activated"],T=[{name:"games",isInited:!1}];return e.$on("authLoginSuccess",o),e.$on("freespinsRefresh",i),e.$on("exchangedCompointsForFreespinsSuccess",i),e.$on("authLogoutSuccess",w),o(),{data:A,activateById:p,deactivateById:g,getAll:i,showFreespinModal:C,isFreespinBonusActive:$,isFreespinActivatable:S,addTimerField:m}}e.$inject=["$rootScope","$modal","RealTime","PlayerFreespinsResource","GamesData"],angular.module("casino.services").factory("Freespins",e)}(),function(){function e(e,t){return e(t.URL_API+"/player/freespins/:id/:action",{},{get:{method:"GET",isArray:!0},activateById:{method:"POST",params:{id:"@id",action:"activation"}},deactivateById:{method:"DELETE",params:{id:"@id"}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("PlayerFreespinsResource",e)}(),function(){function e(e,t,n,a){function r(){o.limits=t.data.limits}var o=this;o.LimitsService=t,o.LIMIT_STATUSES=n,o.limits=t.data.limits,e.$on("limitsRefreshSuccess",r)}e.$inject=["$rootScope","LimitsService","LIMIT_STATUSES","LIMIT_TYPES"],angular.module("casino").component("casinoLimits",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Limits/_"+(t.template||"main")+".html"}],controller:e,bindings:{close:"&",dismiss:"&"}}),angular.module("casino").controller("LimitsCtrl",e)}(),function(){angular.module("casino.constants").constant("strategies",["accounts","access"]).constant("LIMIT_PERIODS",{deposit:["day","week","month"],loss:["day","week","month"],bet:["day","week","month"],wager:["day","week","month"],coolingoff:["day","day_3","week","month","month_3","month_6"],selfexclusion:["month_6","month_9","month_12","forever"],session:[]}).constant("LIMIT_FIELDS_TO_SHOW",{deposit:{amount:!0,currency:!0,period:!0},loss:{amount:!0,currency:!0,period:!0},bet:{amount:!0,currency:!0,period:!0},wager:{amount:!0,currency:!0,period:!0},coolingoff:{amount:!1,currency:!1,period:!0},selfexclusion:{amount:!1,currency:!1,period:!0},session:{amount:!1,currency:!1,period:!0}}).constant("LIMIT_TYPES",["deposit","loss","bet","wager","coolingoff","selfexclusion","session"]).constant("LIMIT_STATUSES",{ACTIVE:"active",CONFIRMED:"confirmed",CONFIRMED_DISABLE:"confirmed_disable",UNCONFIRMED_DISABLE:"unconfirmed_disable",UNCONFIRMED:"unconfirmed",DISABLED:"disabled"})}(),function(){function e(e,t){return e(t.URL_API+"/user_limits/:action/:id",{},{get:{method:"GET",params:{},isArray:!0},create:{method:"POST",params:{}},confirm:{method:"POST",params:{action:"confirm"}},remove:{method:"DELETE",params:{id:"@id"}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("LimitsResource",e)}(),function(){function e(e,t,n,a,r,o,i,s){function c(){o.get().$promise.then(d)}function u(t){var n=e.Info.currencies.find(function(e){return e.code===t.currency});return t.amount=(t.amount_cents/n.subunits_to_unit).toFixed(20).replace(/\.?0+$/,""),t.fiat=n.fiat,t}function l(t){y.limits=t.map(function(e){return e.accounts&&(e.accounts=e.accounts.map(u)),e}),f(y.limits),m(y.limits),e.$broadcast("limitsRefreshSuccess",y.limits)}function d(t){if(e.Info.currencies)l(t);else var n=e.$on("currenciesUpdated",function(){l(t),n()})}function f(e){e.forEach(function(e){"accounts"===e.strategy&&(y.availablePeriods[e.type]=i[e.type].filter(function(t){return t!==e.period}))})}function m(e){s.forEach(function(t){y.limitsExistence[t]=e.some(function(e){return e.type===t})})}function p(e){return o.confirm({token:e}).$promise.then(c).finally(function(){a.go("app.profile_urls",{path:"limits"})})}function g(){d([])}function h(n){n=n||{},n.template=n.template||"limits-modal";var a="/app/Users/Limits/_"+n.template+".html";e.mainModal.modal=t.open({templateUrl:a,controller:function(){this.params=n},windowClass:n.windowClass?n.windowClass+" modal-limits":"modal-limits",controllerAs:"$ctrl"}),e.mainModal.modal.result.then(function(){_(n)},function(){_(n)})}function _(t){t.isFirstTimeLogin&&n(function(){e.$broadcast("SuccessConfirmationLimits")})}var y={limits:[],availablePeriods:i,limitsExistence:{loss:!1,deposit:!1,wager:!1,coolingoff:!1,selfexclusion:!1,session:!1}};return e.$on("refreshLimits",c),e.$on("authLoginSuccess",c),e.$on("authLogoutSuccess",g),e.data&&e.data.user.email&&c(),{data:y,refreshLimits:c,confirm:p,showModal:h}}e.$inject=["$rootScope","$modal","$timeout","$state","$location","LimitsResource","LIMIT_PERIODS","LIMIT_TYPES"],angular.module("casino.services").factory("LimitsService",e)}(),function(){angular.module("casino").filter("lootboxes_stages",[function(){return function(e,t){var n=t?e.filter(function(e){return t.includes(e.stage)}):e;if(t&&t.includes("issued")&&!t.includes("activated")){var a=_.where(e,{isJustActivated:!0});n=n.concat(a)}return n}}]).filter("lootbox_bonuses_type",[function(){return function(e){return e.bonuses[0].type}}]).filter("lootbox_bonuses_value",["$filter","$rootScope",function(e,t){return function(n){var a,r;if("freespins"===n.bonuses[0].type&&(a=_.findWhere(n.bonuses[0].attributes,{field:"freespins_count"}),r=a.value),"bonus"===n.bonuses[0].type){a=_.findWhere(n.bonuses[0].attributes,{field:"bonus_amount"});var o=_.findWhere(a.value,{currency:t.data.user.currency})||a.value[0];r=e("humanized_currency")(o.amount_cents,o.currency)}return r}}]).filter("lootbox_timer",[function(){return function(e){var t=new Date(e)-new Date;return t>0&&t}}])}(),function(){function e(e,t,n,a,r){function o(){e.data.user&&e.data.user.email&&(i(),v||(a.subscribe("lootboxes_changes#",function(e){f(e.data)}),v=!0))}function i(){return r.get().$promise.then(s)}function s(t){y.data.lootboxesList=t,t.forEach(function(e){c(e)}),e.$broadcast("lootboxesListRefreshSuccess",t)}function c(e){var t=new Date(e.valid_until),a=t.getTime()-Date.now();a>0&&n(function(){u(e)},a)}function u(e){"issued"===e.stage&&(e.stage="expired"),f(e)}function l(e){return r.activate({issue_id:e}).$promise.then(function(){return Promise.resolve()})}function d(e){return r.cancel({issue_id:e}).$promise}function f(t){var n=m(t.id);n?("issued"===n.stage&&"activated"===t.stage&&(t.isJustActivated=!0),_.assign(n,t),e.$broadcast("lootboxesUpdated",n)):(c(t),y.data.lootboxesList.push(t),y.data.lootboxesList=y.data.lootboxesList.sort(function(e,t){return e.id<t.id?1:-1}),e.$broadcast("newLootboxesAdded",t)),e.$broadcast("lootboxesListRefreshSuccess",y.data.lootboxesList)}function m(e){return _.findWhere(y.data.lootboxesList,{id:e})}function p(e){return"issued"===e.stage}function g(){y.data.lootboxesList=[],e.$broadcast("lootboxesListRefreshSuccess",y.data.lootboxesList)}var h={lootboxesList:[]},y={data:h,activateById:l,cancelById:d,isLootboxesActivatable:p},v=!1;return e.$on("authLoginSuccess",o),e.$on("authLogoutSuccess",g),o(),y}e.$inject=["$rootScope","$modal","$timeout","RealTime","PlayerLootboxesResource"],angular.module("casino.services").factory("LootboxesService",e)}(),function(){function e(e,t){function n(){a.lootboxesList=t.data.lootboxesList}var a=this;a.lootboxesList=t.data.lootboxesList,e.$on("lootboxesListRefreshSuccess",n)}e.$inject=["$rootScope","LootboxesService"],angular.module("casino").component("lootboxesList",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/LootboxesList/_"+(t.template||"main")+".html"}],bindings:{limit:"<",stages:"<",isOpened:"<"},controller:e}),angular.module("casino").controller("LootboxesListCtrl",e)}(),function(){function e(e,t){return e(t.URL_API+"/player/lootboxes/:issue_id/:action",{},{get:{method:"GET",params:{},isArray:!0},activate:{method:"POST",params:{issue_id:"@issue_id",action:"activation"}},cancel:{method:"DELETE",params:{issue_id:"@issue_id"}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("PlayerLootboxesResource",e)}(),function(){function e(e,t){function n(){var e=t.list||{};for(var n in e)e[n].data.in_progress&&r.active_lotteries.push(e[n])}function a(){r.user_list=t.data.user_list,n()}var r=this;r.limit=r.limit||null,r.user_list=[],r.active_lotteries=[],e.$on("LotteryUpdated",a),a()}e.$inject=["$rootScope","Lottery"],angular.module("casino").component("casinoLotteries",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Lottery/_"+(t.template||"main")+".html"}],bindings:{limit:"@"},controller:e})}(),function(){angular.module("casino.services").factory("LotteryResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/lotteries/:id/:action",{},{list:{method:"get",params:{action:null,id:null},isArray:!0},playerList:{method:"get",params:{action:"player",id:null},isArray:!0},byId:{method:"get",params:{action:null}},statuses:{method:"get",params:{action:"statuses",id:null},isArray:!0},statusById:{method:"get",params:{action:"status",id:null}}})}])}(),function(){function e(e,t,n,a){function r(e){return g[e.id]?g[e.id].constructor(e):g[e.id]=new S(e),g[e.id]}function o(){n.all({list:p.list().$promise,playerList:p.playerList().$promise}).then(i)}function i(t){t.list.forEach(function(e){e.is_available=!!_.findWhere(t.playerList,{id:e.id}),r(e)}),t.list.length&&($=!0,e.data.user.email&&s(),b||(b=!0,e.$on("authLoginSuccess",s),e.$on("authLogoutSuccess",u)));for(var n in g)g[n].data.empty&&g[n].update();e.$broadcast("lotteriesUpdated",g)}function s(){return p.statuses().$promise.then(function(t){var n=[];t.forEach(function(e){g[e.lottery_id].addUserStatus(e),n.push(g[e.lottery_id].data),h.user_list=n}),c(e.data.user.currency),e.$broadcast("LotteryUpdated",g)})}function c(t){function n(e){return e.data.in_progress}function a(e){return e.data.is_available}function r(e){return e.data.deposit_scale_rules[t]}return h.depositLotteries=Object.values(g).filter(n).filter(r).filter(a),e.$broadcast("DepositLotteriesUpdated",h.depositLotteries),h.depositLotteries}function u(){v={},h.user_list=[],b=!1}function l(t,n,a){if(!(t&&n&&a))return 0;var r=n*_.findWhere(e.Info.currencies,{code:a}).subunits_to_unit,o=t.data.deposit_scale_rules[a].reduce(function(e,t){return r>=t.from_amount_cents&&(e=t),e},null),i=t.data.max_tickets_count_to_player;v[t.data.id]&&i&&(i-=v[t.data.id].tickets.length);var s=o?Math.floor(r/o.price_cents):0;return _.isNumber(i)?Math.min(s,i):s}function d(){e.data&&e.data.user.email?o():p.list().$promise.then(function(e){i({list:e,playerList:[]})})}function f(e){return!!e&&(g[e]||(r({id:e,empty:!0}),$&&g[e].update()),g[e])}function m(e){return f(y[e])}var p=a,g={},h={user_list:[],depositLotteries:[]},y={},v={},b=!1,$=!1;e.$on("exchangedCompointsForLotteriesSuccess",o),e.$on("authLoginSuccess",o),e.$on("paymentSubmitSuccess",o);var S=function(e){e=this.preparePrizes(e),e=this.prepareWinners(e),e.frontend_identifier&&(y[e.frontend_identifier]=e.id),e.main_budget=+e.money_budget||+e.chargeable_comp_points_budget||+e.persistent_comp_points_budget,this.data=e,this.setStatus(),this.setTimer()};if(S.prototype.preparePrizes=function(e){for(var t in e.prizes)e.prizes[t].money_budget_percent&&(e.prizes[t].money=e.prizes[t].money+e.money_budget/100*e.prizes[t].money_budget_percent,e.prizes[t].money=e.prizes[t].money+" "+e.currency),e.prizes[t].chargeable_comp_points_percent&&(e.prizes[t].chargeable_comp_points=parseInt(e.prizes[t].chargeable_comp_points+e.chargeable_comp_points_budget/100*e.prizes[t].chargeable_comp_points_percent)),e.prizes[t].persistent_comp_points_percent&&(e.prizes[t].persistent_comp_points=parseInt(e.prizes[t].persistent_comp_points+e.persistent_comp_points_budget/100*e.prizes[t].persistent_comp_points_percent)),e.prizes[t].main=e.prizes[t].stuff||e.prizes[t].money||e.prizes[t].chargeable_comp_points||e.prizes[t].persistent_comp_points;return e},S.prototype.prepareWinners=function(e){for(var t in e.top_players)e.top_players[t].prize=e.prizes[e.top_players[t].award_place-1];return e},S.prototype.update=function(){var t=this;p.byId({id:this.data.id},function(n){e.data.user.email?p.statusById({id:t.data.id},function(e){r(n).addUserStatus(e)}):r(n),t.auto_update&&t.autoUpdate()})},S.prototype.setStatus=function(){this.data.finished_at?this.data.status="closed":this.data.in_progress?this.data.status="in_progress":new Date(this.data.start_at).getTime()-(new Date).getTime()>0?this.data.status="not_started":new Date(this.data.end_at).getTime()-(new Date).getTime()>0&&(this.data.status="finished")},S.prototype.setTimer=function(){if(this.data.timer=0,this.data.finished_at)return!1;var e=this.data.start_at;this.data.in_progress&&(e=this.data.end_at),this.data.timer=new Date(e).getTime()-(new Date).getTime(),this.data.timer<=0&&(this.data.timer=0)},S.prototype.addUserStatus=function(e){var t=this,n=function(e){v[e.lottery_id]=e,t.data.user_status=v[e.lottery_id]};e?n(e):p.statusById({id:this.data.id},function(e){n(e)})},S.prototype.autoUpdate=function(e){if(e&&this.auto_update)return!1;var n=this;this.auto_update=this.auto_update||e,t(function(){n.update()},this.auto_update)},e.currentLocale)d();else var w=e.$on("localeChanged",function(){d(),w()});return{data:h,list:g,identifier_list:y,get:f,getDepositLotteries:c,getTicketsNumber:l,getByIdentifier:m}}e.$inject=["$rootScope","$timeout","$q","LotteryResource"],angular.module("casino.services").factory("Lottery",e)}(),function(){function e(e,t,n){function a(n,a){e.mainModal.close(),e.mainModal.modal=t.open({templateUrl:"/app/Users/NotificationsCentre/modals/_"+n+".html",controller:function(){this.type=n,this.params=a},windowClass:"modal-notifications modal-notifications--"+n,controllerAs:"$ctrl"})}var r=this;r.data=n,r.showNotificationModal=a}e.$inject=["$rootScope","$modal","NotificationsCentreService"],angular.module("casino").component("notificationsCentre",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/NotificationsCentre/_"+(t.template||"main")+".html"}],controller:e}),angular.module("casino").controller("NotificationsCentreCtrl",e)}(),function(){function e(e,n,a,r,o,i,s,c){function u(){T=e.$on("freespinsRefreshSuccess",f),L=e.$on("bonusesRefreshSuccess",p),P=e.$on("playerPaymentsRefreshSuccess",g),O=e.$on("lootboxesListRefreshSuccess",h)}function l(t,n,a){this.data=angular.copy(t),this.type=angular.copy(n),a||(this.not_read=!0,I.new_events+=1,e.$broadcast("newNotificationsCentreMessage",this))}function d(e,n){S(n,t.freespins)}function f(e,n){T(),n.filter(a.isFreespinNeeded).forEach(function(e){S(e,t.freespins,!0)})}function m(e,a){S(a,t.bonus),k.push(a),n(function(){k=k.filter(function(e){return e.id!==a.id})},R)}function p(e,n){L(),n.filter(a.isBonusNeeded).forEach(function(e){S(e,t.bonus,!0)})}function g(e,n){P(),[n].filter(a.isPaymentNeeded).forEach(function(e){S(e,t.payment,!0)})}function h(e,n){O(),n.filter(a.isLootboxesNeeded).forEach(function(e){S(e,t.lootboxes,!0)})}function y(e,n){S(n,t.lootboxes)}function v(e,t){var n=I.list.find(function(e){return e.data.id===t.id});n&&(n.data=t,a.isLootboxesNeeded(n.data)||(I.list=I.list.filter(function(e){return e.data.id!==t.id})))}function b(e,t){var n=I.list.find(function(e){return e.data.id===t.id});n&&(n.data=t,a.isFreespinNeeded(n.data)||(I.list=I.list.filter(function(e){return e.data.id!==t.id})))}function $(e,n){var r=I.list.find(function(e){return e.data.id===n.id});r&&(r.data=n,a.isBonusNeeded(r.data)||_.findWhere(k,{id:r.data.id})||(I.list=I.list.filter(function(e){return e.data.id!==n.id}))),"wager_done"===n.stage&&S(n,t.wager_done)}function S(e,t,n){I.list.push(new l(e,t,n))}function w(){I.list.forEach(function(e){e.markAsRead()})}function C(e,n){S(n,t.payment)}function A(e,n){S(n,t.status)}function E(){I.list=[],u()}var I={list:[],new_events:0,readAll:w,addCard:S},T=function(){},L=function(){},P=function(){},k=[],R=500,O=function(){};return e.$on("newFreespinAdded",d),e.$on("newBonusAdded",m),e.$on("newPaymentAdded",C),e.$on("newLootboxesAdded",y),e.$on("statusChanged",A),e.$on("freespinUpdated",b),e.$on("bonusUpdated",$),e.$on("lootboxesUpdated",v),e.$on("authLogoutSuccess",E),u(),l.prototype.markAsRead=function(){this.not_read&&(I.new_events-=1),this.not_read=!1},I}e.$inject=["$rootScope","$timeout","NotificationsCentreFiltersService","Freespins","BonusesService","PlayerPaymentsService","StatusesService","LootboxesService"];var t={freespins:"freespins",bonus:"bonus",payment:"payment",lootboxes:"lootboxes",wager_done:"wager_done",status:"status"};angular.module("casino.services").factory("NotificationsCentreService",e)}(),function(){function e(e,t,n){function a(t){return e.isFreespinActivatable(t)}function r(e){return t.isBonusActivatable(e)}function o(e){return!1}function i(e){return n.isLootboxesActivatable(e)}return{isFreespinNeeded:a,isBonusNeeded:r,isPaymentNeeded:o,isLootboxesNeeded:i}}e.$inject=["Freespins","BonusesService","LootboxesService"],angular.module("casino.services").factory("NotificationsCentreFiltersService",e)}(),function(){function e(e,t,n,a,r,o,i){var s=t.params.currency,c=t.params.action;t.go("home",{lang:e.currentLocale}),r.check(function(){function r(e){u(e),f.every(l)&&d()}function u(e){_.findWhere(f,{name:e}).isInited=!0}function l(e){return e.isInited}function d(){var r=n.sessionStorage.getItem("savedGameState");a.search().redirected_from_game&&r?"mobile"!==e.data.device&&(t.go("app.game",JSON.parse(r),{reload:!0,inherit:!1}),n.sessionStorage.removeItem("savedGameState")):(a.search("redirected_from_game",null),n.sessionStorage.removeItem("savedGameState")),e.data.user.email&&o.showPaymentsModal({selectedCurrency:s,selectedTab:c})}var f=[{name:"currencies",isInited:!1},{name:"balances",isInited:!1}];if(e.Info.currencies)r("currencies");else var m=e.$on("currenciesUpdated",function(){r("currencies"),m()});if(i.data.allUserBalances.length)r("balances");else var p=e.$on("balanceRefreshSuccess",function(){r("balances"),p()})})}e.$inject=["$rootScope","$state","$window","$location","Auth","Payments","Balance"],angular.module("casino").controller("AccountsRouteController",e)}(),function(){function e(e,t){function n(e){t.changeTab(e)}function a(){o.selectedTab=t.data.selectedTab,o.actions={deposit:{available:t.data.deposit.available},cashout:{available:t.data.cashout.available}}}function r(){n()}var o=this;e.$on("paymentsDataUpdated",a),o.changeTab=n,o.actions={deposit:{},cashout:{}},o.$onDestroy=r,o.selectedTab&&n(o.selectedTab),a()}e.$inject=["$scope","Payments"],angular.module("casino").component("paymentsTabs",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Payments/_"+(t.template||"main")+".html"}],bindings:{selectedTab:"<",selectedCurrency:"=",close:"&",dismiss:"&"},controller:e})}(),function(){function e(e,t,n,a,r,o){function i(e){r.onSelectAccount(e,h.action)}function s(e,t,n,a){r.onSelectPaymentMethod(e,t,n,a)}function c(e,t){r.onSubmit(e,t)}function u(e){r.onDisableSavedMethod(e)}function l(){if(h.selectedTab=r.data.selectedTab,h.selectedCurrency=r.data[h.action].selectedCurrency,h.selectedMethod=r.data[h.action].selectedMethod,h.paymentMethods=r.data[h.action].paymentMethods&&r.data[h.action].paymentMethods.filter(f).filter(m),h.savedPaymentMethods=angular.copy(r.data[h.action].savedPaymentMethods&&r.data[h.action].savedPaymentMethods.filter(f).filter(m)),!h.selectedMethod&&h.paymentMethods&&h.paymentMethods.length){var e=d(h.paymentMethods);e&&s(e.id,e.brand,e.identifier)}h.balances=r.data.balances,h.loadingPaymentMethods=r.data[h.action].loadingPaymentMethods,h.loadingPaymentPlan=r.data[h.action].loadingPaymentPlan,h.loadingSubmit=r.data[h.action].loadingSubmit,h.submittedSuccessfully=r.data[h.action].submittedSuccessfully,h.paymentPlan=r.data[h.action].paymentPlan,h.errors=r.data[h.action].errors,h.commonErrors=r.data[h.action].commonErrors,r.data[h.action].paymentPlan&&n(function(){h.paymentPlan=r.data[h.action].paymentPlan},0),h.paymentPlan&&(h.amountField=_.findWhere(h.paymentPlan.fields,{field:"amount"}),h.details=a("humanize_payment_plan_details")(h.paymentPlan))}function d(e){var t=_.find(e,function(e){return e.deposit_saved_methods&&!e.is_locked});return t||_.find(e,function(e){return!e.is_locked})}function f(e){var t=h.action&&h.action.toLowerCase();return e.hasOwnProperty(t)}function m(e){return e.is_supported}function p(e,t){h.bonusPreviewAvailable=t}function g(){h.lotteries_available=o.data.depositLotteries.length>0}var h=this;h.actions={deposit:"deposit",cashout:"cashout"},h.bonusPreviewAvailable=!0,t.$on("paymentsDataUpdated",l),t.$on("bonusPreviewSettingsUpdated",p),t.$on("DepositLotteriesUpdated",g),h.onSelectAccount=i,h.onSelectPaymentMethod=s,h.onSubmit=c,h.onDisableSavedMethod=u,i(h.selectedCurrency,h.action),g()}e.$inject=["$rootScope","$scope","$timeout","$filter","Payments","Lottery"],angular.module("casino").component("payments",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Payments/_"+(t.template||"main")+".html"}],bindings:{action:"<",selectedCurrency:"<"},controller:e})}(),function(){angular.module("casino.constants").constant("PAYMENTS_CONTANTS",{enabled:!0,currencies:{AUD:{values:[10,20,50,100,200],default:50},CAD:{values:[10,20,50,100,200],default:50},CZK:{values:[100,200,500,1e3,2e3],default:200},EUR:{values:[10,20,50,100,200],default:50},JPY:{values:[2e3,3e3,5e3,1e4,2e4],default:1e4},NOK:{values:[200,300,500,1e3,2e3],default:200},NZD:{values:[10,20,50,100,200],default:50},PLN:{values:[100,200,300,500,1e3],default:200},RUB:{values:[300,500,1e3,2e3,3e3],default:1e3},SEK:{values:[100,200,500,1e3,2e3],default:200},UAH:{values:[300,500,1e3,2e3,5e3],default:500},USD:{values:[10,20,50,100,200],default:50},ZAR:{values:[10,20,50,100,200],default:20}}})}(),function(){function e(e){this.showPaymentsModal=e.showPaymentsModal}e.$inject=["Payments"],angular.module("casino.services").controller("PaymentsCtrl",e)}(),function(){angular.module("casino").filter("humanize_payment_plan_details",["$filter",function(e){function t(e){var t=e.method[e.action],c=e.currency;return _.compact([a(t),r(t),o(t),i(t),s(t),n(c)]).join(", ")}function n(t){return e("translate")("payments.limits.currency",{currency:t})}function a(t){var n,a=t.processing_time;switch(!0){case"instant"===a:n=e("translate")("payments.processing_time.instantly");break;case _.isObject(a):n=e("translate")("payments.processing_time.range",{min:a.min,max:a.max});break;default:n=a}return n}function r(e){return e.deposit_hint?e.deposit_hint:""}function o(t){var n,a=t.min;return a>0&&(n=e("translate")("payments.limits.min",{min:a})),n}function i(t){var n,a=t.max;return a>0&&(n=e("translate")("payments.limits.max",{max:a})),n}function s(t){var n=_.compact([c(t),u(t)]).join(" + ");return n?e("translate")("payments.limits.fee",{fee:n}):""}function c(e){var t=e.commission_fixed;return t>0?t:""}function u(e){var t=e.commission_percent;return t>0?t+"%":""}return function(e){return t(e)}}])}(),function(){function e(e,t,n,a,r,o,i,s,c,u,l,d,f,m,p,g,h){function y(e){window.PaymentsAPI?e?v(e):console.warn("No currency is defined to fetch payment methods."):(console.warn("window.PaymentsAPI still loading..."),V&&V(),V=t.$on("PaymentsAPILoadedSuccessfully",function(){v(e)}))}function v(e){ne.data[ne.data.selectedTab].loadingPaymentMethods=!0,t.$broadcast("paymentsDataUpdated"),window.PaymentsAPI.fetchPaymentMethods(e,K).then(function(e){t.$apply(function(){ne.data.selectedTab&&(["deposit","cashout"].forEach(function(t){ne.data[t].paymentMethods=b(e,t.toLowerCase()),ne.data[t].paymentMethods=ne.data[t].paymentMethods.filter(function(e){return window.PaymentsAPI.savedChannels(t.toLowerCase(),e).length||window.PaymentsAPI.isNewPaymentEnabled(t,e)||e.is_locked}).filter(function(e){return!!e[t]})}),ne.data[ne.data.selectedTab].loadingPaymentMethods=!1,t.$broadcast("paymentsDataUpdated"))}),ee=Q}).catch(function(n){ee--,ee>0&&ne.data[ne.data.selectedTab].selectedCurrency===e?o(function(){v(e)},Z):(ee=Q,ne.data[ne.data.selectedTab].loadingPaymentMethods=!1,t.$broadcast("paymentsDataUpdated"))})}function b(e,t){return angular.copy(e).map(function(e){return e.is_locked=!PaymentsAPI.isPaymentMethodEnabled(t,e),e.is_new_payment_enabled=window.PaymentsAPI.isNewPaymentEnabled(t,e),e}).map(S).map(w)}function S(e){return e.is_supported=PaymentsAPI.SUPPORTED_PROVIDERS.includes(e.provider),e}function w(e){if(e.provider===e.brand?e.icon_cdn_name=e.provider:e.icon_cdn_name=e.provider+"-"+e.brand,"coinspaid"===e.provider&&(e.icon_cdn_name=e.currency+"_"+e.icon_cdn_name),"accentpay"===e.provider&&"card"===e.brand){var t=ne.data.selectedTab;t&&ne.data[t].selectedCurrency&&(e.icon_cdn_name=ne.data[t].selectedCurrency+"_"+e.icon_cdn_name)}return e}function C(){var e=ne.data.selectedTab;e&&ne.data[e].selectedCurrency&&te(ne.data[e].selectedCurrency)}function A(e){var n=ne.data.selectedTab;ne.data.balances="deposit"===n?_.where(c.data.balances,{deposit_available:!0}):c.data.balances,n&&(ne.data.balances[0]&&!E(ne.data[n].selectedCurrency)?I(ne.data.balances[0].code,n):!ne.data[n].selectedCurrency||ne.data[n].paymentMethods||ne.data[n].loadingPaymentMethods||te(ne.data[n].selectedCurrency),_.findWhere(ne.data.balances,{currency:ne.data[n].selectedCurrency})),t.$broadcast("paymentsDataUpdated")}function E(e){return _.findWhere(ne.data.balances,{code:e})}function I(e,n){n=n||ne.data.selectedTab,e=e||t.data.user.currency,E(e)||(e=ne.data.balances[0]&&ne.data.balances[0].code),n&&(ne.data[n].selectedCurrency=e,ne.data[n].paymentMethods=null,ne.data[n].paymentPlan=null,ne.data[n].savedPaymentMethods=[],ne.data[n].errors=null,ne.data[n].commonErrors=null,ne.data[n].selectedMethod=null,f.getDepositLotteries(e),o(z),t.$broadcast("paymentsDataUpdated"),te(e,n))}function T(e,t,n,a){var r=ne.data.selectedTab;return ne.data[r].selectedMethod&&ne.data[r].selectedMethod.id===e&&ne.data[r].selectedMethod.brand===t&&!n&&!a}function L(e,n,a,r){if(!T(e,n,a,r)){var i=ne.data.selectedTab;a=a||null,ne.data[i].selectedMethod=j(e,n,a),ne.data[i].paymentPlan=null,ne.data[i].loadingPaymentPlan=!0,ne.data[i].errors=null,ne.data[i].commonErrors=null,ne.data[i].submittedSuccessfully=!1,ne.data[i].savedPaymentMethods=[];var s={currency:ne.data[i].selectedCurrency,action:i.toLowerCase(),method:ne.data[i].selectedMethod},c=window.PaymentsAPI.savedChannels(i.toLowerCase(),ne.data[i].selectedMethod);c.forEach(function(e){ne.data[i].savedPaymentMethods.push(_.assign({},ne.data[i].selectedMethod,e))}),c.length&&window.PaymentsAPI.buildPaymentPlan(s.currency,s.action,s.method,c[0].identifier).then(function(e){ne.data[i].savedPaymentMethods=ne.data[i].savedPaymentMethods.map(function(t){return t.supportDisable=e.supportDisable,t})}),t.$broadcast("paymentsDataUpdated"),window.PaymentsAPI.buildPaymentPlan(s.currency,s.action,s.method,a,K).then(function(e){ne.data[i].paymentPlan=e,ne.data[i].paymentPlan.fields=ne.data[i].paymentPlan.fields.map(function(e){if(e.localData={type:e.type},e.model=e.value||"",e.label="formtastic.labels."+(e.label_key||e.field),"cvv"===e.type&&(e.localData.maxlength=4,e.onChangeCallback=function(e,t){o(function(){e.model=t&&t.replace(/\D/g,"")})}),"expiry_date"===e.field&&(e.localData.multipleField=!0,e.expiryYear={},e.expiryMonth={},e.expiryYear.inclusion={in:Array.apply(null,{length:16}).map(Number.call,Number).map(function(t){return(t+(new Date).getFullYear()).toString().slice(e.show_full_year?0:-2)})},e.expiryYear.inclusion.in.unshift("date.yy"),e.expiryMonth.inclusion={in:["01","02","03","04","05","06","07","08","09","10","11","12"]},e.expiryMonth.inclusion.in.unshift("date.mm")),"select"===e.type&&(e.inclusion={},e.inclusion.in=e.options.reduce(function(e,t){return e[t[1]]=t[0],e},{})),"cascade_select"===e.type&&(e.values=e.values.map(function(e){return e.inclusion={},e.inclusion.in=e.list.reduce(function(e,t){return e[t[1]]=t[0],e},{}),e})),"amount"===e.type&&m.enabled){e.localData.currency=s.currency;var t=m.currencies[s.currency];if(t){var n=s.method[s.action].min,a=s.method[s.action].max;e.localData.prefilled_values=t.values.filter(function(e){return P(e,n,a)}),e.localData.defaultvalue=t.default}}return e}),ne.data[i].loadingPaymentPlan=!1,t.$broadcast("paymentsDataUpdated")}).catch(function(e){
ne.data[i].loadingPaymentPlan=!1,t.$broadcast("paymentsDataUpdated")})}}function P(e,t,n){return t<=e&&e<=n}function k(e){var n=ne.data.selectedTab,a={currency:ne.data[n].selectedCurrency,action:n.toLowerCase(),method:e};window.PaymentsAPI.buildPaymentPlan(a.currency,a.action,a.method,e.identifier,K).then(function(e){return window.PaymentsAPI.disableSavedMethod(e,K)}).then(function(r){ne.data[n].savedPaymentMethods=ne.data[n].savedPaymentMethods.filter(function(t){return t.identifier!==e.identifier});var o=_.findWhere(ne.data[n].paymentMethods,{brand:a.method.brand,provider:a.method.provider});if(o[n+"_saved_methods"]=_.filter(o[n+"_saved_methods"],function(e){return e.identifier!==a.method.identifier}),R(o,n,a.method.identifier),ne.data[n].savedPaymentMethods.forEach(function(e){R(e,n,a.method.identifier)}),o.is_new_payment_enabled){var i={id:o.id,brand:o.brand,identifier:o[n+"_saved_methods"]&&o[n+"_saved_methods"].length?o[n+"_saved_methods"][0].identifier:null};ne.data[n].selectedMethod.identifier===e.identifier&&L(i.id,i.brand,i.identifier,!0)}else ne.data[n].paymentMethods=_.filter(ne.data[n].paymentMethods,function(e){return!(o.brand===e.brand&&o.provider===e.provider)}),ne.data[n].selectedMethod=null;t.$broadcast("paymentsDataUpdated"),l.show("frontend.payments.payment_method.remove_successful",{classes:"alert-success"})}).catch(function(e){console.error("can't remove saved method: ",e),l.show("frontend.payments.payment_method.remove_failed",{classes:"alert-danger"})})}function R(e,t,n){e[t+"_saved_methods"]=_.filter(e[t+"_saved_methods"],function(e){return e.identifier!==n})}function O(){var e=n.sessionStorage.getItem("savedGameState")&&JSON.parse(n.sessionStorage.getItem("savedGameState"));return"home"===i.current.name&&e&&e.title}function M(e,n){var r=e.currentTarget.closest("form").checkValidity(),i=ne.data.selectedTab;if(ne.data[i].errors=null,ne.data[i].commonErrors=null,r){var s=F(n);ne.data[i].loadingSubmit=!0,ne.data[i].submittedSuccessfully=!1,t.$broadcast("paymentsDataUpdated"),X=O()?{success_url:D(),failure_url:D(),pending_url:D(),support_url:"/support"}:{success_url:a.absUrl(),failure_url:a.absUrl(),pending_url:a.absUrl(),support_url:"/support"},window.PaymentsAPI.submitForm(ne.data[i].paymentPlan,s,K,X).then(function(e){switch(ne.data[i].submittedSuccessfully=!0,n=n.map(U),ne.data[i].savedPaymentMethods=[],ne.data[i].selectedMethod=null,ne.data[i].paymentPlan=null,e.mode){case"render_error":ne.data[i].commonErrors={submit_error:{}},ne.data[i].commonErrors.submit_error[e.mode]=e.error;break;case"notify":ne.data[i].commonErrors={submit_error:{}},t.mainModal.dismissAll();var a=e.message||"frontend.payments.payment_request_created";l.show(a,{classes:"alert-success"}),O()&&(window.location.href=D()),c.refreshBalance(),t.$broadcast("paymentSubmitSuccess")}ne.data[i].loadingSubmit=!1,t.$broadcast("paymentsDataUpdated")}).catch(function(e){if(e&&e.errors){var n=N(e.errors);ne.data[i].errors=n,ne.data[i].commonErrors=B(n),o(x,100)}ne.data[i].loadingSubmit=!1,t.$broadcast("paymentsDataUpdated")})}}function x(){var e=$(".modal"),t=$(".profile-form-element--error")[0]||$(".profile-payment-form__errors")[0];if(t){var n=$(t).position(),a=n?n.top:0;p.scrollUp(a,e)}}function D(){return new n.URL(a.absUrl()).origin+"/game/"+JSON.parse(window.sessionStorage.getItem("savedGameState")).title}function U(e){return e.model=null,e}function B(e){var t={},n=ne.data.selectedTab;return Object.keys(e).forEach(function(a){if(!ne.data[n].paymentPlan.fields.find(function(e){return e.field===a})){if(_.isObject(e[a])&&_.isObject(Object.keys(e[a])[0])){var r=Object.keys(e[a])[0];e[a][r]=e[a][r].message}t[a]=e[a]}}),t}function N(e){return(e.expiryYear||e.expiryMonth||e.expYear||e.expMonth)&&(e.expiry_date={}),(e.expiryYear||e.expYear)&&(e.expiry_date.expiryYear=e.expiryYear||e.expYear,delete e.expiryYear,delete e.expYear),(e.expiryMonth||e.expMonth)&&(e.expiry_date.expiryMonth=e.expiryMonth||e.expMonth,delete e.expiryMonth,delete e.expMonth),e}function F(e){var t=e.filter(function(e){return"expiry_date"!==e.field});return _.difference(e,t).forEach(function(e){t.push({field:e.month_field,model:e.model.month_field}),t.push({field:e.year_field,model:e.model.year_field})}),t=t.reduce(function(e,t){return"cascade_select"===t.type?(e.push({field:t.primary,model:t.model[t.primary]}),e.push({field:t.secondary,model:t.model[t.secondary]})):e.push(t),e},[]),t.reduce(function(e,t){return e[t.field]=t.model,e},{})}function j(e,t,n){var a=!!n;return a?_.findWhere(ne.data[ne.data.selectedTab].savedPaymentMethods,{id:e,brand:t,identifier:n}):_.findWhere(ne.data[ne.data.selectedTab].paymentMethods,{id:e,brand:t})}function G(e){var t=e;t&&!d.isAllContextFieldsFilled(t)?d.showEditByContextModal({context:t,successCallback:function(){H(e)}}):H(e)}function H(e){if(ne.data.selectedTab=e,e){var n=ne.data.selectedTab;ne.data[n].submittedSuccessfully=!1,t.$broadcast("paymentsDataUpdated")}}function z(e){e=e||{};var n=angular.copy(t.data.user);e.hardReload?t.$broadcast("fetchBonusPreview",n):t.$broadcast("refreshBonusPreview",n)}function W(e){if(g.data.limitsExistence.coolingoff){var t=u.instant("profiles.show.payments.alert_enabled_coolingoff");l.show(t,{classes:"alert-warning"}),setTimeout(function(){return location.replace("/profile/limits")},1500)}else{var n=e.selectedTab;d.isAllContextFieldsFilled(n)?Y(e):d.showEditByContextModal({context:n,successCallback:function(){Y(e)}})}}function Y(e){function a(e){n.sessionStorage.removeItem("savedGameState")}e=e||{},e.template=e.template||"main",e.reject_terms&&(J=!0,ne.data.deposit.available=!1),t.mainModal.modal=r.open({template:'<payments-tabs template="'+e.template+'"selected-tab="$ctrl.selectedTab"selected-currency="$ctrl.selectedCurrency"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></payments-tabs>',controller:function(){var t=this;t.selectedTab=e.selectedTab,t.selectedCurrency=e.selectedCurrency},windowClass:"modal-payments",controllerAs:"$ctrl",backdrop:!s.DISABLE_CLOSE_DEPOSIT_MODAL||"static"}),t.mainModal.modal.result.then(function(){a(e)},function(){a(e)})}var V,q={balances:[],deposit:{selectedCurrency:t.data.user.currency,paymentMethods:null,savedPaymentMethods:[],selectedMethod:null,paymentPlan:null,loadingPaymentMethods:!1,loadingPaymentPlan:!1,loadingSubmit:!1,errors:null,commonErrors:null,submittedSuccessfully:!0,available:!0},cashout:{selectedCurrency:t.data.user.currency,paymentMethods:null,savedPaymentMethods:[],selectedMethod:null,paymentPlan:null,loadingPaymentMethods:!1,loadingPaymentPlan:!1,loadingSubmit:!1,errors:null,commonErrors:null,submittedSuccessfully:!1,available:!0},selectedTab:!1},K={},J=!1,X={success_url:"/my-accounts/history",failure_url:"/my-accounts/history",pending_url:"/my-accounts/history",support_url:"/support"},Z=2e3,Q=5,ee=Q;t.$on("balanceRefreshSuccess",A),t.$on("authLoginSuccess",C),t.$on("authLogoutSuccess",C),t.$on("userCurrencyChangedSuccessfully",function(){I()});var te=_.throttle(y,1e3),ne={data:q,onSelectAccount:I,onSelectPaymentMethod:L,onDisableSavedMethod:k,onSubmit:M,changeTab:G,showPaymentsModal:W};return function(){e.load([(s.DOMAIN||"")+"/javascripts/payment_methods.js?timestamp="+Date.now()]).then(function(){function e(e){"devcode_exit"===e.data.type&&e.origin===window.location.origin&&(angular.element(document.querySelector("#"+e.data.popupId)).remove(),t.mainModal.close(),O()&&(window.location.href=D()),c.refreshBalance(),h.clear(),t.$broadcast("paymentSubmitSuccess"),t.$broadcast("getFlashMessages"))}K={apiGet:function(e){return PaymentsAPI.defaultRequester.apiGet(s.DOMAIN+e)},apiPost:function(e,t){return PaymentsAPI.defaultRequester.apiPost(s.DOMAIN+e,t)},apiPut:function(e,t){return PaymentsAPI.defaultRequester.apiPut(s.DOMAIN+e,t)},redirect:PaymentsAPI.defaultRequester.redirect},ne.data.balances||c.refreshBalance(),window.addEventListener("message",e,!1),t.$broadcast("PaymentsAPILoadedSuccessfully")})}(),ne}e.$inject=["$ocLazyLoad","$rootScope","$window","$location","$modal","$timeout","$state","SYSTEM","Balance","$translate","Notification","ProfileEditService","Lottery","PAYMENTS_CONTANTS","ScrollUpService","LimitsService","DepositBonusCode"],angular.module("casino.services").factory("Payments",e)}(),function(){function e(e,t){function n(e,t){r.payment&&t&&r.payment.id===t.id&&(r.payment=t)}function a(e){t.recallById(e)}var r=this;r.recallById=a,e.$on("playerPaymentsRefreshSuccess",n),function(){t.refresh()}()}e.$inject=["$rootScope","PlayerPaymentsService"],angular.module("casino").component("casinoPendingCashout",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/PendingCashout/_"+(t.template||"main")+".html"}],controller:e,bindings:{payment:"<"}})}(),function(){function e(e,t){return e(t.URL_API+"/player/groups/:action",{},{edit:{method:"POST",params:{action:null}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("PlayerGroupsResource",e)}(),function(){function e(e,t,n){function a(a){var r=t.defer();return n.edit(a).$promise.then(function(){return e.$broadcast("userGroupsUpdated"),r.resolve()}).catch()}return{edit:a}}e.$inject=["$rootScope","$q","PlayerGroupsResource"],angular.module("casino.services").factory("PlayerGroups",e)}(),function(){function e(e,t){return e(t.URL_API+"/player/payments/:id/:action",{},{getAll:{method:"GET",params:{currency:null},isArray:!0},recallById:{method:"POST",params:{id:"@id",action:"recall"}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("PlayerPaymentsResource",e)}(),function(){function e(e,t,n){function a(){e.data.user&&e.data.user.email&&(r(),m||(n.subscribe("payments_changes#",function(e){c(e.data)}),m=!0))}function r(){t.getAll(o)}function o(t){if(e.Info.currencies)f.payments=t.filter(u).map(s).map(l),e.$broadcast("playerPaymentsInited",f.payments);else var n=e.$on("currenciesUpdated",function(){f.payments=t.filter(u).map(s).map(l),e.$broadcast("playerPaymentsInited",f.payments),n()})}function i(n){return t.recallById({id:n}).$promise.then(function(){r(),e.$broadcast("balanceRefresh")})}function s(e){var t="";return t=e.finished_at?e.success?"success":"failure":"pending",e.status=t,e}function c(t){var n=f.payments.find(function(e){return e.id===t.id});t=[t].map(s).map(l)[0],n?_.assign(n,t):(f.payments.push(t),e.$broadcast("newPaymentAdded",t)),e.$broadcast("playerPaymentsRefreshSuccess",t)}function u(t){return!!e.Info.currencies.find(function(e){return e.code===t.currency})}function l(e){return e.diff=(new Date).getTime()-new Date(e.created_at).getTime(),e}function d(){f.payments=[],m=!1}var f={payments:[]},m=!1;return e.$on("playerPaymentsRefresh",r),e.$on("authLoginSuccess",a),e.$on("authLogoutSuccess",d),a(),{data:f,refresh:r,recallById:i}}e.$inject=["$rootScope","PlayerPaymentsResource","RealTime"],angular.module("casino.services").factory("PlayerPaymentsService",e)}(),function(){function e(e,t){function n(){c.phoneInfo=t.data.phoneInfo,c.errors=t.data.errors,c.service=t.data.service}function a(e){t.add(e).then(function(){c.phone=null,c.code=null})}function r(){t.remove().then(function(){c.phone=null,c.code=null})}function o(){t.resend().then(function(){})}function i(e){t.confirm(e).then(function(){})}function s(){t.refresh()}var c=this;c.phoneInfo=null,c.phone=null,c.code=null,c.errors=null,c.add=a,c.remove=r,c.resend=o,c.confirm=i,c.onTimeoutEnd=s,e.$on("playerPhoneDataUpdated",n),n()}e.$inject=["$rootScope","PlayerPhone"],angular.module("casino").component("playerPhone",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/PlayerPhone/_"+(t.template||"main")+".html"}],bindings:{},controller:e})}(),function(){function e(e,t){return e(t.URL_API+"/player/phone/:action",{},{get:{method:"GET",params:{action:null},isArray:!0},add:{method:"POST",params:{action:null}},remove:{method:"DELETE",params:{action:null}},confirm:{method:"POST",params:{action:"confirm"}},resend:{method:"POST",params:{action:"resend_verification_code"}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("PlayerPhoneResource",e)}(),function(){function e(e,t,n,a,r){function o(){n.player_fields().$promise.then(function(e){var t=_.findWhere(e.fields,{field:"mobile_phone"});t&&t.service&&(g.available=!0,g.data.service=t.service,i())})}function i(){var n=t.defer();return r.get().$promise.then(function(t){return g.data.errors=null,g.data.phoneInfo=t[0],g.data.phoneInfo&&(t[0].resend_timeout_until?new Date(t[0].resend_timeout_until)-Date.now()<500?g.data.phoneInfo.resend_status=p.RESEND_AVAILABLE:g.data.phoneInfo.resend_status=p.RESEND_UNAVAILABLE:g.data.phoneInfo.sms_limit_reached?g.data.phoneInfo.resend_status=p.LAST_TIME:g.data.phoneInfo.resend_status=p.FIRST_TIME),a.fetchUser().then(function(){e.$broadcast("playerPhoneDataUpdated")}),n.resolve(t),n.promise}).catch()}function s(e){var t={phone:{number:e}};return r.add(t).$promise.then(i).catch(d)}function c(){return r.remove().$promise.then(i).catch(d)}function u(){var e,n=t.defer();return r.resend().$promise.then(function(t){return e=t,n.resolve(t),n.promise}).then(i).then(function(){e.errors&&d({errors:e.errors})}).catch(d)}function l(e){var t={phone:{code:e}};return r.confirm(t).$promise.then(i).catch(d)}function d(n){g.data.errors=n.data&&n.data.errors||n,e.$broadcast("playerPhoneDataUpdated");var a=t.defer();return a.reject(g.data.errors),a.promise}function f(){m={phoneInfo:null,service:null,errors:null},e.$broadcast("playerPhoneDataUpdated")}var m={phoneInfo:null,service:null,errors:null},p={FIRST_TIME:"FIRST_TIME",RESEND_AVAILABLE:"RESEND_AVAILABLE",RESEND_UNAVAILABLE:"RESEND_UNAVAILABLE",LAST_TIME:"LAST_TIME"},g={available:!1,data:m,refresh:i,add:s,remove:c,resend:u,confirm:l};return e.$on("userFieldsUpdated",i),e.$on("authLoginSuccess",o),e.$on("authLogoutSuccess",f),o(),g}e.$inject=["$rootScope","$q","Info","Auth","PlayerPhoneResource"],angular.module("casino.services").factory("PlayerPhone",e)}(),CasinoServices.factory("Prizes",["$resource","SYSTEM",function(e,t){e(t.URL_API+"/prizes/:id/:action",{},{list:{method:"get",params:{action:null,id:null},isArray:!0},notify:{method:"get",params:{action:"notify_user"}}});return{}}]),function(){function e(e,t,n,a){function r(){l.allFieldsAreFilled=n.isAllContextFieldsFilled(l.context),l.registration=n.data;var e=n.getFieldsByContext(l.context).filter(function(e){return"checkbox"!==e.localData.type}),t=n.getFieldsByContext(l.context).filter(function(e){return"checkbox"===e.localData.type}),a=parseInt(l.checkboxAfter)===l.checkboxAfter?l.checkboxAfter:n.data.editableContexts[l.context].columns;n.data.editableContexts[l.context].editableRegistrationFields=angular.copy(n.getFieldsColumn(e,n.data.editableContexts[l.context].columns)),l.registrationFieldsCheckbox=n.getFieldsColumn(t,a)}function o(){var t={};n.data.editableContexts[l.context].editableRegistrationFields.forEach(function(e){t=e.reduce(function(e,t){return null!==t.model&&void 0!==t.model&&(e[t.field]=t.model,"date_of_birth"===t.field&&c(t.model)&&(e[t.field]=t.model.getFullYear()+"-"+(t.model.getMonth()+1)+"-"+t.model.getDate())),e},t)});var r={context:l.context,player:t};n.constructErrorsObject(l.context),u()||n.patch(r).then(a.fetchUser).then(function(){n.updateModels(),e.$broadcast("authCheckUser"),e.$broadcast("userFieldsUpdated",{context:l.context}),n.data.editableContexts[l.context].isEditMode=!1,n.data.editableContexts[l.context].errors=[],l.successCallback(),l.close()}).catch(function(e){n.data.editableContexts[l.context].errors=e.data.errors,422!==e.status&&500!==e.status||"edition"===l.context||(n.data.editableContexts[l.context].isPatchError=!0,n.data.editableContexts[l.context].isRequiredFieldsEmpty=n.getFieldsByContext(l.context).some(function(e){return!e.model}))})}function i(){n.data.editableContexts[l.context].isEditMode=!0}function s(){n.data.editableContexts[l.context].isEditMode=!1,n.data.editableContexts[l.context].errors=[],r()}function c(e){return e instanceof Date&&!isNaN(e.valueOf())}function u(){return Boolean(Object.keys(n.data.editableContexts[l.context].errors).length)}var l=this;l.ProfileEditService=n,l.context=l.context||"edition",l.successCallback=l.successCallback||function(){},n.data.editableContexts[l.context]=n.data.editableContexts[l.context]||{},n.data.editableContexts[l.context].isEditMode=l.isEditMode||n.data.editableContexts[l.context].isEditMode||!1,n.data.editableContexts[l.context].columns=l.columns||n.data.editableContexts[l.context].columns||1,l.submit=o,l.edit=i,l.cancelEdition=s,e.$on("ProfileInfoRefreshSuccess",r),e.$on("profileFieldInited",r),r()}e.$inject=["$rootScope","$state","ProfileEditService","Auth"],angular.module("casino").component("casinoProfileEdit",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Profile-edit/_"+(t.template||"main")+".html"}],bindings:{columns:"<",checkboxAfter:"@",context:"<",successCallback:"&",isEditMode:"<",close:"&",dismiss:"&"},controller:e})}(),function(){function e(e,t,n,a,r,o,i,s,c){function u(){f(),o.player_fields().$promise.then(function(t){A.contexts=t.contexts,A.fields=h(t.fields),A.fields=A.fields.map(d),A.fields=l(A.fields),e.$broadcast("ProfileInfoRefreshSuccess",A.fields)})}function l(e){return e.map(function(e){if(e.validation=_.clone(e.localData.validation)||[],e.length){var t=e.validation.find(function(e){return"min_length"===e.type});e.length.minimum&&(t?t.value=e.length.minimum:(t={type:"min_length",value:e.length.minimum},e.validation.push(t)));var n=e.validation.find(function(e){return"max_length"===e.type});e.length.maximum&&(n?n.value=e.length.maximum:(n={type:"max_length",value:e.length.maximum},e.validation.push(n)))}}),e}function d(t){return t.model=e.data.user[t.field],t}function f(){A.fields=A.fields.map(d)}function m(e){var t=[];if(e&&"edition"!==e){var n=L.data.fields.filter(function(t){return L.data.contexts[e]&&L.data.contexts[e].indexOf(t.field)>-1});t=angular.copy(n),t.map(function(e){return e.required=!0,e})}else t=A.fields;return t.filter(function(e){return!(T.indexOf(e.field)>-1)})}function p(e,t){var n=-1,a=Math.ceil(e.length/t),r=[];return e.forEach(function(e,t){t%a==0&&(n++,r[n]=[]),r[n].push(e)}),r}function g(e){return i.patch(e).$promise}function h(e){var t=e.map(function(e){return I[e.field]?e.localData=I[e.field]:(e.localData={field:e.field,type:"text"},console.error("Unknown '"+e.field+"' field in REGISTRATION constant.")),e.scope=e.localData.scope,e.name=e.field,e=y(e)}),n=v(t);return _.sortBy(n,"localData.order")}function y(n){var o=function(){var t=e.Info.currencies,n={};return t&&Object.keys(t).forEach(function(e){r.isRestricted("currency",t[e].code)||"FUN"===t[e].code||(n[t[e].code]=t[e].code)}),n},i=function(){return{m:t.instant("common.genders.m"),f:t.instant("common.genders.f")}},s=function(){var t=e.Info.locales,n={};return t&&Object.keys(t).forEach(function(e){n[t[e]]=t[e].name_in_locale}),n},c=function(){var t=e.Info.time_zones,n={};return t&&Object.keys(t).forEach(function(e){n[t[e].code]=t[e].name}),n},u=function(){var t=e.Info.countries,n={};return t&&Object.keys(t).forEach(function(e){n[t[e].code]=t[e].name}),n};switch(n.field){case"gender":n.inclusion={},n.inclusion.in=i(),e.$on("$translateChangeSuccess",function(){n.inclusion.in=i(),e.$broadcast("profileFieldInited")});break;case"currency":n.inclusion={},n.inclusion.in=o(),e.$watch("Info.currencies",function(){n.inclusion.in=o(),e.$broadcast("profileFieldInited")},!0);break;case"language":n.inclusion={},n.inclusion.in=s(),e.$on("$translateChangeSuccess",function(){n.inclusion.in=s(),e.$broadcast("profileFieldInited")},!0);break;case"time_zone":n.inclusion={},n.inclusion.in=c(),e.$watch("Info.time_zones",function(){n.inclusion.in=c(),e.$broadcast("profileFieldInited")},!0);break;case"mobile_phone":case"phone":n.inclusion={},n.inclusion.in=e.Info.country_codes||{},n.localData.default=e.data.current_ip&&n.inclusion.in[e.data.current_ip.country_code],e.$watch("Info.country_codes",function(){e.$broadcast("profileFieldInited"),n.inclusion.in=e.Info.country_codes||{},e.data.current_ip&&n.inclusion.in[e.data.current_ip.country_code]&&(n.localData.default=n.inclusion.in[e.data.current_ip.country_code],n.onDefaulValueChange&&a(n.onDefaulValueChange,1))},!0);break;case"country":case"nationality":n.inclusion={},n.inclusion.in=u(),e.data.current_ip&&n.inclusion.in[e.data.current_ip.country_code]&&(n.localData.default=e.data.current_ip.country_code),e.$watch("Info.countries",function(){e.$broadcast("profileFieldInited"),n.inclusion.in=u(),e.data.current_ip&&n.inclusion.in[e.data.current_ip.country_code]&&(n.localData.default=e.data.current_ip.country_code,n.onDefaulValueChange&&a(n.onDefaulValueChange,1))},!0)}return n}function v(e){var t=_.filter(I,function(t){var n=!1;return t.parents&&(n=_.every(t.parents,function(t){return _.find(e,function(e){return e.field===t})})),n});return t=t.map(function(t){return t.localData=_.clone(t),t.name=t.field,t.localData.parents=t.parents.map(function(t){return _.find(e,function(e){return e.field===t})}),e=_.reject(e,function(e){return t.parents.indexOf(e.field)>-1}),t}),e=e.concat(t)}function b(e){return m(e).every(function(e){return null!==e.model&&void 0!==e.model&&""!==e.model})}function $(e){L.data.editableContexts[e].errors={};var t=[];L.data.editableContexts[e].editableRegistrationFields.forEach(function(e){t=t.concat(e)}),t.forEach(function(n){var a={input:n.model,conditions:n.validation,fieldsData:t},r=c.checkAll(a);r&&(L.data.editableContexts[e].errors[n.field]=r)})}function S(){f(),e.$broadcast("ProfileInfoRefreshSuccess",A.fields)}function w(){A.fields=[],e.$broadcast("ProfileInfoRefreshSuccess",A.fields)}function C(t){t=t||{},t.template=t.template||"edit-by-context",t.context=t.context||"edition",t.isEditMode=t.isEditMode||!0,t.columns=t.columns||1,t.successCallback=t.successCallback||function(){},e.mainModal.modal=n.open({template:'<casino-profile-edit template="'+t.template+'"success-callback="$ctrl.successCallback()"context="$ctrl.context" is-edit-mode="$ctrl.isEditMode" columns="$ctrl.columns" resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></casino-profile-edit>',controller:function(){this.context=t.context,this.isEditMode=t.isEditMode,this.columns=t.columns,this.successCallback=t.successCallback},windowClass:"modal-profile-edit",controllerAs:"$ctrl"})}var A={fields:[],contexts:[],editableContexts:{edition:{errors:{},isEditMode:null,editableRegistrationFields:[],columns:null,isPatchError:!1,isRequiredFieldsEmpty:null},netent:{isEditMode:null,editableRegistrationFields:[],columns:null,isPatchError:!1,isRequiredFieldsEmpty:null}}};if(e.$on("ProfileInfoRefresh",u),e.$on("authLoginSuccess",u),e.$on("authLogoutSuccess",w),e.$on("playerPhoneDataUpdated",S),e.currentLocale)u();else var E=e.$on("localeChanged",function(){u(),E()});var I=function(){var e={};return s.forEach(function(t,n){t.order=n,e[t.field]=t}),e}(),T=["email","password","password_confirmation","bonus_code","currency","captcha"],L={data:A,patch:g,getFieldsColumn:p,getFieldsByContext:m,showEditByContextModal:C,isAllContextFieldsFilled:b,constructErrorsObject:$,updateModels:f};return L}e.$inject=["$rootScope","$translate","$modal","$timeout","Restrictions","Info","Player","REGISTRATION","FormValidation"],angular.module("casino.services").factory("ProfileEditService",e)}(),CasinoControllers.controller("RealityCheckCtrl",["modal_data",function(e){this.data=e}]),function(){function e(e,t,n,a){function r(){n.reality_check(function(e){i(o(e))})}function o(e){var t={win:{},lost:{},wager_sum:e.wager_sum,period:e.period};return t.period.time=new Date(e.period.to).getTime()-new Date(e.period.from).getTime(),_.map(e.activity_sum,function(e,n){e<=0&&(t.lost[n]=-1*e),e>=0&&(t.win[n]=e)}),t}function i(n){e.mainModal.close(),e.mainModal.modal=t.open({templateUrl:"/app/Users/RealityCheck/_modal.html",windowClass:"modal-reality",backdrop:"static",controller:"RealityCheckCtrl",keyboard:!1,controllerAs:"$ctrl",resolve:{modal_data:function(){return n}}})}return e.$on("realityCheckTriggered",r),{getActivity:r,showModal:i}}e.$inject=["$rootScope","$modal","Player","GameLimitsService"],angular.module("casino.services").factory("RealityCheckService",e)}(),function(){function e(e,t){return e(t.URL_API+"/player/sessions/:id/:state",{},{get:{method:"GET",isArray:!0},getClosed:{method:"GET",isArray:!0,params:{state:"closed"}},closeById:{method:"DELETE",params:{id:"@id"}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("PlayerSessionsResource",e)}(),function(){function e(e,n){function a(){o.status===t.ACTIVE?o.sessions=n.data.sessions:o.sessions=n.data.closedSessions}function r(e){n.closeById(e).then(function(){})}var o=this;o.status=o.status||t.ACTIVE,o.closeById=r,e.$on("sessionsRefreshSuccess",a),a()}e.$inject=["$rootScope","SessionsService"],angular.module("casino").component("casinoSessions",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Sessions/_"+(t.template||"main")+".html"}],controller:e,bindings:{status:"@"}}),angular.module("casino").controller("SessionsCtrl",e);var t={CLOSED:"closed",ACTIVE:"active"}}(),function(){function e(e,t,n){function a(){o()}function r(e){return n.closeById({id:e}).$promise.then(o)}function o(){t.all({activeSessions:n.get().$promise,closedSessions:n.getClosed().$promise}).then(i)}function i(t){c.sessions=t.activeSessions,c.closedSessions=t.closedSessions,e.$broadcast("sessionsRefreshSuccess",c.sessions)}function s(){i({activeSessions:[],closedSessions:[]})}var c={sessions:[],closedSessions:[]};return e.$on("authLoginSuccess",a),e.$on("authLogoutSuccess",s),a(),{data:c,closeById:r}}e.$inject=["$rootScope","$q","PlayerSessionsResource"],angular.module("casino.services").factory("SessionsService",e)}(),function(){function e(e,t,n){function a(){r()}function r(){n.STATUSES&&n.STATUSES.SHOW_CHANGE_STATUS_WINDOW&&(e.mainModal.close(),e.mainModal.modal=t.open({template:'<casino-statuses template="congrats-modal"></casino-statuses>',windowClass:"modal-congrats"}))}function o(){}return e.$on("statusChanged",a),{openStatusPage:o}}e.$inject=["$rootScope","$modal","SYSTEM"],angular.module("casino.services").factory("StatusActionsService",e)}(),function(){function e(e){this.statuses=e}e.$inject=["StatusesService"],angular.module("casino").component("casinoStatuses",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Statuses/_"+(t.template||"main")+".html"}],controller:e}),angular.module("casino").controller("StatusesController",e)}(),function(){function e(e,n,a,r,o,i,s){function c(){l().then(function(){e.user.data.email?u():e.$on("authLoginSuccess",function(e,t){u()})})}function u(){$=e.user.data.statuses,r.data.persistent&&d(r.data.persistent.points),e.$on("compointsUpdated",function(){e.data.user.email&&r.data.persistent&&d(r.data.persistent.points)}),e.$on("authLogoutSuccess",function(){w.current=null,w.next=null,w.progress={percent:0}})}function l(){return n.all({allGroups:o.statuses().$promise,statuses:i.status_groups().$promise}).then(function(e){return w.list=e.allGroups,w.statuses=e.statuses.map(y),A.available=!!w.statuses.length,w.statuses=w.statuses.sort(m),Promise.resolve(e)})}function d(t){if(w.statuses.length)if(S.current=g(t),S.next=void 0,S.progress.percent=0,S.current){var n=Number(S.current.conditions.persistent_comp_points.max),a=Number(S.current.conditions.persistent_comp_points.min);null===C&&(C=S.current.id),n&&(S.next=g(n+1)),S.next&&(S.progress.percent=Math.floor(100/(n-a)*(t-a))),w.statuses.map(p),w.current||_.assign(w,S),$&&!$.some(f)&&(_.assign(w,S),C!=w.current.id&&(C=w.current.id,e.$broadcast("statusChanged",w),e.$broadcast("authCheckUser")))}else null===C&&(C=!1),S.next=w.statuses[0],t&&(S.progress.percent=Math.floor(100/S.next.conditions.persistent_comp_points.min*t)),w.statuses.map(p),_.assign(w,S)}function f(e){return S.current.id===e.id}function m(e,t){return Number(e.conditions.persistent_comp_points.min)<Number(t.conditions.persistent_comp_points.min)?-1:Number(e.conditions.persistent_comp_points.min)>Number(t.conditions.persistent_comp_points.min)?1:0}function p(e){var n=null,a=S.current||{conditions:{persistent_comp_points:{}}},r=S.next||{conditions:{persistent_comp_points:{}}};switch(!0){case e.id===a.id:n=t.CURRENT;break;case e.id===r.id:n=t.NEXT;break;case Number(e.conditions.persistent_comp_points.max)<Number(a.conditions.persistent_comp_points.max)&&"min"!=e.conditions.persistent_comp_points.type:case"range"===e.conditions.persistent_comp_points.type&&"min"===a.conditions.persistent_comp_points.type:n=t.PASSED;break;case Number(e.conditions.persistent_comp_points.min)>Number(r.conditions.persistent_comp_points.min)&&"max"!=e.conditions.persistent_comp_points.type:n=t.FUTURE}return e.state=n,e}function g(e){return _.find(w.statuses,function(t){return h(e,t.conditions.persistent_comp_points)})||null}function h(e,t){t.min=Number(t.min),t.max=Number(t.max);var n;switch(t.type){case"range":n=t.exclude_end?e>=t.min&&e<t.max:e>=t.min&&e<=t.max;break;case"min":n=e>=t.min;break;case"max":n=t.exclude_end?e<t.max:e<=t.max}return n}function y(e){var t={};return e.conditions.forEach(function(e){Object.keys(e).forEach(function(n){t[n]=e[n]})}),e.conditions=t,e}function v(e){return w.list.find(function(t){return t.id===e})}function b(e){var t=_.findWhere(w.statuses,{id:e});return!t||t.writable}var $,S={progress:{}},w={current:null,next:null,progress:{percent:0},statuses:[],list:[]},C=null,A={data:w,getById:v,isWritableById:b};if(e.currentLocale)c();else var E=e.$on("localeChanged",function(){c(),E()});return A}e.$inject=["$rootScope","$q","SYSTEM","Compoints","Info","Player","StatusActionsService"];var t={CURRENT:"current",PASSED:"passed",NEXT:"next",FUTURE:"future"};angular.module("casino.services").factory("StatusesService",e)}(),function(){function e(e,t,n){function a(){s.editableFields=angular.copy(n.data.fields),s.editableFields=s.editableFields.map(function(e){return e.localData.input_dentifier=Math.random(),e})}function r(){var t={};e(function(){t=s.editableFields.reduce(function(e,t){return null!==t.model&&void 0!==t.model&&(e[t.field]=t.model),e},t),n.updateSubscriptions(t,s.token).then(function(){s.close(),s.isEditMode=c})},0)}function o(){s.isEditMode=!0}function i(){s.isEditMode=!1,a()}var s=this,c=!angular.isDefined(s.isEditMode)||s.isEditMode;s.initialIsEditMode=c,s.isEditMode=c,s.autosubmit=s.isAutosubmit?r:function(){},s.edit=o,s.cancelEdition=i,s.submit=r,s.showSubscriptionsModal=n.showSubscriptionsModal,t.$on("profileFieldsRefreshSuccess",a),a()}e.$inject=["$timeout","$rootScope","SubscriptionsService"],angular.module("casino").component("casinoSubscriptions",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Subscriptions/_"+(t.template||"main")+".html"}],bindings:{isAutosubmit:"<",isEditMode:"<",token:"@",close:"&",dismiss:"&"},controller:e}),angular.module("casino").controller("SubscriptionsCtrl",e)}(),function(){function e(e,t){return e(t.URL_API+"/subscriptions",{},{get:{method:"GET",params:{},isArray:!1},update:{method:"PUT",params:{}}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("SubscriptionsResource",e)}(),function(){function e(e,t,n,a){function r(t){return c(t).then(function(){n.player_fields().$promise.then(function(t){f.fields=t.fields.filter(function(e){return p.indexOf(e.field)>-1}),f.fields=f.fields.map(function(e){return e.localData={type:"checkbox"},e}),f.fields=f.fields.map(o).map(i),e.$broadcast("profileFieldsRefreshSuccess")})})}function o(e){return e.model=m[e.field],e}function i(e){return e.required=!1,e}function s(e,t){var n={subscription_params:e};return t&&(n.subscription_token=t),a.update(n).$promise.then(function(){return r()})}function c(e){return a.get({subscription_token:e}).$promise.then(function(e){m.receive_newsletters=e.receive_newsletters,m.receive_promos=e.receive_promos,m.receive_sms_promos=e.receive_sms_promos})}function u(e){
r(e).then(function(){d({token:e})})}function l(){f.fields=[]}function d(n){n=n||{},n.template=n.template||"subscriptions-modal",e.mainModal.modal=t.open({template:'<casino-subscriptions token="'+n.token+'"template="'+n.template+'"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></casino-subscriptions>',controller:function(){},windowClass:"modal-subscriptions-edit",controllerAs:"$ctrl"})}var f={fields:[],errors:{}},m={receive_newsletters:null,receive_promos:null,receive_sms_promos:null},p=["receive_newsletters","receive_promos","receive_sms_promos"],g={data:f,updateSubscriptions:s,onRecieveSubscriptionToken:u,showSubscriptionsModal:d,getSubcriptions:c};return e.$on("authLoginSuccess",r),e.$on("authLogoutSuccess",l),r(),g}e.$inject=["$rootScope","$modal","Info","SubscriptionsResource"],angular.module("casino.services").factory("SubscriptionsService",e)}(),function(){function e(e,t){return e(t.URL_API+"/tournaments/:id/:action",{},{list:{method:"get",params:{action:null,id:null},isArray:!0},byId:{method:"get",params:{action:null}},statuses:{method:"get",params:{action:"statuses",id:null},isArray:!0},statusById:{method:"get",params:{action:"status",id:null}},confirm:{method:"post",params:{action:"confirm",id:"@id"}},recent:{method:"get",params:{action:"recent",id:null},isArray:!0}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("TournamentsResource",e)}(),function(){function e(e,t){var n={},a={},r={},o={},i=!1,s=!1,c=function(e){return n[e.id]?n[e.id].constructor(e):n[e.id]=new f(e),n[e.id]},u=function(){return t.list(function(t){t.forEach(c),e.$broadcast("tournamentsUpdated",n),s=!0,t.length&&(e.data.user.email&&l(),i||(i=!0,e.$on("authLoginSuccess",function(e,t){l()}),e.$on("authLogoutSuccess",function(e,t){d()})));for(var a in n)n[a].data.empty&&n[a].update()}).$promise},l=function(){return t.statuses(function(t){for(var a=0;a<t.length;a++)n[t[a].tournament_id]&&n[t[a].tournament_id].addUserStatus(t[a]);e.$broadcast("tournamentsStatusesUpdated",t)}).$promise},d=function(){o={}},f=function(e){e=this.preparePrizes(e),e=this.prepareWinners(e),e.frontend_identifier&&!a[e.frontend_identifier]&&(a[e.frontend_identifier]=e.id),e.in_progress&&(r[e.frontend_identifier]=e.id),e.main_budget=+e.money_budget||+e.chargeable_comp_points_budget||+e.persistent_comp_points_budget,this.data=e,this.setStatus(),this.setTimer()};f.prototype.preparePrizes=function(t){return t.prizes&&t.prizes.forEach(function(n){if(n.money=parseFloat(n.money_award),n.available=[],n.money_budget_percent){var a=e.Info.currencies.find(function(e){return e.code===t.currency});n.money+=Math.floor(t.money_budget/100*n.money_budget_percent*a.subunits_to_unit)/a.subunits_to_unit}n.money&&(n.money+=" "+t.currency),n.chargeable_comp_points_percent&&(n.chargeable_comp_points=parseInt(n.chargeable_comp_points+t.chargeable_comp_points_budget/100*n.chargeable_comp_points_percent)),n.persistent_comp_points_percent&&(n.persistent_comp_points=parseInt(n.persistent_comp_points+t.persistent_comp_points_budget/100*n.persistent_comp_points_percent)),n.stuff&&n.available.push({type:"stuff",value:n.stuff}),n.money&&n.available.push({type:"money",value:n.money}),n.chargeable_comp_points&&n.available.push({type:"chargeable_comp_points",value:n.chargeable_comp_points}),n.persistent_comp_points&&n.available.push({type:"persistent_comp_points_percent",value:n.persistent_comp_points}),n.freespins_count&&n.available.push({type:"freespins_count",value:n.freespins_count}),n.main=n.stuff||n.money||n.chargeable_comp_points||n.persistent_comp_points}),t},f.prototype.prepareWinners=function(e){for(var t in e.top_players)e.top_players[t].prize=e.prizes[e.top_players[t].award_place-1];return e},f.prototype.confirm=function(e){e=e||!1;var n=this;this.data.user_confirmation_required&&t.confirm({id:this.data.id,confirmed:e},function(e){n.update()})},f.prototype.update=function(){var n=this;t.byId({id:this.data.id},function(a){e.data.user.email?t.statusById({id:n.data.id},function(e){c(a).addUserStatus(e)}):c(a),n.auto_update&&n.autoUpdate()})},f.prototype.setStatus=function(){this.data.finished_at?this.data.status="closed":this.data.in_progress?this.data.status="in_progress":new Date(this.data.start_at).getTime()-(new Date).getTime()>0?this.data.status="not_started":new Date(this.data.end_at).getTime()-(new Date).getTime()>0&&(this.data.status="finished")},f.prototype.setTimer=function(){if(this.data.timer=0,this.data.finished_at)return!1;var e=this.data.start_at;this.data.in_progress&&(e=this.data.end_at),this.data.timer=new Date(e).getTime()-(new Date).getTime(),this.data.timer<=0&&(this.data.timer=0)},f.prototype.addUserStatus=function(e){var n=this,a=function(e){o[e.tournament_id]=e,n.data.user_status=o[e.tournament_id]};e?a(e):t.statusById({id:this.data.id},function(e){a(e)})},f.prototype.autoUpdate=function(e){if(e&&this.auto_update)return!1;var t=this;this.auto_update=this.auto_update||e,setTimeout(function(){t.update()},this.auto_update)},u(),function(){t.recent().$promise.then(function(t){m.ended_list_data=t,m.ended_list_by_identifier=m.ended_list_data.reduce(function(e,t){return e[t.frontend_identifier]=e[t.frontend_identifier]||[],e[t.frontend_identifier].push(t),e},{}),Object.keys(m.ended_list_by_identifier).forEach(function(e){m.ended_list_by_identifier[e]=m.ended_list_by_identifier[e].sort(function(e,t){return new Date(t.finished_at)-new Date(e.finished_at)})}),e.$broadcast("tournamentsEndedUpdated",t)})}();var m={tournaments_inited:s,list:n,identifier_list:a,in_progress_list:r,ended_list_data:[],ended_list_by_identifier:{},update_all:u,update_statuses:l,get:function(e){return e?(n[e]||(c({id:e,empty:!0}),s&&n[e].update()),n[e]):null},getByIdentifier:function(e){return m.get(m.identifier_list[e])}};return m}e.$inject=["$rootScope","TournamentsResource"],angular.module("casino.services").factory("Tournaments",e)}(),function(){function e(e){this.AntillephoneService=e,this.$onInit=function(){e.available&&e.init()}}e.$inject=["AntillephoneService"],angular.module("casino").component("externalAntillephone",{templateUrl:["$element","$attrs",function(e,t){return"/app/external/Antillephone/_"+(t.template||"main")+".html"}],controller:e})}(),function(){function e(e,t){function n(){window.APG&&t(function(){var e=document.getElementById("apg-seal-container");e&&!e.innerHTML&&APG.init()})}var a={data:{},available:!0,init:n};return e.ANTILLEPHONE&&e.ANTILLEPHONE.ID&&(function(){a.data={id:e.ANTILLEPHONE.ID,image_size:e.ANTILLEPHONE.IMAGE_SIZE||128,image_type:e.ANTILLEPHONE.IMAGE_TYPE||"basic-small"}}(),function(){var t=document.createElement("script"),r=document.getElementsByTagName("head")[0];t.type="text/javascript",t.src="https://"+e.ANTILLEPHONE.ID+".snippet.antillephone.com/apg-seal.js",t.onload=function(){n()},t.onerror=function(){a.available=!1},r.appendChild(t)}()),a}e.$inject=["SYSTEM","$timeout"],angular.module("casino.services").factory("AntillephoneService",e)}(),function(){function e(e){var t=this;t.AVAILABLE_REASONS=["bonus_bet_limit_exceeded","game_forbidden_with_bonus","session_limit_exceeded","bet_limit_exceeded"],e.setCleanTime(t.hideTime),t.GameLimits=e}e.$inject=["GameLimitsService"],angular.module("casino").component("gameLimits",{templateUrl:["$element","$attrs",function(e,t){return"/app/Game/Limits/_"+(t.template||"main")+".html"}],controller:e,bindings:{hideTime:"<"}}),angular.module("casino").controller("GameLimitsController",e)}(),function(){function e(e,t,n,a){function r(){t.data&&t.data.user.email&&!c&&(c=!0,e.subscribe("game_limits#",function(e){n(function(){"trigger_reality_check"==e.data.reason?t.$broadcast("realityCheckTriggered",e.data):o(e.data)})}))}function o(e){e.game&&(e.game_data=a.getByIdentifier(e.game)),l.last_message=e,l.list.push(e),l.show_message=!0,t.$broadcast("gameLimitsUpdated",e),"session_limit_exceeded"==e.reason&&t.$broadcast("authCheckUser"),null!==u&&n(function(){s()},u)}function i(e){e&&(u=e)}function s(){l.show_message=!1,l.last_message={}}var c=!1,u=null,l={list:[],last_message:{},show_message:!1,setCleanTime:i,hideLastMessage:s};return t.$on("authLoginSuccess",r),t.$on("authLogoutSuccess",function(){c=!1}),r(),l}e.$inject=["RealTime","$rootScope","$timeout","GamesData"],angular.module("casino.services").factory("GameLimitsService",e)}(),function(){function e(e,t){this.openModal=function(n,a){for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];t.mainModal.close(),t.mainModal=e.open({templateUrl:"/app/Game/close-sessions/close-sessions.html",windowClass:"modal-close-sessions",controllerAs:"$ctrl",controller:function(){this.gamesName=a.filter(function(e){return e.game}).map(function(e){return'"'.concat(e.game.title,'"')}).join(", "),this.closeModal=t.mainModal.close,this.closeGames=function(){t.mainModal.close(),n.apply(void 0,o)}}})}}e.$inject=["$modal","$rootScope"],angular.module("casino.services").service("CloseSessions",e)}(),CasinoFilters.filter("JackpotGames",function(){return function(e,t,n){var a=t||n;return _.filter(e,function(e){var t=!1;return e.currencies[a]&&(e.currencies[a].jackpot?t=void 0!=e.currencies[a].jackpot:e.currencies[n].jackpot&&(t=void 0!=e.currencies[n].jackpot)),t})}}),CasinoControllers.controller("durationTimer",["$scope","$element","$timeout","$window",function(e,t,n,a){e.duration=[];var r=0,o=0,i=0;n(function(){e.$parent.item.tournament.data.start_at&&(r=Date.parse(e.$parent.item.tournament.data.start_at)),e.$parent.item.tournament.data.end_at&&(o=Date.parse(e.$parent.item.tournament.data.end_at)),i=o-r,e.duration.countWeeks=Math.round(i/6048e5),e.duration.countDays=Math.round(i/864e5),console.log(e)})}]),CasinoDirectives.directive("mediaElement",["$window","$parse",function(e,t){return{restrict:"A",link:function(t,n){function a(){t.media=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}t.media=0,a(),angular.element(e).on("resize",function(e){a()})}}}]),CasinoDirectives.directive("nicescrollCustom",["$rootScope","$timeout",function(e,t){return{restrict:"A",link:function(t,n,a){var r=t.$eval(a.niceOption);if("desktop"==e.data.device){$(n).niceScroll(r)}}}}]),CasinoControllers.controller("nicescrollScroll",["$scope","$element","$timeout","$window",function(e,t,n,a){function r(){try{if(t[0].attributes["nicescroll-elem"]){var e=t[0].attributes["nicescroll-elem"].value,n=t[0].querySelectorAll("."+e);if(0!=n.length){var a=angular.element(n[0]);i=a[0].offsetLeft}}if(o.getNiceScroll()){var r=o.getNiceScroll();r[0].doScrollLeft&&r[0].doScrollLeft(i,100)}}catch(e){return!1}}var o=jQuery(t),i=0;e.$on("repeatFinish",function(e,t){o[0].contains(t[0])&&n(function(){r()}),angular.element(a).on("resize",function(){r()})})}]),CasinoDirectives.directive("repeatFinishEvent",["$rootScope","$timeout",function(e,t){return{restrict:"A",link:function(n,a,r){var o=jQuery(a).parent();!0===n.$last&&t(function(){e.$broadcast("repeatFinish",o)})}}}]),function(){function e(e){function t(){e.autoregister()}this.autoregister=t}e.$inject=["AutoregistrationService"],angular.module("casino").component("autoregistration",{templateUrl:["$element","$attrs",function(e,t){return"/app/Auth/Autoregistration/_"+(t.template||"main")+".html"}],bindings:{},controller:e}),angular.module("casino").controller("AutoregistrationCtrl",e)}(),function(){function e(e,t){return e(t.URL_API+"/autoregister/",{},{autoregister:{method:"POST"}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("AutoregistrationResource",e)}(),function(){function e(e,t,n){function a(){t.autoregister().$promise.then(function(){e.$broadcast("autoregisteredSuccessfully"),n.check()})}return{autoregister:a}}e.$inject=["$rootScope","AutoregistrationResource","Auth"],angular.module("casino.services").factory("AutoregistrationService",e)}(),CasinoDirectives.directive("casinoBalanceSelector",[function(){return{restrict:"E",replace:!0,scope:{},templateUrl:function(e,t){return"/app/Auth/BalanceSelector/_"+(t.type||"balance_selector")+".html"},controller:["$rootScope","$scope","Auth","Balance","Player","$location","$window",function(e,t,n,a){t.data=e.data,t.user=n.user,t.balances=e.data.user.balances=a.balances,e.data.userBalances=a.balances,t.changeCurrency=a.changeCurrency,e.$watch("data.user.currency",function(){e.$broadcast("balanceRefresh")}),e.$on("balanceRefreshSuccess",function(){t.balances=a.data.balances})}]}}]),function(){function e(e,t,n,a,r,o,i,s,c,u,l,d){function f(n){e.showCaptcha&&!n.data.user.captcha&&(n.data.user.captcha="blank"),r.sent_email_confirmation(n.data,function(e){u.show("devise.confirmations.send_instructions",{classes:"alert-success"}),i.go(_,{lang:t.currentLocale})},function(e){t.$broadcast("confirmationFormError"),n.data.errors=e.data.errors})}function m(){var e={};g&&g.data&&(e.confirmation_token=g.data.confirmation_token),r.email_confirmation(e,function(e){u.show("devise.confirmations.confirmed",{classes:"alert-success"}),a.check(function(e){t.$broadcast("successLoginAfterConfirmation",e),p(e)}),i.go(_,{confirmation_token:null,lang:t.currentLocale})},function(e){i.go("home",{confirmation_token:null,lang:t.currentLocale}),e.data.errors?Object.keys(e.data.errors).forEach(function(t){Object.keys(e.data.errors[t]).forEach(function(n){var a="devise.failure."+n,r=c.instant(a),o=r===a?e.data.errors[t][n]:r;u.show(o,{classes:"alert-error"})})}):Object.keys(e.data).forEach(function(t){var n="activerecord.attributes.user."+t,a=c.instant(n),r=a===n?e.data[t][0]:a+" "+e.data[t][0];u.show(r,{classes:"alert-error"})}),g.data.errors=e.data.errors})}function p(e){if(d.INCOME_ACCESS_AFF_SERVER&&""!=d.INCOME_ACCESS_AFF_SERVER&&e&&e.id){var t=document.createElement("iframe");t.style.display="none",t.src=d.INCOME_ACCESS_AFF_SERVER+"/Processing/Pixels/Registration.ashx?PlayerID="+e.id+"&mid=2",document.body.appendChild(t)}}var g={};e.confirmation=g,e.showCaptcha=!1;var h=!1,_=d.AFTER_CONFIRMATION_REDIRECT||d.AFTER_LOGIN_REDIRECT||"home";g.data={user:{},confirmation_token:s.search().confirmation_token,errors:{}},g.data.user.email="",o.settings(function(t){e.showCaptcha=!!t.recaptcha}),e.$on("cfpLoadingBar:completed",function(){s.search().confirmation_token&&!h?(h=!0,n(function(){m()},200)):"app.users_confirmation"!=i.current.name||s.search().confirmation_token||h||(h=!0,i.go("home",{lang:t.currentLocale}))}),g.submit=function(){l.key?l.captchaV3(function(e){g.data.user.captcha=e,f(g)}):f(g)}}e.$inject=["$scope","$rootScope","$timeout","Auth","User","Player","$state","$location","$translate","Notification","RecaptchaService","SYSTEM"],angular.module("casino.controllers").controller("ConfirmationController",e)}(),CasinoDirectives.directive("casinoFirstTimeLogin",[function(){return{restrict:"E",replace:!0,scope:{},controller:["$rootScope","$scope","Auth","$modal",function(e,t,n,a){var r=function(){e.mainModal.close(),e.mainModal.modal=a.open({windowTemplateUrl:"/app/Auth/FirstTimeLogin/_first_time_login-modal-template.html",templateUrl:"/app/Auth/FirstTimeLogin/_first_time_login-modal.html"})},o=$("[ng-app]").attr("ng-app"),i=angular.module(o);i.requires.includes("licenseMGA")||i.requires.includes("licenseSGA")?t.$on("SuccessConfirmationLimits",r):t.$on("successLoginAfterConfirmation",r)}]}}]),function(){function e(e,t,n,a,r,o,i){function s(n){e.showCaptcha&&!n.data.user.captcha&&(n.data.user.captcha="blank"),t.forgot_password(n.data,function(e){r.show("devise.passwords.send_instructions",{classes:"alert-success"}),a.go("home",{lang:o.currentLocale})},function(e){o.$broadcast("forgotPasswordFormError"),n.data.errors=e.data.errors})}var c={};e.forgot_password=c,e.showCaptcha=!1,n.settings(function(t){e.showCaptcha=!!t.recaptcha}),c.data={user:{email:""},errors:{}},c.submit=function(){i.key?i.captchaV3(function(e){c.data.user.captcha=e,s(c)}):s(c)}}e.$inject=["$scope","User","Player","$state","Notification","$rootScope","RecaptchaService"],angular.module("casino.controllers").controller("ForgotPassword",e)}(),function(){function e(e,t,n,a,r,o,i,s,c,u){function l(e){var t={};return Object.keys(e).filter(function(e){return"captcha"!==e}).forEach(function(n){t[n]=e[n]}),Object.keys(t).reduce(function(n,a){var r={input:e[a],conditions:[{type:"required"}],fieldsData:t},o=u.checkAll(r);return o&&(n[a]=o),n},{})}function d(s,c){s.data.user.hasOwnProperty("captcha")&&!s.data.user.captcha&&(s.data.user.captcha="");var u=l(s.data.user);if(Object.keys(u).length)return void(s.errors=u);i.login(s,function(){var e=o.AFTER_LOGIN_REDIRECT||"home";r.data.gameInPending?(r.$broadcast("openGameAfterLogin",r.data.gameInPending),delete r.data.gameInPending):("home"===t.current.name&&n["back-url"]&&(a.location.href=n["back-url"]),"app.users_sign_in"===t.current.name&&t.go(e,{lang:r.currentLocale})),r.$broadcast("authLoginFormSuccess"),r.mainModal.close(),r.errorsLoginForm="",p()},function(n){r.$broadcast("authLoginFormError");var a=n.required&&n.required.indexOf("one_time_password")>-1||n.errors&&n.errors.otp_attempt,o=n.required&&n.required.indexOf("captcha")>-1||n.errors&&n.errors.captcha,i=!(n.errors&&(n.errors.password||n.errors.email||n.errors.unauthorized));e.showOneTimePassword=!!a,e.showCaptcha=!!o,e.credentialsAreCorrect=i,(c||a||o)&&(r.errorsLoginForm=n.errors,t.go("app.users_sign_in",{lang:r.currentLocale,show2fa:!!a,showCaptcha:!!o,credentialsAreCorrect:i}))})}function f(e){if(e=e||!1,s.checkAuth("auth_actions_forbidden",!1))return!1;o.ENABLE_MULTISTEP_AUTH||(h.data.user=m(h.data.user)),c.key?c.captchaV3(function(t){h.data.user.captcha=t,d(h,e)}):d(h,e)}function m(t){return e.showOneTimePassword?(delete t.email,delete t.password,delete t.captcha):delete t.otp_attempt,t}function p(){n.show2fa=!1,n.showCaptcha=!1,n.credentialsAreCorrect=!1,e.showOneTimePassword=!1,e.showCaptcha=!1,e.credentialsAreCorrect=!1}function g(){return!i.authorize(i.accessLevels.anon)}var h=i.data;h.submit=f,h.logout=i.logout,h.errors=r.errorsLoginForm||{},e.login=h,e.user=i.user.data,e.showOneTimePassword=function(){return!!(h.errors&&h.errors.otp_attempt||n.show2fa)}(),e.showCaptcha=function(){return!!(h.errors&&h.errors.captcha||n.showCaptcha)}(),e.credentialsAreCorrect=!!n.credentialsAreCorrect,e.$close=function(){r.mainModal.close(),r.data.gameInPending&&delete r.data.gameInPending},e.$on("modal.closing",p),e.$watch("user",g,!0),g()}e.$inject=["$scope","$state","$stateParams","$window","$rootScope","SYSTEM","Auth","Restrictions","RecaptchaService","FormValidation"],angular.module("casino.controllers").controller("LoginCtrl",e)}(),function(){function e(e,t,n,a,r){n.transitionTo("home",{lang:t.currentLocale,show2fa:a.show2fa,showCaptcha:a.showCaptcha,credentialsAreCorrect:a.credentialsAreCorrect,"back-url":a["back-url"]}).finally(function(){r.showLogin()})}e.$inject=["$scope","$rootScope","$state","$stateParams","AuthModalService"],angular.module("casino.controllers").controller("SignInRedirectController",e)}(),CasinoControllers.controller("AuthModal",["$scope","$rootScope","Auth","AuthModalService",function(e,t,n,a){e.accessLevels=n.accessLevels,e.auth_modal={showLogin:a.showLogin,showRegistration:a.showRegistration},e.closeWindow=function(){t.mainModal.close()}}]),function(){function e(e,t,n,a,r){function o(r){if(a.checkAuth("auth_actions_forbidden",!1))return!1;t.mainModal.close(),t.mainModal.modal=n.open({templateUrl:"/app/Auth/Modal/_login-modal.html",windowClass:"modal-login",controller:"LoginCtrl",backdrop:!e.DISABLE_CLOSE_SIGN_IN_MODAL||"static"}),t.mainModal.modal.opened.then(c)}function i(){if(a.checkAuth("auth_actions_forbidden",!1))return!1;t.mainModal.close(),t.mainModal.modal=n.open({templateUrl:"/app/Auth/Modal/_registration-modal.html",windowClass:"modal-registration",controller:"Registration",backdrop:!e.DISABLE_CLOSE_SIGN_IN_MODAL||"static"}),t.mainModal.modal.opened.then(c)}function s(e){if(a.checkAuth("auth_actions_forbidden",!1))return!1;r.canUpdateInstantly(e)?r.updateDetails(e):(t.updateModal={close:function(){try{t.updateModal.modal&&t.updateModal.modal.close()}catch(e){}},modal:null},t.mainModal.close(),t.updateModal.modal=n.open({templateUrl:"/app/Auth/Modal/_update-modal.html",windowClass:"modal-update",controller:"UpdateCtrl",backdrop:"static",keyboard:!1,resolve:{fields:function(){return e}}}))}function c(){l?u():d=!0}function u(){setTimeout(function(){var e=document.querySelectorAll(".modal-dialog input"),t=Array.from(e).find(function(e){return(!e.value.length||"on"===e.value)&&"hidden"!==e.style.visibility});t&&t.focus()},300)}var l,d=!1,f=t.$on("siteLoaded",function(){l=!0,d&&u(),f()});return t.termsModal={close:function(){try{t.termsModal.modal&&t.termsModal.modal.close()}catch(e){}},modal:null},window.termsModal={open:function(e){var t=angular.element(document.body),a=t.scope().$root;a.$apply(function(){a.termsModal.modal=n.open({templateUrl:"/app/Auth/Modal/_terms-modal.html",controller:"TermsModal",windowClass:"modal-terms",resolve:{termsParams:function(){return e}}}),a.termsModal.modal.result.then(function(){},function(){})})}},{showLogin:o,showRegistration:i,showUpdate:s}}e.$inject=["SYSTEM","$rootScope","$modal","Restrictions","UpdateRegistrationService"],angular.module("casino.services").factory("AuthModalService",e)}(),function(){function e(e,t,n){e.close=function(){t.termsModal.close()},e.termsParams=n}e.$inject=["$scope","$rootScope","termsParams"],angular.module("casino.controllers").controller("TermsModal",e)}(),function(){function e(e,t,n){function a(){o(p.type),i()}function r(e){t.showModal(e)}function o(e){e&&t.getFormDataByType(e)}function i(){p.type&&(p.data=t.data[p.type].form_data,Object.keys(p.data).length?m=Object.keys(p.data)[0]:(m=null,o(p.type)),m&&(p.defaultCurrency=s(p.data[m].fields),p.defaultAmount=c(p.data[m].fields),p.fields=u(p.data[m].fields)),p.errors=t.data[p.type].errors)}function s(e){if(n.enabled){var t="";return e.forEach(function(e){if("currency"===e.field){var a=e.options||[];t=a.find(function(e){return e===n.defaultCurrency})}}),t}}function c(e){if(n.enabled){var t="";return e.forEach(function(e){"amount"===e.field&&(t=""===p.defaultAmount?"":n.currencies[n.defaultCurrency].default)}),t}}function u(e){return e.map(function(e){e.localData={type:e.type};var t=_.object(e.options,e.options);return e.inclusion={in:t},n.enabled&&("amount"===e.type&&(e.localData.template="pnp_amount",e.localData.listCurrencies=n.currencies,e.model=p.defaultAmount),"select"===e.type&&(e.localData.template="pnp_select",e.model=p.defaultCurrency,e.localData.changeAmount=function(e){p.defaultCurrency=e})),e})}function l(e){n.enabled&&(p.defaultCurrency=e,p.defaultAmount=n.currencies[e].default,p.fields.map(function(e){"amount"===e.type&&(e.model=p.defaultAmount)}))}function d(){var e=f(p.fields);t.submit(p.type,p.data[m].url,e)}function f(e){var t={};return t[m]=e.reduce(function(e,t){return e[t.field]=t.model||t.value,e},{}),t}var m,p=this;p.showModal=r,p.submit=d,p.$onInit=a,p.onChangeCurrency=l,p.data={},p.constantEnabled=n.enabled,e.$on("payNPlayRefreshSuccess",i)}e.$inject=["$rootScope","PayNPlayService","PAYNPLAY_CONSTANTS"],angular.module("casino").component("payNPlay",{templateUrl:["$element","$attrs",function(e,t){return"/app/Auth/PayNPlay/_"+(t.template||"main")+".html"}],controller:e,bindings:{type:"=",close:"&",dismiss:"&"}}),angular.module("casino.controllers").controller("PayNPlayCtrl",e)}(),function(){angular.module("casino.constants").constant("PAYNPLAY_CONSTANTS",{enabled:!1,defaultCurrency:"EUR",currencies:{EUR:{values:[20,40,60,80,200],default:40},USD:{values:[10,30,50,70,100],default:30}}})}(),function(){angular.module("casino.services").factory("PayNPlayResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/:system/:item",{},{get_auth_urls:{method:"get",params:{system:"pay_n_play",item:"urls"}}})}])}(),function(){function e(e,t,n,a,r,o){function i(){o.get_auth_urls().$promise.then(function(t){m.data.urls=_.assign({},m.data.urls,t),e.$broadcast("payNPlayRefreshSuccess")})}function s(n){var a=m.data.urls[n],r=Object.keys(m.data[n].form_data)[0];a&&!r&&t(a).get().$promise.then(function(t){m.data[n].form_data=t,e.$broadcast("payNPlayRefreshSuccess")})}function c(n,a,o){t(a).save(o).$promise.then(function(t){r.location.href=t.url,e.$broadcast("payNPlayRefreshSuccess")}).catch(function(t){m.data[n].errors=t.data.errors,e.$broadcast("payNPlayRefreshSuccess")})}function u(t){t=t||{},t.template=t.template||"modal",e.mainModal.modal=n.open({template:'<pay-n-play template="'+t.template+'"type="$ctrl.type"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></pay-n-play>',controller:function(){this.type=t.type},windowClass:"modal-pay-n-play",controllerAs:"$ctrl"}),e.mainModal.modal.result.then(function(){l()},function(){l()})}function l(){d()}function d(){["sign_in","sign_up"].forEach(f),e.$broadcast("payNPlayRefreshSuccess")}function f(e){m.data[e].errors={};var t=Object.keys(m.data[e].form_data)[0];t&&(m.data[e].form_data.fields=m.data[e].form_data[t].fields.map(function(e){return delete e.model,e}))}var m={showModal:u,submit:c,getFormDataByType:s,data:{urls:{},sign_in:{form_data:{},errors:{}},sign_up:{form_data:{},errors:{}}}};return e.data.user.email||i(),e.$on("authLogoutSuccess",function(){d(),i()}),m}e.$inject=["$rootScope","$resource","$modal","$sce","$window","PayNPlayResource"],angular.module("casino.services").factory("PayNPlayService",e)}(),CasinoControllers.controller("ProfileRoutes",["$scope","$rootScope","Auth","ProfileRoute",function(e,t,n,a){e.profileRoutes=a.data.routes,e.accessLevels=n.accessLevels,e.profile=a.data.routes,e.data=t.data,e.currentCurrency=t.data.user.currency;var r=t.$watch("data.user.currency",function(n,a){n!=a&&(e.currentCurrency=t.data.user.currency)});e.$on("$destroy",function(){r()})}]),CasinoServices.factory("ProfileRoute",["Info","SYSTEM","$rootScope","$q","$location","siteLanguage",function(e,t,n,a,r,o){function i(e){return e+s+"&target=_self"}var s,c=a.defer(),u={routes:{}},l=function(n){e.profile_routes({l:n},function(e){e=e.toJSON(),Object.keys(e).forEach(function(t){u.routes[t]=e[t]}),t.ENABLE_NEW_PROFILE&&(u.routes.payments="/profile/wallet/transactions",u.routes.documents="/profile/general/verification",Object.keys(u.routes.cashout).forEach(function(e){u.routes.cashout[e]="/profile/wallet/withdrawal?currency="+e.toLowerCase()}),s="?back-url="+r.absUrl(),Object.keys(u.routes).forEach(function(e){_.isObject(u.routes[e])?Object.keys(u.routes[e]).forEach(function(t){u.routes[e][t]=i(u.routes[e][t])}):u.routes[e]=i(u.routes[e])})),c.resolve(u.routes)})};return n.currentLocale&&l(n.currentLocale),n.$on("localeChanged",function(e,t){l(t)}),n.$on("$locationChangeSuccess",function(e){n.currentLocale&&l(n.currentLocale)}),{data:u,promise:c.promise}}]);CasinoControllers.controller("ResetPasswordController",["$scope","$rootScope","User","Auth","$state","$location","Notification",function(e,t,n,a,r,o,i){var s={};e.reset_password=s,s.data={user:{password:"",password_confirmation:"",reset_password_token:o.search().reset_password_token},errors:{}},o.search().reset_password_token||r.go("home",{lang:t.currentLocale}),s.submit=function(){n.reset_password(s.data,function(){i.show("devise.passwords.updated_not_active",{classes:"alert-success"}),a.check(function(){r.go("home",{reset_password_token:null,lang:t.currentLocale})})},function(e){e.data.errors.reset_password_token&&e.data.errors.reset_password_token.invalid?(i.show("doorkeeper.errors.messages.invalid_token.unknown",{classes:"alert-danger",duration:1e4}),r.go("app.users_password_new",{lang:"en"})):s.data.errors=e.data.errors})}}]),function(){function e(e){function t(t,n){if(t=t||"",t.toString().length<n)return{too_short:e("translate")("frontend.errors.messages.too_short",{value:n})}}return{validations:{min_length:t}}}e.$inject=["$filter"],angular.module("casino.services").factory("CustomFormValidation",e)}(),function(){function e(e,t){function n(e){var t;return e.conditions=e.conditions||[],d.formData=e.fieldsData,d.customFields=e.customFields,e.conditions.forEach(function(n){t||(t=p[n.type](e.input,n.value))}),t}function a(t,n){if(t=t||"",t.toString().length<n)return{too_short:e("translate")("frontend.errors.messages.too_short",{value:n})}}function r(t,n){if(t=t||"",t.toString().length>n)return{too_long:e("translate")("frontend.errors.messages.too_long",{value:n})}}function o(t){if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t))return{invalid_email:e("translate")("frontend.errors.messages.invalid_email")}}function i(t){var n=Number(t);if(!_.isNumber(n)||_.isNaN(n))return{not_a_number:e("translate")("frontend.errors.messages.not_a_number")}}function s(t){if(t&&d.formData.password&&t.toString()!==d.formData.password.toString())return{confirmation:e("translate")("frontend.errors.messages.confirmation")}}function c(t){if(!t)return{blank:e("translate")("frontend.errors.messages.blank")}}function u(t){var n=new Date(t);if(!t||"Invalid Date"===n.toString())return{invalid:e("translate")("frontend.errors.messages.invalid")}}function l(t,n){if(!new RegExp(n).test(t))return{invalid:e("translate")("frontend.errors.messages.special_symbol_required")}}var d=this,f={max_length:r,min_length:a,email:o,number:i,passwords_equality:s,required:c,date:u,special_symbol:l},m={};Object.keys(t.validations).forEach(function(e){m[e]=t.validations[e].bind(d)});var p=_.extend(f,m);return d.formData={},d.customFields={},{checkAll:n}}e.$inject=["$filter","CustomFormValidation"],angular.module("casino.services").factory("FormValidation",e)}(),CasinoControllers.controller("Registration",["$scope","REGISTRATION",function(e,t){}]),CasinoControllers.controller("SignUpRedirectController",["$scope","$rootScope","$state","AuthModalService",function(e,t,n,a){n.params.lang=t.currentLocale,n.transitionTo("home",n.params).finally(function(){a.showRegistration()})}]),function(){angular.module("casino.services").factory("AuthProvidersResource",["$resource","SYSTEM",function(e,t){return e(t.URL_API+"/auth_providers/:id/:action",{},{update_details:{method:"POST",params:{action:"update_details",id:null}},get:{method:"GET",isArray:!0},confirm:{method:"POST",params:{action:"confirm"}},disableById:{method:"DELETE",params:{id:"@id"}}})}])}(),function(){function e(e,t,n,a){function r(){s.socialProviders=t.data.socialProviders.filter(function(e){return!1!==e.social_network_account});var e=_.findWhere(s.socialProviders,{name:"telegram"});e&&(e.onClick=function(){i({provider:e})})}function o(e){t.disableById(e).then(function(){})}function i(t){t=t||{},t.template=t.template||"main",e.mainModal.modal=a.open({template:'<telegram-button template="'+t.template+'"provider="$ctrl.provider"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></telegram-button>',controller:function(){this.provider=t.provider},windowClass:"profile-modal-telegram-login",controllerAs:"$ctrl"})}var s=this;s.socialProviders=[],e.$on("socialProvidersRefreshSuccess",r),r(),s.onDisableProvider=o,s.showSocialSettingsModal=t.showSocialSettingsModal}e.$inject=["$rootScope","AuthSocialService","$window","$modal"],angular.module("casino").component("authSocial",{templateUrl:["$element","$attrs",function(e,t){return"/app/Auth/Social/_"+(t.template||"main")+".html"}],controller:e,bindings:{close:"&",dismiss:"&"}})}(),function(){function e(e,t,n,a,r){function o(){t.all({authProviders:i(),connectedProviders:s()}).then(u)}function i(){return a.auth_providers().$promise}function s(){return r.get().$promise.then(function(e){return e})}function c(e){return r.disableById({id:e}).$promise.then(o)}function u(t){t=JSON.parse(angular.toJson(t));var n=[];p=angular.copy(t.authProviders);var a=t.connectedProviders.filter(function(e){return!_.findWhere(t.authProviders,{name:e.type})});n=t.authProviders.concat(a),t.connectedProviders.forEach(function(e){
var t=n.find(function(t){return"google_oauth2"===t.name&&"google"===e.type||t.name===e.type});t&&(t.connected=!0,_.assign(t,e))}),m.socialProviders=n,e.$broadcast("socialProvidersRefreshSuccess",m.socialProviders)}function l(t){t=t||{},t.template=t.template||"social-settings",e.mainModal.modal=n.open({template:'<auth-social template="'+t.template+'"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></auth-social>',controller:function(){},windowClass:"modal-social-networks-settings",controllerAs:"$ctrl"})}function d(e){r.confirm({confirmation_token:e})}function f(){m.socialProviders=angular.copy(p),e.$broadcast("socialProvidersRefreshSuccess",m.socialProviders)}var m={socialProviders:[]},p=[];return e.$on("socialProvidersRefresh",o),e.$on("authLoginSuccess",o),e.$on("authLogoutSuccess",f),e.data&&e.data.user.email?o():i().then(function(e){u({authProviders:e,connectedProviders:[]})}),{data:m,disableById:c,showSocialSettingsModal:l,confirm:d}}e.$inject=["$rootScope","$q","$modal","Info","AuthProvidersResource"],angular.module("casino.services").factory("AuthSocialService",e)}(),CasinoDirectives.directive("casinoAuthSocial",[function(){return{restrict:"E",replace:!0,scope:{},templateUrl:function(e,t){return"/app/Auth/Social/_"+(t.template||"main")+".html"},controller:["$scope","Info",function(e,t){t.auth_providers_routes(function(t){e.auth_providers=t})}]}}]),CasinoDirectives.directive("casinoAuthTop",[function(){return{restrict:"E",replace:!0,scope:{},templateUrl:function(e,t){return"/app/Auth/Top/_"+(t.type||"authTop")+".html"},controller:["$scope","$rootScope","Auth",function(e,t,n){e.accessLevels=n.accessLevels,e.data=t.data,e.Info=t.Info,e.user=n.user,e.$on("localeChanged",function(t,n){e.currentLocale=n})}]}}]),function(){function e(e,t){function n(){i.QRImgSrc=t.data.QRImgSrc}function a(){i.hasToShowBackupCodes=!0}function r(){t.enable(i.authenticationCode).then(function(e){i.authenticationCode="",i.errors={},i.backupCodes=e.backup_codes,t.refreshData()}).catch(function(e){i.errors=e.authentication_code,i.backupCodes=[]})}function o(){t.disable(i.authenticationCode).then(function(){i.authenticationCode="",i.errors={},i.backupCodes=[],t.refreshData()}).catch(function(e){i.errors=e.authentication_code,i.backupCodes=[]})}var i=this;i.hasToShowBackupCodes=null,i.authenticationCode="",i.QRImgSrc=t.data.QRImgSrc,i.backupCodes=[],i.errors={},i.enable=r,i.disable=o,i.showTwoFactorModal=t.showTwoFactorModal,e.$on("2faInited",n),e.$on("twoFactorEnabledSuccessfully",a),t.init()}e.$inject=["$rootScope","TwoFactorAuthService"],angular.module("casino").component("twoFactorAuth",{templateUrl:["$element","$attrs",function(e,t){return"/app/Auth/TwoFactor/_"+(t.template||"main")+".html"}],bindings:{close:"&",dismiss:"&"},controller:e}),angular.module("casino").controller("TwoFactorAuthCtrl",e)}(),function(){function e(e,t){return e(t.URL_API+"/player/two_factor",{},{get:{method:"GET"},enable:{method:"POST"},disable:{method:"DELETE",paramSerializer:"$httpParamSerializerJQLike"}})}e.$inject=["$resource","SYSTEM"],angular.module("casino.services").factory("TwoFactorAuthResource",e)}(),function(){function e(e,t,n,a,r,o){function i(){e.data.user.two_factor_enabled?e.$broadcast("2faInited"):f.data.QRImgSrc||s()}function s(){o.get().$promise.then(function(e){f.data=e;var t=e.data;return n({method:"GET",url:"https://chart.googleapis.com/chart?chs=200x200&chld=M|0&cht=qr&chl="+t,cache:!1,useXDomain:!0,withCredentials:!1,responseType:"arraybuffer"})}).then(function(t){var n=a.encode(String.fromCharCode.apply(null,new Uint8Array(t.data)));f.data.QRImgSrc="data:image/png;base64,"+n,e.$broadcast("2faInited")})}function c(t){return o.enable({two_factor:{otp_secret:f.data.otp_secret,authentication_code:t}}).$promise.then(function(t){return e.$broadcast("authCheckUser"),r.show("two-factor.activated",{classes:"alert-success"}),e.$broadcast("twoFactorEnabledSuccessfully"),Promise.resolve(t)}).catch(function(e){return Promise.reject(e.data.errors)})}function u(t){return o.disable({two_factor:{authentication_code:t}}).$promise.then(function(){return e.$broadcast("authCheckUser"),r.show("two-factor.disabled",{classes:"alert-success"}),Promise.resolve()}).catch(function(e){return Promise.reject(e.data.errors)})}function l(){f.data={}}function d(n){n=n||{},n.template=n.template||"two-factor-modal",e.mainModal.modal=t.open({template:'<two-factor-auth template="'+n.template+'"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></two-factor-auth>',windowClass:"modal-two-factor",controllerAs:"$ctrl"})}var f={};return e.$on("authLogoutSuccess",l),f={data:{},init:_.throttle(i,300),refreshData:s,enable:c,disable:u,showTwoFactorModal:d}}e.$inject=["$rootScope","$modal","$http","$base64","Notification","TwoFactorAuthResource"],angular.module("casino.services").factory("TwoFactorAuthService",e)}(),function(){function e(e,t,n,a,r,o,i,s){function c(){return _.findWhere(o.data.socialProviders,{type:"pay_n_play"})}function u(){return _.findWhere(e.update.fields,{field:"email"})}function l(){c()&&u()&&(e.update.message="frontend.pay_n_play.transaction_is_in_progress")}function d(){var o=i.prepareData(e.update),s=["email","password","password_confirmation"],c={user:{}};Object.keys(o.data.user).forEach(function(e){s.indexOf(e)>-1?c.user[e]=o.data.user[e]:(c.user.profile_attributes=c.user.profile_attributes||{},c.user.profile_attributes[e]=o.data.user[e])}),a.update_details(c,function(){t.updateModal.modal.close(),r.check().catch(function(e){n.location.reload()})},function(t){e.update.errors=t.data.errors})}e.isTermsAcceptanceMissed=s.includes("terms_acceptance"),e.update={fields:[],errors:!1,data:{},message:null,submit:d},l(),t.$on("socialProvidersRefreshSuccess",function(e,t){l()}),i.init().then(function(){s.includes("age_acceptance")&&s.includes("terms_acceptance")&&(s=s.filter(function(e){return!("age_acceptance"===e||"terms_acceptance"===e)}),s.push("age_terms_acceptance")),e.update.fields=_.compact(s.map(function(e){var t=i.getFieldByName(e);return t?"terms_acceptance"!==e&&"age_terms_acceptance"!==e||(t.hasCombinedLabel=!0,1===s.length&&(t.onlyField=!0)):console.warn("No '"+e+"' field found."),t})),e.update.fields.forEach(function(t){i.registration.data.profile&&i.registration.data.profile[t.field]&&!e.update.data[t]&&(e.update.data.profile=e.update.data.profile||{},e.update.data.profile[t.field]=i.registration.data.profile[t.field]),i.registration.data.user&&i.registration.data.user[t.field]&&!e.update.data[t]&&(e.update.data.user=e.update.data.user||{},e.update.data.user[t.field]=i.registration.data.user[t.field])})})}e.$inject=["$scope","$rootScope","$window","AuthProviders","Auth","AuthSocialService","FormRegistrationService","fields"],angular.module("casino.controllers").controller("UpdateCtrl",e)}(),function(){function e(e,t,n){function a(t){t.forEach(function(e){i.user[e]=s[e].default}),n.update_details(i,function(){e.$broadcast("authCheckUser")},function(e){})}function r(e){return!!s[e].default}function o(e){return e.every(r)}var i={user:{}},s=_.indexBy(t,"field");return{canUpdateInstantly:o,updateDetails:a}}e.$inject=["$rootScope","REGISTRATION","AuthProviders"],angular.module("casino.services").factory("UpdateRegistrationService",e)}(),function(){function e(e,t,n,a,r,o,i,s){function c(a){e.showCaptcha&&!a.data.user.captcha&&(a.data.user.captcha="blank"),n.sent_unlock_email(a.data,function(e){i.show("devise.unlocks.send_instructions",{classes:"alert-success"}),r.go("home",{lang:t.currentLocale})},function(e){t.$broadcast("unlockFormError"),a.data.errors=e.data.errors})}var u={};e.unlock=u,e.showCaptcha=!1,a.settings(function(t){e.showCaptcha=!!t.recaptcha}),u.data={user:{},unlock_token:o.search().unlock_token,errors:{}},o.search().unlock_token?n.unlock_email(u.data,function(e){r.go("home",{unlock_token:null,lang:t.currentLocale}).then(function(){i.show("devise.unlocks.unlocked",{classes:"alert-success"})})},function(e){u.data.errors=e.data.errors}):"app.users_unlock"==r.current.name&&r.go("app.users_unlock_new",{lang:t.currentLocale}),u.data.user.email="",u.submit=function(){s.key?s.captchaV3(function(e){u.data.user.captcha=e,c(u)}):c(u)}}e.$inject=["$scope","$rootScope","User","Player","$state","$location","Notification","RecaptchaService"],angular.module("casino.controllers").controller("UnlockController",e)}(),CasinoConstants.constant("CHATRA_LOCALES",{ja:{customStrings:{welcome:"",chatWithUs:"",leaveUsAMessage:"",mobile_chatWithUs:"",mobile_leaveUsAMessage:"",offlineNote:"",bot_thanksForMessage:" ",bot_startOnline:"  ",bot_startOnline_email:"({{#email}}) ",bot_startOnline_required:"   ",bot_startOffline:"   ",bot_startOffline_email:"({{#email}})   ",bot_startOffline_required:"   ",bot_beforeForm:"  ",bot_afterForm:"",bot_afterForm_email:"",bot_details:"   ",bot_checkbox:"",bot_marketingConsent:" "},online:"",loading:"...",chat:{empty:"",input:{placeholder:"...",oneMore:"...",notIntroduced:"  ",reply:"{{#name}}"},send:"",messagesCount:"{{#count}} {{plural:#count,,}}",noMessages:"",newMessage:"",retrievingHistory:"...",more:"...",loading:"...",introduce:"  ",rate:"",insertEmoji:""},name:"",yourName:"",email:"E",phone:"",message:"",submit:"",saved:"",change:"",cancel:"",messageTypes:{welcome:"",joinedFirst:" ",joined:"{{#username}} ",left:"{{#username}}",agentsOffline:"",ratedChat:""},agent:"",typing:"..",areTyping:"..",minimize:"",date:{month:{full:"1_2_3_4_5_6_7_8_9_10_11_12",short:"1_2_3_4_5_6_7_8_9_10_11_12"},am:"AM_PM",moment:"",minute:"{{#count}} {{plural:#count,,}}",hour:"{{#count}} {{plural:#count,,}}",day:"{{#count}} {{plural:#count,,}}",today:"",yesterday:"",format:{date:"MMMM D",dateWithYear:"MMMM D, YYYY",when:"MMM D",whenWithYear:"MMM D, YYYY",time:"h:mm A"}},status:{waiting:"{{$connecting}}",connecting:"...",failed:"",offline:"",retry:""},smile:{sorry:""},error:{weird:"",incorrectEmail:"E",emptyEmail:"E",emptyMessage:"",denied:"",formNotDone:" "},and:"",close:"",requiredField:" ",_chatra:{logo:"Chatra",phrase:" ",chatra:"Chatra"},messageSent:"",active:"",activeShort:"1",activeLong:"",sending:"...",sent:"",unsent:"  ",notSeen:"",seen:"",units:{b:"B",kb:"KB",mb:"MB",gb:"GB"},dropToUpload:"",uploadFile:"",uploadFailed:"",maximumFileSize:"{{#size}}MB",comment:"",rateConversation:"",rate:"",update:"",optional:"",whoToChatWith:" ",notSure:""}}),function(){function e(e,t,n,a,r){function o(){var e=new Date;e.setFullYear(e.getFullYear()+10),n.put("_cookies_accepted",!0,{expires:e.toGMTString()})}t.setAcceptedPolicyCookie=o,t.privacyPolicyPageExists=!1,t.policyMenuItem=void 0,a.list({l:e.currentLocale}).$promise.then(function(e){t.policyMenuItem=e.find(function(e){return r.getLinkMenuItem(e,"PRIVACY_POLICY")}),t.policyMenuItem?t.privacyPolicyPageExists=!0:console.warn("No 'privacy-policy' page has been found.")})}e.$inject=["$rootScope","$scope","$cookies","Pages","PagesService"],angular.module("casino").controller("CookiesPolicyCtrl",e)}(),function(){function e(e,t,n){function a(){(!n.hasOwnProperty("SHOW_COOKIES_NOTIFICATION")||n.hasOwnProperty("SHOW_COOKIES_NOTIFICATION")&&n.SHOW_COOKIES_NOTIFICATION)&&(e.get("_cookies_accepted")||t.show("",{classes:"cookies-policy",position:"center",duration:"0",templateUrl:"/app/services/CookiesPolicy/_cookies-policy.html"}))}return{init:a}}e.$inject=["$cookies","Notification","SYSTEM"],angular.module("casino").factory("CookiesPolicyService",e)}(),function(){function e(e){this.PWA=e}e.$inject=["PWA"],angular.module("casino.services").controller("PWACtrl",e)}(),function(){function e(e){function t(){r.prompt()}function n(t){console.log("App was installed.",t),e.dataLayer.push({event:"pwa-installed",device:$rootScope.data.device,country:$rootScope.data.current_ip.country_code})}var a={installPWA:t,PWAInstallationEnabled:!1},r=null;return window.addEventListener("beforeinstallprompt",function(e){e.preventDefault(),r=e,a.PWAInstallationEnabled=!0}),window.addEventListener("appinstalled",function(e){a.PWAInstallationEnabled=!1,r=null,n()}),a}e.$inject=["$window"],angular.module("casino.services").factory("PWA",e)}(),function(){function e(e,t,n){var a=this;a.FreespinsService=e,a.Compoints=t,a.BonusesService=n}e.$inject=["Freespins","Compoints","BonusesService"],angular.module("casino.profile").component("profileBonusesTab",{templateUrl:"/app/Profile/components/Bonuses/bonuses-tab.component.html",controller:e,bindings:{selectedItem:"="}})}(),function(){function e(e,t,n,a){function r(){var e=a("filter")(t.data.freespins,o).length,r=a("filter")(n.data.bonuses,o).length;i.count=e+r||null,i.available=!0}function o(e){return e.activatable}var i={key:"bonuses",available:!1,count:0,i18n_key:"profiles.menu.bonuses"};return e.$on("bonusesRefreshSuccess",r),e.$on("freespinsRefreshSuccess",r),i}e.$inject=["$rootScope","Freespins","BonusesService","$filter"],angular.module("casino.profile").factory("BonusesTabService",e)}(),function(){function e(e){var t=this;t.historyTab=e,t.tabs=e.tabs,e.setDefaultTab(t.currentTab)}e.$inject=["HistoryTabService"],angular.module("casino.profile").component("profileHistoryTab",{templateUrl:"/app/Profile/components/History/_history-tab.component.html",controller:e,bindings:{currentTab:"="}})}(),function(){function e(e){function t(e){i.selectedTab=e}function n(){}function a(){}function r(){}function o(e){e||(e=Object.keys(i.tabs)[0]),t(e)}var i={selectTab:t,setDefaultTab:o,tabs:{bonuses:{available:!0,i18n_key:"bonuses_history"},transactions:{available:!0,i18n_key:"payments_history"},bets:{available:!0,i18n_key:"last_50_bets_history"}},key:"history",selectedTab:null,available:!0,i18n_key:"profiles.menu.history"};return e.$on("bonusesRefreshSuccess",n),e.$on("playerPaymentsInited",a),e.$on("betsRefreshSuccess",r),i}e.$inject=["$rootScope"],angular.module("casino.profile").factory("HistoryTabService",e)}(),function(){function e(e,t,n,a,r,o,i,s,c){var u=this;u.BalanceService=e,u.FreespinsService=n,u.BonusesService=a,u.PlayerPaymentsService=r,u.LotteryService=o,u.CompointsBoostersService=i,u.Compoints=t,u.isExchangeAvailable=c.available,u.isStatusesAvailable=s.available}e.$inject=["Balance","Compoints","Freespins","BonusesService","PlayerPaymentsService","Lottery","CompointsBoostersService","StatusesService","CompointsExchangeService"],angular.module("casino.profile").component("profileDashboardTab",{templateUrl:"/app/Profile/components/Dashboard/dashboard-tab.component.html",controller:e})}(),function(){function e(){return{key:"dashboard",available:!0,i18n_key:"frontend.profiles.menu.dashboard"}}angular.module("casino.profile").factory("DashboardTabService",e)}(),function(){function e(e,t,n){function a(){var e=o(n.tabs);r(Object.keys(e)[0])}function r(e){i.selectedTab=e}function o(e){return Object.keys(e).filter(function(t){return e[t].available}).reduce(function(t,n){return t[n]=e[n],t},{})}var i=this;i.LimitsService=t,i.selectTab=r,i.tabs=n.tabs,a(),e.$on("limitsTabRefreshSuccess",a)}e.$inject=["$rootScope","LimitsService","LimitsTabService"],angular.module("casino.profile").component("profileLimitsTab",{templateUrl:"/app/Profile/components/Limits/_profile-limits-tab.component.html",controller:e})}(),function(){function e(e,t){function n(){a(),e.$broadcast("limitsTabRefreshSuccess")}function a(){r.tabs.deposit.available=t.data.limitsExistence.deposit,r.tabs.wager.available=t.data.limitsExistence.wager,r.tabs.loss.available=t.data.limitsExistence.loss}var r={tabs:{deposit:{available:!1,i18n_key:"activerecord.attributes.user_limits/base.types.deposit"},wager:{available:!1,i18n_key:"activerecord.attributes.user_limits/base.types.wager"},loss:{available:!1,i18n_key:"activerecord.attributes.user_limits/base.types.loss"}},key:"limits",available:!0,i18n_key:"profiles.menu.limits"};return e.$on("limitsRefreshSuccess",n),r}e.$inject=["$rootScope","LimitsService"],angular.module("casino.profile").factory("LimitsTabService",e)}(),function(){function e(e,t,n){var a=this;a.LotteryService=e,a.ExchangeService=t,a.Compoints=n}e.$inject=["Lottery","CompointsExchangeService","Compoints"],angular.module("casino.profile").component("profileLotteriesTab",{templateUrl:"/app/Profile/components/Lotteries/lotteries-tab.component.html",controller:e})}(),function(){function e(e,t,n,a){function r(){o.available=t.data.user_list.length||n.data.lotteries.length&&a.available}var o={key:"lotteries",available:!1,i18n_key:"frontend.profiles.menu.lotteries"};return e.$on("LotteryUpdated",r),r(),o}e.$inject=["$rootScope","Lottery","CompointsExchangeService","Compoints"],angular.module("casino.profile").factory("LotteriesTabService",e)}(),function(){function e(e,t,n){var a=this;a.AuthSocialService=e,a.TwoFactorAuthService=t,a.PlayerPhone=n}e.$inject=["AuthSocialService","TwoFactorAuthService","PlayerPhone"],angular.module("casino.profile").component("profileInfoTab",{templateUrl:"/app/Profile/components/Profile-info/_profile-info-tab.component.html",controller:e})}(),function(){function e(){return{key:"profile",available:!0,i18n_key:"profiles.menu.profile"}}angular.module("casino.profile").factory("ProfileInfoTabService",e)}(),function(){function e(e){this.documents=e}e.$inject=["Documents"],angular.module("casino.profile").component("profileVerificationTab",{templateUrl:"/app/Profile/components/Verification/verification-tab.component.html",controller:e})}(),function(){function e(){return{key:"verification",available:!0,i18n_key:"profiles.menu.documents"}}angular.module("casino.profile").factory("VerificationTabService",e)}(),function(){function e(e,t){function n(){t.refresh(),s.bonus=t.addTimerField(s.bonus)}function a(e,n){s.bonus.id===n.id&&(s.bonus=n,s.bonus=t.addTimerField(s.bonus),s.isPending=!1)}function r(){s.isPending=!0,t.activateById(s.bonus.id).then(function(){e.$broadcast("balanceRefresh")}).catch(function(e){s.isPending=!1})}function o(){t.deactivateById(s.bonus.id).then(function(){e.$broadcast("balanceRefresh")})}function i(){t.getAll()}var s=this;s.$onInit=n,s.activate=r,s.deactivate=o,s.updateBonuses=i,e.$on("bonusUpdated",a)}e.$inject=["$rootScope","BonusesService"],angular.module("casino").component("casinoBonusItem",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Bonuses/BonusItem/_"+(t.template||"main")+".html"}],controller:e,bindings:{bonus:"<",hasTimer:"<",close:"&",dismiss:"&"}})}(),function(){function e(e){function n(){r.statusI18nCode="",r.bonusCode=r.bonusCode||"",r.bonusCode.length?e.applyBonusCode(r.bonusCode).then(function(e){e.status===t.successfully_activated?(r.statusI18nCode="",r.activated=!0):r.statusI18nCode="frontend.coupons.errors."+e.status}).catch(function(e){}):r.statusI18nCode="frontend.errors.messages.blank"}function a(){r.activated=!1,r.bonusCode=""}var r=this;r.activated=!1,r.bonusCode="",r.applyBonusCode=n,r.resetState=a}e.$inject=["BonusRedemptionService"],angular.module("casino").component("casinoBonusRedemption",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Bonuses/BonusRedemption/_"+(t.template||"main")+".html"}],controller:e});var t={successfully_activated:"successfully_activated",already_activated:"already_activated",failed_to_activate:"failed_to_activate"}}(),function(){function e(e){function t(t){return e.applyBonusCode({coupon_code:t}).$promise}return{applyBonusCode:t}}e.$inject=["BonusesResource"],angular.module("casino.services").factory("BonusRedemptionService",e)}(),function(){function e(e,t){function n(e){return s.currency=i.currency||i.currency,t.selectBonus(e,i.type,s.currency)}function a(n,a){i.isLoading=!0,i.bonuses=[],s=a?angular.copy(a):s,s.currency=i.currency||s.currency,t.fetchBonusPreview(s,i.type).then(function(e){i.bonuses=angular.copy(e),i.isAnyBonusAvailable=o(i.bonuses),i.isLoading=!1}).catch(function(t){412===t.status&&e.$broadcast("bonusPreviewSettingsUpdated",!1),i.isLoading=!1})}function r(e,n){s=n,s.currency=i.currency,t.refreshBonusPreview(i.bonuses,s,i.type).then(function(e){i.bonuses=e,i.isAnyBonusAvailable=o(e)})}function o(e){return e.some(function(e){return e.bonuses.some(function(e){return e.isAvailable})})}var i=this;i.bonuses=[],i.isAnyBonusAvailable=!1,i.isLoading=!0,i.onSelectBonus=n;var s={};e.$on("fetchBonusPreview",a),e.$on("depositBonusCodeUpdated",a),e.$on("refreshBonusPreview",r),a(null,e.data.user)}e.$inject=["$rootScope","BonusesPreviewService"],angular.module("casino").component("bonusesPreview",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Bonuses/BonusesPreview/_"+(t.template||"main")+".html"}],bindings:{type:"@",currency:"<"},controller:e})}(),function(){angular.module("casino.constants").constant("BONUSES_PREVIEW_ORDER",[{field:"amount_min",order:1},{field:"amount_max",order:2},{field:"currencies_inclusion",order:3},{field:"deposit_payment_systems",order:4},{field:"game_categories",order:5},{field:"groups_all",order:6},{field:"groups_inclusion",order:7},{field:"groups_exclusion",order:8},{field:"freespins_count",order:9},{field:"games",order:10},{field:"freespins_max_win",order:11},{field:"bonus_amount",order:12},{field:"bonus_amount_max",order:13},{field:"wager",order:14},{field:"max_win",order:15}])}(),function(){angular.module("casino.filters").filter("bonus_preview_localized_value",["$filter","StatusesService",function(e,t){return function(n,a){var r;switch(n.field){case"currencies":case"deposit_payment_systems":case"game_categories":case"games":r=n.value.join(", ");break;case"game_identifiers":r=_.unique(_.pluck(n.value,"title")).join(", ");break;case"amount":case"freespins_max_win":case"max_win":r=n.value.filter(function(e){return!a||!a.currency||e.currency===a.currency}).map(function(t){return e("humanized_currency")(t.amount_cents,t.currency)}).join(", ");break;case"bonus_amount":case"bonus_amount_max":case"bonus_amount_min":r=n.value&&n.value.percent?n.value.percent+"%":n.value.filter(function(e){return!a||!a.currency||e.currency===a.currency}).map(function(t){return e("humanized_currency")(t.amount_cents,t.currency)}).join(", ");break;case"groups":r=n.value.map(function(e){var n=t.getById(e);return n?n.name:""}).join(", ");break;case"date_time":var o=n.value.from?e("translate")("frontend.bonus_preview.values.date_time_date_inclusion.from",{value:n.value.from}):"",i=n.value.to?e("translate")("frontend.bonus_preview.values.date_time_date_inclusion.to",{value:n.value.to}):"",s=n.value.time?e("translate")("frontend.bonus_preview.values.date_time_date_inclusion.time",{value:n.value.time}):"",c=n.value.on.length?e("translate")("frontend.bonus_preview.values.date_time_date_inclusion.weekdays",{value:n.value.on.join(", ")}):"",u=n.value.tz?e("translate")("frontend.bonus_preview.values.date_time_date_inclusion.tz",{value:n.value.tz}):"";r=e("translate")("frontend.bonus_preview.values.date_time_date_inclusion.full_message",{from:o,to:i,time:s,weekdays:c,tz:u});break;default:r=n.value}return r}}])}(),function(){function e(e,n,a,r,o,i,s,c){function u(t,n){t=t||s.data.user||{},n=n||"registration";var a=v(t,n),r={user:{profile_attributes:{country:a.country},bonus_code:a.bonus_code,currency:a.currency}};return e[n+"Preview"](r).$promise.then(function(e){return l(e,t,n)})}function l(e,t,n){t=t||{},t.groups=g(n);var a=d(e,t);return a=f(a,t),a=m(a),i.resolve(a)}function d(e,t){return e.map(function(e){return e.bonuses.map(function(e){return e.isAvailable=e.conditions.every(function(e){var n=!0;switch(e.field){case"currencies":var a=_.includes(e.value,t.currency);"inclusion"===e.type&&(a||(n=!1)),"exclusion"===e.type&&a&&(n=!1),"all"===e.type&&(a?1!==e.value.length&&(n=!1):n=!1)}return n}),e}),e.isAvailable=!!_.where(e.bonuses,{isAvailable:!0}).length,e})}function f(e,t){var n=!1;return e.reduce(function(e,a){return e.push(a),a.bonuses.map(function(e){return e.isActive=!1,n||(e.isActive=e.conditions.every(function(e){var n=!0;switch(e.field){case"groups":"inclusion"===e.type&&(n=e.value.some(function(e){return _.includes(t.groups,e)})),"exclusion"===e.type&&(n=e.value.every(function(e){return!_.includes(t.groups,e)})),"all"===e.type&&(n=e.value.every(function(e){return _.includes(t.groups,e)}))}return n}),n=e.isActive),e}),a.isActive=!!_.where(a.bonuses,{isActive:!0}).length,e},[])}function m(e){return e.map(function(e){return e.bonuses=e.bonuses.map(function(e){return e.conditions=e.conditions.map(p),e.attributes=e.attributes.map(p),e}),e})}function p(e){var t=_.compact([e.field,e.type]).join("_");"bonus_amount"===e.field&&(e.field=_.compact([e.field,e.type]).join("_")),e.localized_field="frontend.bonus_preview."+t;var n=c.find(function(e){return e.field===t});return e.order=n?n.order:null,e}function g(e){return"deposit"===e?_.pluck(s.data.user.statuses,"id"):n.getUserGroups()||[]}function h(e,t,i){var c=g(t),u=e.conditions.find(function(e){return"groups"===e.field});if(u&&e.isAvailable){var l=y(c,u);if("deposit"===t){var d={groups:{remove:_.difference(c,l).filter(o.isWritableById),add:_.difference(l,c).filter(o.isWritableById)}};a.edit(d).then(function(){return r.fetchUser()}).then(function(e){e.currency=i,s.$broadcast("refreshBonusPreview",e)})}else n.setUserGroups(l),n.refreshBonusPreview()}}function y(e,t){var n=[];switch(t.type){case"inclusion":var a=t.value,r=a.map(b);n=e.filter(function(e){return!_.includes(r,b(e))}).concat(a);break;case"exclusion":n=e.filter(function(e){return!_.includes(t.value,e)});break;case"all":n=e.concat(t.value)}return _.unique(n)}function v(e,n){var a={};return t[n].forEach(function(t){e[t]&&(a[t]=e[t])}),a}function b(e){return e.split(":")[0]}return{fetchBonusPreview:u,refreshBonusPreview:l,selectBonus:h}}e.$inject=["BonusesResource","FormRegistrationService","PlayerGroups","Auth","StatusesService","$q","$rootScope","BONUSES_PREVIEW_ORDER"],angular.module("casino.services").factory("BonusesPreviewService",e);var t={registration:["country","bonus_code"],deposit:[]}}(),function(){function e(e,t,n,a,r){function o(){P.compoints=t.data.chargeable?t.data.chargeable.points:null}function i(){C(),u()}function s(){b(P.moneyInput.rate&&P.moneyInput.rate.currency,P.moneyInput.rate),$(),u()}function c(){$(),u()}function u(){if(P.moneyInput.group&&P.moneyInput.rate&&P.moneyInput.points){var e={group:P.moneyInput.group.group,points:P.moneyInput.points,currency:P.moneyInput.rate.currency},a=t.data.chargeable.points;P.moneyInput.isValid=n.validation.isEnoughForMoney(e,a)}else P.moneyInput.isValid=!1}function l(){if(P.freespinsInput.group){var a={group:P.freespinsInput.group.group,points:P.freespinsInput.points,currency:e.data.user.currency},r=t.data.chargeable.points;P.freespinsInput.isValid=n.validation.isEnoughForFreespins(a,r)}else P.freespinsInput.isValid=!1}function d(){S(),l()}function f(){S(),l()}function m(){w(),v()}function p(){w(),v()}function g(e){P.compointsExchange.exchangeByType({type:"money"},e).then(function(){P.moneyInput.points=0,c()})}function h(e){P.compointsExchange.exchangeByType({type:"freespins"},e).then(function(){P.freespinsInput.points=0,f()})}function y(e){P.compointsExchange.exchangeByType({type:"lotteries"},e).then(function(){P.lotteriesInput.points=0,p()})}function v(){if(P.lotteriesInput.group&&P.lotteriesInput.lottery){var e={group:P.lotteriesInput.group.group,lottery_id:P.lotteriesInput.lottery.id,tickets_count:P.lotteriesOutput.sum},a=t.data.chargeable.points;P.lotteriesInput.isValid=n.validation.isEnoughForLotteries(e,a)}else P.lotteriesInput.isValid=!1}function b(e,t){P.moneyOutput.exchangeRate=n.getMoneyExchangeRateByCurrency(e,t)}function $(){P.moneyInput.rate?(P.moneyOutput.sum=Math.floor(P.moneyInput.points/P.moneyOutput.exchangeRate.compointsAmount)*P.moneyOutput.exchangeRate.currencyAmount,P.moneyOutput.points=P.moneyOutput.sum/P.moneyOutput.exchangeRate.currencyAmount*P.moneyOutput.exchangeRate.compointsAmount):(P.moneyOutput.sum=null,P.moneyOutput.points=0)}function S(){P.freespinsOutput.sum=Math.floor(P.freespinsInput.points/P.freespinsInput.group.rate.points)*P.freespinsInput.group.rate.freespins_count,P.freespinsOutput.points=P.freespinsOutput.sum/P.freespinsInput.group.rate.freespins_count*P.freespinsInput.group.rate.points}function w(){P.lotteriesOutput.sum=1*Math.floor(P.lotteriesInput.points/P.lotteriesInput.group.rate.points),P.lotteriesOutput.points=P.lotteriesOutput.sum/1*P.lotteriesInput.group.rate.points}function C(){t.data.chargeable&&t.data.chargeable.points&&(P.moneyInput.group=P.moneyInput.group||angular.copy(P.compointsExchange.data.money[0]),E(),P.moneyInput.rate=n.getDefaultRateInGroup(P.moneyInput.group),b(P.moneyInput.rate&&P.moneyInput.rate.currency,P.moneyInput.rate),u(),P.freespinsInput.group=P.freespinsInput.group||P.compointsExchange.data.freespins[0],l(),P.lotteriesInput.group=P.lotteriesInput.group||P.compointsExchange.data.lotteries[0],L(),v())}function A(){E(),I()}function E(){a.balances.length&&P.moneyInput.group&&(P.moneyInput.group.rates=P.moneyInput.group.rates.filter(function(e){return!!_.findWhere(a.data.balances,{currency:e.currency})}))}function I(){P.currentMoneyExchangeRate=n.getMoneyExchangeRateByCurrency(e.data.user.currency)}function T(){L()}function L(){if(P.lotteriesInput.group&&Object.keys(r.list).length){var e=Object.keys(r.list).map(function(e){return r.list[e]}),t=e.filter(function(e){return e.data.in_progress}),n=t.map(function(e){return e.data.id}),a=_.intersection(P.lotteriesInput.group.rate.lottery_ids,n);P.lotteriesInput.availableLotteries=a.map(function(e){return{id:r.list[e].data.id,title:r.list[e].data.title}}),P.lotteriesInput.lottery=P.lotteriesInput.availableLotteries[0]}}var P=this;P.compointsExchange=n,P.compoints=null,P.moneyInput={},P.moneyOutput={},P.freespinsInput={},P.freespinsOutput={},P.lotteriesInput={},P.lotteriesOutput={},P.currentMoneyExchangeRate=null,P.onMoneyGroupChanged=i,P.onCurrencyChanged=s,P.onMoneyInputPointsChanged=c,P.onFreespinsInputGroupChanged=d,P.onFreespinsInputPointsChanged=f,P.onLotteriesInputGroupChanged=m,P.onLotteriesInputPointsChanged=p,P.exchangeForMoney=g,P.exchangeForFreespins=h,P.exchangeForLotteryTickets=y,e.$on("compointsUpdated",o),e.$on("balanceRefreshSuccess",A),e.$on("currenciesUpdated",I),e.$on("exchangeRatesUpdated",C),e.$on("LotteryUpdated",T),C(),o(),n.init(),e.data&&e.data.user.email&&I()}e.$inject=["$rootScope","Compoints","CompointsExchangeService","Balance","Lottery"],angular.module("casino").component("compointsExchange",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Compoints/Exchange/_"+(t.template||"main")+".html"}],controller:e,bindings:{close:"&",dismiss:"&",openedTab:"<"}})}(),function(){function e(e,t,n){function a(){!m&&e.data&&e.data.user.email&&o().then(function(){m=!0})}function r(){m&&o()}function o(){return t.all({money:n.getMoneyRates().$promise,freespins:n.getFreespinsRates().$promise,lotteries:n.getLotteriesRates().$promise}).then(function(t){return p.data=t,p.data.money=p.data.money||[],p.data.freespins=p.data.freespins||[],p.data.lotteries=p.data.lotteries||[],p.available=p.data.money.length||p.data.freespins.length||p.data.lotteries.length,e.$broadcast("exchangeRatesUpdated"),Promise.resolve()})}function i(t,a){
return n.exchange(t,{exchange:a}).$promise.then(function(){switch(t.type){case"money":e.$broadcast("exchangedCompointsForMoneySuccess");break;case"freespins":e.$broadcast("exchangedCompointsForFreespinsSuccess");break;case"lotteries":e.$broadcast("exchangedCompointsForLotteriesSuccess")}e.$broadcast("refreshCompoints")})}function s(e,t){var n=p.data.money.find(function(t){return t.group===e.group}),a=n.rates.find(function(t){return t.currency===e.currency});return e.points<=t&&a.points<=e.points}function c(e,t){var n=p.data.freespins.find(function(t){return t.group===e.group}),a=n.rate;return e.points<=t&&a.points<=e.points}function u(e,t){var n=p.data.lotteries.find(function(t){return t.group===e.group}),a=n.rate;return e.tickets_count*a.points<=t&&e.tickets_count>0}function l(t,n){if(!e.Info.currencies||!p.data.money.length||!t)return{};var a=p.data.money[0];if(a)var r=a.rates.find(function(e){return e.currency===t});if(!(r=n||r))return{};var o=e.Info.currencies.find(function(e){return e.code===r.currency});return{compointsAmount:r.points,currencyAmount:r.amount_cents/o.subunits_to_unit}}function d(t){if(!t)return{};var n=t.rates.find(function(t){return t.currency===e.data.user.currency});return n=n||t.rates[0]}function f(){m=!1,p.data={money:[],freespins:[],lotteries:[]}}e.$on("authLoginSuccess",r),e.$on("exchangeRatesRefresh",r),e.$on("statusChanged",r),e.$on("authLogoutSuccess",f);var m=!1,p={data:{money:[],freespins:[],lotteries:[]},available:!0,init:a,exchangeByType:i,getMoneyExchangeRateByCurrency:l,getDefaultRateInGroup:d,validation:{isEnoughForMoney:s,isEnoughForFreespins:c,isEnoughForLotteries:u}};return p}e.$inject=["$rootScope","$q","CompointsResource"],angular.module("casino.services").factory("CompointsExchangeService",e)}(),function(){function e(e){function t(){e.refresh()}var n=this;n.CompointsBoostersService=e,n.updateCompointsBoosters=t}e.$inject=["CompointsBoostersService"],angular.module("casino").component("casinoCompointsBoostersItem",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Compoints-boosters/CompointsBoostersItem/_"+(t.template||"main")+".html"}],bindings:{compointsBooster:"<"},controller:e})}(),function(){function e(e,t,n){function a(){c.freespin=t.addTimerField(c.freespin)}function r(e,n){c.freespin.id===n.id&&(c.freespin=n,c.freespin=t.addTimerField(c.freespin),c.isPending=!1)}function o(){if(c.freespin.activatable)c.isPending=!0,t.activateById(c.freespin.id).then(function(){}).catch(function(e){c.isPending=!1});else{var a=c.freespin.activation_condition.split(":");if("player_context"!==a[0])throw new Error('Unknown "activation_condition": '+a[0]);if(!(Object.keys(n.data.contexts).indexOf(a[1])>-1))throw new Error('Unknown "player_context": '+a[1]);n.showEditByContextModal({context:a[1],successCallback:function(){var t=e.$on("freespinUpdated",function(e,n){n.id===c.freespin.id&&(o(),t())})}})}}function i(){t.deactivateById(c.freespin.id).then(function(){})}function s(){t.getAll()}var c=this;c.$onInit=a,c.activate=o,c.deactivate=i,c.updateFreespins=s,e.$on("freespinUpdated",r)}e.$inject=["$rootScope","Freespins","ProfileEditService"],angular.module("casino").component("casinoFreespinItem",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Freespins/FreespinItem/_"+(t.template||"main")+".html"}],controller:e,bindings:{freespin:"<",hasTimer:"<",close:"&",dismiss:"&"}})}(),function(){function e(e,t,n,a,r,o,i){function s(){if(e.Info.currencies)if(l.isEdit)l.userLimit=angular.copy(l.limit),"deposit"===l.type&&(l.userLimit.accounts=l.userLimit.accounts.filter(function(e){return e.fiat}));else{l.userLimit={period:l.period||l.availablePeriods[0],type:l.type};var t={isUserCurrency:!0};"deposit"===l.type&&(t.fiat=!0),l.userLimit.accounts=_.where(n.data.allUserBalances,t).map(function(e){return{currency:e.code,amount:null}})}}function c(){l.currency=l.currency||e.Info.currencies[0].code}function u(){var e=!1,n=!0,r="",o="",i={};"selfexclusion"!==l.userLimit.type&&"coolingoff"!==l.userLimit.type||(e=!0,o=t("translate")("activerecord.attributes.user_limits/base.periods."+l.userLimit.period),r=t("translate")("frontend.limits."+l.userLimit.type+".confirm_message",{period:o})),e&&(n=confirm(r)),n&&(i=a.getLimitErrors(l.userLimit),0===Object.keys(i).length?a.create(angular.copy(l.userLimit)).then(function(){l.errors={},l.close()}).catch(function(e){l.errors=e.data.errors}):l.errors=i)}var l=this;l.AccountsLimitService=a,l.availablePeriods=r.data.availablePeriods[l.type],l.userLimit={},l.errors={},l.isEdit=Boolean(l.limit),l.FIELDS_TO_SHOW=o[l.type],l.LIMIT_STATUSES=i,l.onApplyLimit=u,e.$on("limitsRefreshSuccess",c),e.$on("currenciesUpdated",s),s()}e.$inject=["$rootScope","$filter","Balance","AccountsLimitService","LimitsService","LIMIT_FIELDS_TO_SHOW","LIMIT_STATUSES"],angular.module("casino").component("casinoAccountsLimit",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Limits/AccountsLimit/_"+(t.template||"main")+".html"}],controller:e,bindings:{type:"<",limit:"<",close:"&",dismiss:"&"}})}(),function(){function e(e,t,n,a,r,o){function i(t){t.accounts&&(t.accounts=t.accounts.map(s).map(c));var n={accounts:t.accounts,type:t.type,period:t.period};return r.create({user_limit:n}).$promise.then(function(){return e.$broadcast("refreshLimits"),"selfexclusion"===t.type?(o.logout(),e.mainModal.dismissAll(),a.show("devise.failure.user.limit_restrict_access",{classes:"alert-danger"})):a.show("profiles.show.limits.limit_created",{classes:"alert-success"}),Promise.resolve()}).catch(function(e){return Promise.reject(e)})}function s(t){var n=e.Info.currencies.find(function(e){return e.code===t.currency});return t.amount&&_.isNumber(+t.amount)?t.amount_cents=(t.amount*n.subunits_to_unit).toString():delete t.amount_cents,t}function c(e){return delete e.amount,e}function u(t){return r.remove({id:t}).$promise.then(function(){e.$broadcast("refreshLimits")})}function l(e){var n={};return["deposit","wager","loss"].includes(e.type)&&(d(e)||(n.amount_cents={blank:t("translate")("frontend.errors.messages.blank")})),n}function d(e){return _.compact(e.accounts.map(f)).length===e.accounts.length}function f(e){return e.amount}function m(t){t=t||{},t.template=t.template||"main",e.mainModal.modal=n.open({template:'<casino-accounts-limit template="'+t.template+'"type="$ctrl.type"limit="$ctrl.limit"resolve="$resolve" modal-instance="$modalInstance" close="$close($value)" dismiss="$dismiss($value)"></casino-accounts-limit>',controller:function(){var e=this;e.type=t.type,e.limit=t.limit},windowClass:"modal-edit-limit",controllerAs:"$ctrl"})}return{showEditLimitModal:m,create:i,update:i,removeById:u,getLimitErrors:l}}e.$inject=["$rootScope","$filter","$modal","Notification","LimitsResource","Auth"],angular.module("casino.services").factory("AccountsLimitService",e)}(),function(){function e(e,t){var n=this;n.LIMIT_STATUSES=e,n.AccountsLimitService=t,n.date_format="yyyy-MM-dd HH:mm:ss",n.date_timezone="UTC"}e.$inject=["LIMIT_STATUSES","AccountsLimitService"],angular.module("casino").component("accountsLimitsByType",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Limits/AccountsLimitsByType/_"+(t.template||"main")+".html"}],controller:e,bindings:{type:"<",limits:"<"}})}(),function(){function e(e,t){function n(){s.isOpened&&o()}function a(e){s.isPending=!0,_.isNumber(e)&&(c.push(e.toString()),c=_.unique(c)),"issued"===s.lootboxes.stage?t.activateById(s.lootboxes.id).then(function(){s.isPending=!1}):i({},s.lootboxes)}function r(){t.cancelById(s.lootboxes.id).then(function(){})}function o(){"issued"!==s.lootboxes.stage&&(s.lootboxes.items.forEach(function(e,t){s.selectedBoxIndexes.push(t.toString())}),s.selectedBoxIndexes=_.unique(s.selectedBoxIndexes))}function i(e,t){if(s.lootboxes.id===t.id){if(c.length){s.selectedBoxIndexes=_.clone(c);var a=_.clone(s.selectedBoxIndexes);Object.keys(t.items).forEach(function(e){a.includes(e)||a.push(e)}),t.items=t.items.sort(function(e,t){return t.prize-e.prize}),t.items=t.items.reduce(function(e,t,n){return e[a[n]]=t,e},[])}s.lootboxes=t,s.lootboxes.isJustActivated&&!s.selectedBoxIndexes.length&&n(),s.isPending=!1}}var s=this;s.activate=a,s.cancel=r,s.showAllBoxes=o,s.isOpened=s.isOpened||!0,s.selectedBoxIndexes=[];var c=[];e.$on("lootboxesUpdated",i),n()}e.$inject=["$rootScope","LootboxesService"],angular.module("casino").component("lootboxes",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/LootboxesList/Lootboxes/_"+(t.template||"main")+".html"}],bindings:{lootboxes:"<",isOpened:"<",close:"&",dismiss:"&"},controller:e}),angular.module("casino").controller("LootboxesCtrl",e)}(),function(){function e(e,t,n,a){function r(){u.depositLotteries=t.getDepositLotteries(u.currency);var e=_.findWhere(a.data.balances,{currency:u.currency});e&&e.selected_lottery_id?(u.selectedLottery=u.depositLotteries.find(function(t){return t.data.id===e.selected_lottery_id}),c()):u.selectedLottery=null,u.cantIssue=!u.selectedLottery}function o(e){e.amount?u.amount=e.amount.currentValue||0:u.amount=0,r()}function i(e){if(e!==u.selectedLottery){var t=e&&e.data&&e.data.id||null;n.select_lottery({currency:u.currency,selected_lottery:t}).$promise.then(function(){u.selectedLottery=e,u.ticketsNumber=0,a.refreshBalance()}).catch(function(e){})}}function s(e){i(e?null:u.depositLotteries[0])}function c(){u.ticketsNumber=t.getTicketsNumber(u.selectedLottery,u.amount,u.currency)}var u=this;u.selectedLottery=null,u.ticketsNumber=0,u.depositLotteries=[],u.cantIssue=null,u.$onChanges=o,u.onSelect=_.throttle(i,500),u.updateSettings=_.throttle(s,500),e.$on("balanceRefreshSuccess",r),r()}e.$inject=["$rootScope","Lottery","PlayerAccountsResource","Balance"],angular.module("casino").component("depositLotteries",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Lottery/Deposit-lotteries/_"+(t.template||"main")+".html"}],bindings:{currency:"<",amount:"<"},controller:e})}(),CasinoControllers.controller("LotteryItemCtr",["$scope","Lottery",function(e,t){if(e.item={id:e.id,frontendIdentifier:e.frontendIdentifier,image:e.image,title:e.title,description:e.description,lottery_item:{}},e.params&&_.extend(e.item,e.$eval(e.params)),e.frontendIdentifier){if(e.item.lottery_item=t.getByIdentifier(e.frontendIdentifier),!e.item.lottery_item)var n=e.$on("tournamentsUpdated",function(){e.item.lottery_item=t.getByIdentifier(e.frontendIdentifier),n()})}else e.item.lottery_item=t.get(e.id);e.timer&&e.item.lottery_item.autoUpdate(e.timer)}]),CasinoDirectives.directive("casinoLotteryItem",[function(){return{restrict:"E",replace:!0,scope:{id:"@id",template:"@template",frontendIdentifier:"@frontendIdentifier",title:"@title",image:"@image",description:"@description",timer:"@updatetimer",params:"@params"},templateUrl:function(e,t){return"/app/Users/Lottery/LotteryItem/_"+(t.template||"main")+".html"},controller:"LotteryItemCtr"}}]),function(){function e(e,t){function n(){i.cantIssue=t.getCantIssue(),i.bonusCode=t.get(),i.hasBonusCode=!!i.bonusCode}function a(e){t.set(e).then(n)}function r(){t.clear().then(n)}function o(e){t.updateSettings(e).then(n)}var i=this;i.bonusCode=null,i.set=_.throttle(a,500),i.clear=_.throttle(r,500),i.updateSettings=_.throttle(o,500),e.$on("authLoginSuccess",n),n()}e.$inject=["$rootScope","DepositBonusCode"],angular.module("casino").component("depositBonusCode",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Payments/DepositBonusCode/_"+(t.template||"main")+".html"}],bindings:{},controller:e})}(),function(){function e(e,t,n){function a(e){var n={deposit_bonus_code:e};return t.set_bonus_code(n).$promise.then(c)}function r(){return t.clear_bonus_code().$promise.then(c)}function o(a){var r={can_issue:!a};return t.update_bonus_settings(r).$promise.then(function(){return e.$broadcast("fetchBonusPreview",e.data.user),Promise.resolve()}).then(n.fetchUser)}function i(){return e.data.user.deposit_bonus_code}function s(){return!e.data.user.can_issue_bonuses}function c(){return e.$broadcast("depositBonusCodeUpdated"),n.fetchUser()}return{get:i,set:a,clear:r,updateSettings:o,getCantIssue:s}}e.$inject=["$rootScope","Player","Auth"],angular.module("casino.services").factory("DepositBonusCode",e)}(),function(){function e(){function e(e){e.stopPropagation(),n.disableSavedMethod({method:n.paymentMethod})}function t(){n.supportDisable=n.paymentMethod.supportDisable}var n=this;n.remove=e,n.$onChanges=t,n.supportDisable=n.paymentMethod.supportDisable}angular.module("casino").component("paymentMethodItem",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Payments/PaymentMethodItem/_"+(t.template||"main")+".html"}],bindings:{paymentMethod:"<",selectedCurrency:"<",action:"<",selectPaymentMethod:"&",disableSavedMethod:"&",isActive:"<"},controller:e})}(),function(){angular.module("casino").component("cardType",{templateUrl:"/app/Users/Payments/card-type/card-type.template.html",bindings:{selectedMethod:"<"},controller:"CardTypeController"})}(),function(){function e(){this.$onChanges=function(){this.cardsType=["verified-visa.svg"],"purplepay"!==this.selectedMethod.brand&&this.cardsType.push("mastercard-check.svg")}}angular.module("casino.controllers").controller("CardTypeController",e)}(),function(){function e(e,t){if(e.item={id:e.id,frontendIdentifier:e.frontendIdentifier,image:e.image,title:e.title,description:e.description,limit:e.limit||10,tournament:{}},e.TournamentsService=t,e.params&&_.extend(e.item,e.$eval(e.params)),e.frontendIdentifier){if(e.item.tournament=t.getByIdentifier(e.frontendIdentifier),!e.item.tournament)var n=e.$on("tournamentsUpdated",function(){e.item.tournament=t.getByIdentifier(e.frontendIdentifier),n()})}else if(e.item.tournament=t.get(e.id),e.item.tournament&&e.item.tournament.empty&&!t.tournaments_inited)var a=e.$on("tournamentsUpdated",function(){e.item.tournament=t.get(e.id),a()});e.timer&&e.item.tournament.autoUpdate(e.timer)}e.$inject=["$scope","Tournaments"],angular.module("casino").directive("casinoTournament",[function(){return{restrict:"E",replace:!0,scope:{id:"@id",template:"@template",frontendIdentifier:"@frontendIdentifier",title:"@title",image:"@image",description:"@description",timer:"@updatetimer",limit:"@limit",params:"@params"},templateUrl:function(e,t){return"/app/Users/Tournaments/Tournament/_"+(t.template||"main")+".html"},controller:e}}]),angular.module("casino").controller("TournamentCtr",e)}(),angular.module("licenseSGA",[]).run(["$rootScope","SYSTEM","RealityCheckService","LimitsService","LoginLimitsService",function(e,t,n,a,r){function o(){e.data.license===s&&i()}function i(){function n(){r.init()}var o=$("[ng-app]").attr("ng-app"),i=angular.module(o);if(!i||!i.requires.includes("licenseMGA")){var s=function(){var e={isFirstTimeLogin:!0};a.showModal(e)};c.successLoginAfterConfirmation&&s(),e.$on("successLoginAfterConfirmation",s),t.PASSWORD_SAVE_FORBIDDEN=!0;var u={AVAILABLE:!0,SCORE:1};t.PASSWORD_STRENGTH&&t.PASSWORD_STRENGTH.SCORE&&t.PASSWORD_STRENGTH.SCORE>u.SCORE&&(u.SCORE=t.PASSWORD_STRENGTH.SCORE),t.PASSWORD_STRENGTH=u}c.authLoginFormSuccess&&n(),e.$on("authLoginFormSuccess",n)}var s="SE";e.$on("licenseInited",o);var c={successLoginAfterConfirmation:!1,authLoginFormSuccess:!1};e.$on("successLoginAfterConfirmation",function(){c.successLoginAfterConfirmation=!0}),e.$on("authLoginFormSuccess",function(){c.successLoginAfterConfirmation=!0})}]),angular.module("licenseMGA",[]).run(["$rootScope","SYSTEM","RealityCheckService","LimitsService",function(e,t,n,a){function r(){e.data.license===i&&o()}function o(){function n(){var e={isFirstTimeLogin:!0,template:"limits-welcome-modal",windowClass:"limits-welcome"};a.showModal(e)}t.PASSWORD_SAVE_FORBIDDEN=!0;var r={AVAILABLE:!0,SCORE:1};t.PASSWORD_STRENGTH&&t.PASSWORD_STRENGTH.SCORE&&t.PASSWORD_STRENGTH.SCORE>r.SCORE&&(r.SCORE=t.PASSWORD_STRENGTH.SCORE),t.PASSWORD_STRENGTH=r,s.successLoginAfterConfirmation&&n(),e.$on("successLoginAfterConfirmation",n)}var i="MT";e.$on("licenseInited",r);var s={successLoginAfterConfirmation:!1};e.$on("successLoginAfterConfirmation",function(){s.successLoginAfterConfirmation=!0})}]),function(){angular.module("casino.constants").constant("REGISTRATION",[{field:"email",type:"text",required:!0,validation:[{type:"email"}],step:1},{field:"password",type:"password_with_toggle",required:!0,validation:[{type:"min_length",value:3},{type:"max_length",value:200}],step:1},{field:"password_confirmation",required:!1,type:"password",value:"",validation:[{type:"passwords_equality"}]},{field:"currency",type:"currency",required:!0,step:1},{field:"nickname",type:"text"},{field:"first_name",type:"text",required:!0,step:2},{field:"last_name",type:"text",required:!0,step:2},{field:"date_of_birth",type:"date_simple",order:9,required:!0,scope:"profile",show_at:["new"],validation:[{type:"date"}],step:2},{field:"full_name",type:"text"},{field:"place_of_birth",type:"text"},{field:"personal_id_number",type:"text"},{field:"time_zone",type:"time_zone",order:12,required:!0,scope:"profile",show_at:["new"],length:{maximum:40}},{field:"language",type:"language"},{field:"country",type:"country_smart",required:!0,step:2},{field:"city",type:"text",required:!0,step:2},{field:"address",type:"text",required:!0,step:2},{field:"postal_code",type:"text",required:!0,step:2},{field:"address2",type:"text"},{field:"mobile_phone",type:"tel"},{field:"phone",type:"tel"},{field:"skype",type:"text"},{field:"wechat",type:"text"},{field:"security_question",type:"text"},{field:"security_answer",type:"text"},{field:"bonus_code",type:"text"},{field:"gender",type:"radio",required:!0,step:1},{field:"title",type:"text"},{field:"never_call",type:"checkbox",default:!1},{field:"send_payment_confirmation",type:"checkbox",default:!1},{field:"receive_promos",type:"checkbox",default:!1,step:2},{field:"receive_newsletters",type:"checkbox",default:!1},{field:"receive_sms_promos",type:"checkbox",default:!1},{field:"receive_all_promos",type:"checkbox",parents:["receive_promos","receive_sms_promos"],scope:"profile",default:!1},{field:"age_acceptance",type:"checkbox",translate_value:{age:18},default:!1},{field:"terms_acceptance",type:"checkbox",default:!1},{field:"age_terms_acceptance",type:"checkbox",parents:["terms_acceptance","age_acceptance"],scope:"profile",required:!0,translate_value:{age:18},default:!1,step:1},{field:"captcha",type:"captcha",step:2}])}(),function(){function e(e,t,n,a){function r(e,t){n.constructErrorsObject(),o()?e&&n.openSignUp():n.submit(e,t)}function o(){return Boolean(Object.keys(n.registration.errors).length)}e.columns=e.columns||1,e.submit=r,e.changeStep=n.changeStep,n.init().then(function(){if(t.params.errors&&n.setErrors(t.params.errors),e.registration=n.registration,e.checkboxAfter){var r=n.getFields().filter(function(e){return"checkbox"!==e.localData.type}),o=n.getFields().filter(function(e){return"checkbox"===e.localData.type}),i=parseInt(e.checkboxAfter)==e.checkboxAfter?e.checkboxAfter:e.columns;e.registrationFields=n.getFieldsColumn(r,e.columns),e.registrationFieldsCheckbox=n.getFieldsColumn(o,i),a.get("registration_model")&&e.isModal&&n.showErrors(a.get("registration_model"))}else e.registrationFields=n.getFieldsColumn(n.getFields(),e.columns)})}e.$inject=["$scope","$state","FormRegistrationService","localStorageService"],angular.module("casino.controllers").controller("FormRegistration",e)}(),CasinoDirectives.directive("casinoFormRegistration",[function(){return{restrict:"E",replace:!0,scope:{columns:"@columns",checkboxAfter:"@checkboxAfter",isModal:"@"},templateUrl:function(e,t){return"/app/Auth/Registration/FormRegistration/_"+(t.template||"form_registration")+".html"},controller:"FormRegistration"}}]),CasinoFilters.filter("registrationOrder",["$filter",function(e){return function(t){return e("orderBy")(t,function(e){return e.localData.order})}}]),function(){function e(e,t,n,a,r,o,i,s,c,u,l,d,f){function m(){var e=s.defer();return r.player_fields().$promise.then(function(t){H.fields=p(t.contexts.registration,t.fields),N({hardReload:!0}),e.resolve(H.fields)}),e.promise}function p(e,t){var n=e.map(function(e){return t.find(function(t){return t.field===e})}),a=n.map(function(e){return e.scope="user",z[e.field]?(e.localData=z[e.field],e.localData.step&&e.localData.step>H.steps&&(H.steps=e.localData.step),z[e.field].required&&(e.required=z[e.field].required)):(e.localData={field:e.field,type:"text"},console.error("Unknown '"+e.field+"' field in REGISTRATION constant.")),e[e.scope]||(e[e.scope]=[]),e.name=e.field,e[e.scope].push(e),e=E(e)});return H.steps&&(H.currentStep=1),a=A(a),W=a,a=C(a),a=a.map(function(e){return e.onChangeCallback=e.onChangeCallback||function(){R(e)},e.validation.length&&(e.onBlurCallback=function(){T(e)}),e}),a=_.sortBy(a,function(e){return e.localData.order})}function g(){return H.fields}function h(e,t){if(H.steps)return y(e);var n=-1,a=Math.ceil(e.length/t),r=[];return e.forEach(function(e,t){t%a==0&&(n++,r[n]=[]),r[n].push(e)}),r}function y(e){var t=[];t.length=H.steps;var n=Array.from(t,function(){return[]});return e.reduce(function(e,t){return e[t.localData.step-1]||(e[t.localData.step-1]=[]),e[t.localData.step-1].push(t),e},n)}function v(e){var t;return t=H.fields.find(function(t){return t.field===e}),t||(t=W.find(function(t){return t.field===e})),t}function b(e){var t={data:{user:{}}};return t.data.user={},e.data.user&&Object.keys(e.data.user).forEach(function(n){var a=_.find(e.fields,function(e){return e.field==n});if(a&&a.parents?a.localData.parents.forEach(function(a){t.data.user[a.name]=e.data.user[n]}):t.data.user[n]=e.data.user[n],"date_of_birth"===n){var r=new Date(t.data.user[n]);t.data.user[n]=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()}}),e.data.profile&&Object.keys(e.data.profile).forEach(function(n){var a=_.find(e.fields,function(e){return e.field==n});if(a&&a.parents?a.localData.parents.forEach(function(a){t.data.user[a.name]=e.data.profile[n]}):t.data.user[n]=e.data.profile[n],"date_of_birth"===n){var r=new Date(t.data.user[n]);t.data.user[n]=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()}}),t}function $(e,t){if(t=t||S,l.checkAuth("auth_actions_forbidden",!1))return!1;var n=b(H);a.registration(n,function(){x(),t(H)},function(t){H.errors=t;for(var n in t){var a=_.find(H.fields,function(e){return e.field==n||e.parents&&e.parents.indexOf(n)>-1});a&&a.parents?H.errors[a.name]=_.extend(H.errors[a.name]||{},t[n]):H.errors[n]=t[n]}if(t.profile){for(var n in t.profile){var a=_.find(H.fields,function(e){return e.field==n||e.parents&&e.parents.indexOf(n)>-1});a&&a.parents?H.errors[a.name]=_.extend(H.errors[a.name]||{},t.profile[n]):H.errors[n]=t.profile[n],a||(H.commonErrors[n]=t[n])}delete t.profile}k(),e&&B()})}function S(t){c.show("devise.registrations.signed_up_but_unconfirmed",{classes:"alert-success"}),e.mainModal.close(),t.data={},t.fields={},t.errors={},u.go("home")}function w(e){H.errors=e}function C(e){var t=_.filter(z,function(t){var n=!1;return t.parents&&(n=_.every(t.parents,function(t){return _.find(e,function(e){return e.field==t})})),n});return t=t.map(function(t){if(t.localData=_.clone(t),t.name=t.field,t.validation=t.validation||[],t.localData.required){t.required=t.localData.required;var n={type:"required"};t.validation.unshift(n)}return t.localData.parents=t.parents.map(function(t){return _.find(e,function(e){return e.field==t})}),e=_.reject(e,function(e){return t.parents.indexOf(e.field)>-1}),t}),e=e.concat(t)}function A(e){return e.map(function(e){if(e.validation=_.clone(e.localData.validation)||[],e.length&&!1!==e.localData.required&&!1!==e.validation.required){var t=e.validation.find(function(e){return"min_length"===e.type});e.length.minimum&&(t?t.value=e.length.minimum:(t={type:"min_length",value:e.length.minimum},e.validation.push(t)));var n=e.validation.find(function(e){return"max_length"===e.type});e.length.maximum&&(n?n.value=e.length.maximum:(n={type:"max_length",value:e.length.maximum},e.validation.push(n)))}if(e.format&&e.format.with&&e.format.with[0]&&"special_symbol"===e.format.with[0].message&&"password_confirmation"!==e.field){var a={type:"special_symbol",value:e.format.with[0].regexp};e.validation.push(a)}if(e.localData.required){var r={type:"required"};e.validation.unshift(r)}}),e}function E(n){var a=function(){var t=e.Info.currencies,n={};return t&&Object.keys(t).forEach(function(e){l.isRestricted("currency",t[e].code)||"FUN"==t[e].code||(n[t[e].code]=t[e].code)}),n},r=function(){return{m:i.instant("common.genders.m"),f:i.instant("common.genders.f")}},o=function(){var t=e.Info.locales,n={};return t&&Object.keys(t).forEach(function(e){n[t[e]]=t[e].name_in_locale}),n},s=function(){var t=e.Info.time_zones,n={};return t&&Object.keys(t).forEach(function(e){n[t[e].code]=t[e].name}),n},c=function(){var t=e.Info.countries,n={};return t&&Object.keys(t).forEach(function(e){n[t[e].code]=t[e].name}),n};switch(n.field){case"gender":n.inclusion={},n.inclusion.in=r(),D(n),e.$on("$translateChangeSuccess",function(){n.inclusion.in=r(),D(n)});break;case"currency":n.inclusion={},n.inclusion.in=a(),D(n),n.onChangeCallback=_.debounce(function(){R(n),N({hardReload:!0})},1),e.$watch("Info.currencies",function(){n.inclusion.in=a(),D(n)},!0);break;case"language":n.inclusion={},n.inclusion.in=o(),D(n),e.$on("$translateChangeSuccess",function(){n.inclusion.in=o(),D(n)},!0);break;case"time_zone":n.inclusion={},n.inclusion.in=s(),D(n),e.$watch("Info.time_zones",function(){n.inclusion.in=s(),D(n)},!0);break;case"mobile_phone":case"phone":n.inclusion={},n.inclusion.in=e.Info.country_codes||{},n.localData.default=e.data.current_ip&&n.inclusion.in[e.data.current_ip.country_code],D(n),e.$watch("Info.country_codes",function(){n.inclusion.in=e.Info.country_codes||{},e.data.current_ip&&n.inclusion.in[e.data.current_ip.country_code]&&(n.localData.default=n.inclusion.in[e.data.current_ip.country_code],D(n),n.onDefaulValueChange&&t(n.onDefaulValueChange,1))},!0);break;case"country":case"nationality":n.inclusion={},n.inclusion.in=c(),e.data.current_ip&&n.inclusion.in[e.data.current_ip.country_code]&&(n.localData.default=e.data.current_ip.country_code),D(n),n.onChangeCallback=function(){R(n),N({hardReload:!0})},e.$watch("Info.countries",function(){n.inclusion.in=c(),e.data.current_ip&&n.inclusion.in[e.data.current_ip.country_code]&&(n.localData.default=e.data.current_ip.country_code,n.onDefaulValueChange&&t(n.onDefaulValueChange,1)),D(n)},!0);break;case"bonus_code":D(n),n.onChangeCallback=_.debounce(function(){R(n),N({hardReload:!0})},500);break;case"password":case"password_confirmation":break;default:D(n)}return n}function I(e){H.disableNextStep=M(!0),Object.keys(e).forEach(function(t){var n=e[t],a=H.fields.find(function(e){return e.field===t});a&&"string"==typeof n&&n&&T(a)})}function T(e){var t=L(e);t?H.errors[e.field]=t:delete H.errors[e.field]}function L(e,t){var n=H.data.profile&&H.data.profile[e.field],a={input:void 0!==t?t:H.data.user[e.field]||n,conditions:e.validation,fieldsData:H.data[e.scope],customFields:H.customFields};return d.checkAll(a)}function P(){H.errors={},H.fields.forEach(T),!n.PASSWORD_STRENGTH.AVAILABLE||H.errors.password||H.isPasswordStrong||(H.errors.password={weak_password:"frontend.errors.messages.weak_password"}),k()}function k(){var e=Object.keys(H.errors);if(e.length&&H.steps){var t=H.fields.find(function(t){return e.includes(t.field)});H.currentStep=t?t.localData.step:H.steps,t.localData.step||console.error("FormRegistrationConstants.js file has incorrect data!")}}function R(e){if(-1===["password","password_confirmation","mobile_phone","phone"].indexOf(e.field)){var t=f.get("registration_model")||{};if(t[e.field]=H.data.user&&H.data.user[e.field],t.date_of_birth){var n=new Date(t.date_of_birth);t.date_of_birth=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()}f.set("registration_model",t)}H.fields.length&&(H.disableNextStep=M())}function O(e){G(),H.currentStep+=e,H.disableNextStep=M()}function M(e){var t=H.steps?H.fields.filter(function(e){return e.localData.step===H.currentStep}):H.fields;return _.some(t,function(t){return L(t,e&&t.localData.value)})}function x(){f.remove("registration_model")}function D(t){H.data[t.scope]=H.data[t.scope]||{};var n=f.get("registration_model");n&&n[t.field]?("date_of_birth"===t.field&&(n[t.field]=new Date(n[t.field])),H.data[t.scope][t.field]=n[t.field]):t.localData.default?"currency"===t.field&&e.data.current_ip?H.data[t.scope][t.field]=U(e.data.current_ip.country_code,t):H.data[t.scope][t.field]=t.localData.default:t.localData.is_hidden&&t.inclusion&&t.inclusion.in&&(H.data[t.scope][t.field]=Object.keys(t.inclusion.in)[0])}function U(e,t){var n=t.inclusion.in,a=t.localData.default.country;return a?Object.keys(a).find(function(t){return _.contains(a[t],e)&&n[t]})||t.localData.default.value:t.localData.default}function B(){u.go("app.users_sign_up",{lang:e.currentLocale})}function N(t){t=t||{};var n=angular.copy(H.data.user);delete n.password,delete n.password_confirmation,t.hardReload?e.$broadcast("fetchBonusPreview",n):e.$broadcast("refreshBonusPreview",n)}function F(){return H.data.user&&H.data.user.groups}function j(e){H.data.user=H.data.user||{},H.data.user.groups=e}function G(){setTimeout(function(){var e=document.querySelectorAll(".modal-dialog input"),t=Array.from(e).find(function(e){return(!e.value.length||"on"===e.value)&&"hidden"!==e.style.visibility});t&&t.focus()},100)}n.PASSWORD_STRENGTH=n.PASSWORD_STRENGTH||{};var H={data:{},fields:[],customFields:{},errors:{},commonErrors:{},isPasswordStrong:!0,steps:0,disableNextStep:!1},z={},W=[];return o.forEach(function(e,t){e.order=t,z[e.field]=e}),e.$on("authLoginFormSuccess",x),e.$on("authLogoutSuccess",function(){H.data.user={}}),{registration:H,init:m,getFieldsColumn:h,getFields:g,getFieldByName:v,submit:$,setErrors:w,showErrors:I,constructErrorsObject:P,prepareData:b,openSignUp:B,setUserGroups:j,getUserGroups:F,refreshBonusPreview:N,changeStep:O,checkValidation:T}}e.$inject=["$rootScope","$timeout","SYSTEM","Auth","Info","REGISTRATION","$translate","$q","Notification","$state","Restrictions","FormValidation","localStorageService"],angular.module("casino.services").factory("FormRegistrationService",e)}(),function(){function e(e,t){function n(e){e.value&&e.value.currentValue&&e.value.currentValue.guesses>1&&a(e.value.currentValue)}function a(n){t.checkValidation(_.findWhere(t.registration.fields,{field:"password"}));var a=t.registration.errors.password;a&&(n.score=0);var o=n.score/r.max;o<=.25||a?r.type="danger":o<=.5?r.type="warning":o<=.75?r.type="info":o<=1&&(r.type="success"),r.score=n.score||1,t.registration.isPasswordStrong=n.score>e.PASSWORD_STRENGTH.SCORE}var r=this;e.PASSWORD_STRENGTH=e.PASSWORD_STRENGTH||{},e.PASSWORD_STRENGTH.SCORE=e.PASSWORD_STRENGTH.SCORE||0,r.type=null,r.score=0,r.max=r.max?r.max:100,this.$onChanges=n}e.$inject=["SYSTEM","FormRegistrationService"],angular.module("casino").component("passwordStrength",{templateUrl:"/app/Auth/Registration/PasswordStrength/password-strength.component.html",bindings:{value:"<",max:"@?"},controller:e})}(),function(){function e(e){function t(t){e.setUserGroups(t),n.currentUserGroups=e.getUserGroups()}var n=this;n.currentUserGroups=[],n.setUserGroups=t}e.$inject=["FormRegistrationService"],angular.module("casino").component("registrationGroupsSetting",{templateUrl:["$element","$attrs",function(e,t){return"/app/Auth/Registration/RegistrationGroupsSetting/_"+(t.template||"main")+".html"}],controller:e})}(),function(){function e(e){function t(){n()}function n(){var e=document.querySelector("[telegram-widget]");document.querySelectorAll("[telegram-widget]").forEach(function(e){for(;e.firstChild;)e.removeChild(e.firstChild)});var t=document.createElement("script");t.type="text/javascript",t.src="https://telegram.org/js/telegram-widget.js?7",t.setAttribute("data-telegram-login",r.provider.bot_name),t.setAttribute("data-size","large"),t.setAttribute("data-onauth","onTelegramAuth(user)"),t.setAttribute("data-request-access","write"),e.appendChild(t)}function a(t){
var n=Object.keys(t).map(function(e){return e+"="+t[e]}).join("&");e.location.href=e.location.protocol+"//"+e.location.host+r.provider.callback_route+"?"+n}var r=this;r.$onInit=t,e.onTelegramAuth=a}e.$inject=["$window"],angular.module("casino").component("telegramButton",{templateUrl:["$element","$attrs",function(e,t){return"/app/Auth/Social/TelegramButton/_"+(t.template||"main")+".html"}],controller:e,bindings:{provider:"<",close:"&",dismiss:"&"}}),angular.module("casino").controller("TelegramButtonCtrl",e)}(),function(){function e(e,t,n){function a(){i.data=n.list,o()}function r(){var e,a=_.pick(i.filters,function(e,t){return"date_from"!==t&&"date_to"!==t||(e=null),e});i.current_page=1,e=t("filter")(n.list,a),(i.filters.date_from||i.filters.date_to)&&(e=t("filter")(e,function(e){var t=!0;return i.filters.date_from&&new Date(i.filters.date_from)>new Date(e.valid_until)&&(t=!1),i.filters.date_to&&new Date(i.filters.date_to)<new Date(e.valid_until)&&(t=!1),t})),i.data=e}function o(){i.filters={currency:null,stage:null,date_from:null,date_to:null},r()}var i=this;i.BonusHistoryService=n,i.data=[],i.current_page=1,i.date_format="MMM d, y",i.applyFilters=r,i.clearFilters=o,a(),e.$on("bonusesHistoryRefreshSuccess",a)}e.$inject=["$rootScope","$filter","BonusHistoryService"],angular.module("casino.profile").component("profileHistoryBonuses",{templateUrl:"/app/Profile/components/History/Bonuses/_bonus-history.html",bindings:{itemsOnPage:"@?"},controller:e})}(),function(){function e(e,t){function n(){r.list=t.data.bonuses,r.filters=a(t.data.bonuses),e.$broadcast("bonusesHistoryRefreshSuccess")}function a(e){var t={stages:[],currencies:[]};return e.map(function(e){t.stages.push(e.stage),t.currencies.push(e.currency)}),t.stages=_.uniq(t.stages),t.currencies=_.uniq(t.currencies),t}var r={available:!0,filters:{stages:[],currencies:[]},list:[]};return n(),e.$on("bonusesRefreshSuccess",n),r}e.$inject=["$rootScope","BonusesService"],angular.module("casino.profile").factory("BonusHistoryService",e)}(),function(){function e(e,t,n,a){function r(){c.data=n.list,i()}function o(){var e,a=_.pick(c.filters,function(e,t){return"date_from"!==t&&"date_to"!==t||(e=null),e});c.current_page=1,e=t("filter")(n.list,a),(c.filters.date_from||c.filters.date_to)&&(e=t("filter")(e,function(e){var t=!0;return c.filters.date_from&&new Date(c.filters.date_from)>new Date(e.created_at)&&(t=!1),c.filters.date_to&&new Date(c.filters.date_to)<new Date(e.created_at)&&(t=!1),t})),c.data=e}function i(){c.filters={action:null,currency:null,payment_system:null,status:null,date_from:null,date_to:null},o()}function s(e){a.recallById(e)}var c=this;c.TransactionsHistoryService=n,c.data=[],c.current_page=1,c.date_format="MMM d, y",c.applyFilters=o,c.clearFilters=i,c.recall=s,e.$on("transactionsHistoryRefreshSuccess",r),function(){n.refreshPayments()}()}e.$inject=["$rootScope","$filter","TransactionsHistoryService","PlayerPaymentsService"],angular.module("casino.profile").component("profileHistoryTransactions",{templateUrl:"/app/Profile/components/History/Transactions/_transactions-history.html",bindings:{itemsOnPage:"@?"},controller:e})}(),function(){function e(e,t){function n(){r.list=t.data.payments,r.filters=a(t.data.payments),e.$broadcast("transactionsHistoryRefreshSuccess")}function a(e){var t={actions:[],currencies:[],paymentSystems:[],statuses:[]};return e.map(function(e){t.actions.push(e.action),t.currencies.push(e.currency),t.paymentSystems.push(e.payment_system),t.statuses.push(e.status)}),t.actions=_.uniq(t.actions),t.currencies=_.uniq(t.currencies),t.paymentSystems=_.uniq(t.paymentSystems),t.statuses=_.uniq(t.statuses),t}var r={available:!0,filters:{actions:[],currencies:[],paymentSystems:[],statuses:[]},list:[],refreshPayments:t.refresh};return n(),e.$on("playerPaymentsInited",n),e.$on("playerPaymentsRefreshSuccess",n),r}e.$inject=["$rootScope","PlayerPaymentsService"],angular.module("casino.profile").factory("TransactionsHistoryService",e)}(),function(){function e(e,t,n,a){function r(){s.data=n.list,i()}function o(){var e,a=_.pick(s.filters,function(e,t){return"date_to"!==t&&"date_from"!==t||(e=null),e});s.current_page=1,e=t("filter")(n.list,a),(s.filters.date_from||s.filters.date_to)&&(e=t("filter")(e,function(e){var t=!0;return s.filters.date_from&&new Date(s.filters.date_from)>new Date(e.finished_at)&&(t=!1),s.filters.date_to&&new Date(s.filters.date_to)<new Date(e.finished_at)&&(t=!1),t})),s.data=e}function i(){s.filters={game:null,currency:null,date_from:null,date_to:null},o()}var s=this;s.BetsHistoryService=n,s.data=[],s.current_page=1,s.date_format="MMM d, y",s.applyFilters=o,s.clearFilters=i,a.init(),r(),e.$on("betsHistoryRefreshSuccess",r)}e.$inject=["$rootScope","$filter","BetsHistoryService","BetsService"],angular.module("casino.profile").component("profileHistoryBets",{templateUrl:"/app/Profile/components/History/Bets/_bets-history.html",bindings:{itemsOnPage:"@?"},controller:e})}(),function(){function e(e,t){function n(){r.list=t.data.bets,r.filters=a(t.data.bets),e.$broadcast("betsHistoryRefreshSuccess")}function a(e){var t={games:[],currencies:[]};return e.map(function(e){t.games.push(e.game_title),t.currencies.push(e.currency)}),t.games=_.uniq(t.games),t.currencies=_.uniq(t.currencies),t}var r={available:!0,filters:{games:[],currencies:[]},list:[]};return n(),e.$on("betsRefreshSuccess",n),r}e.$inject=["$rootScope","BetsService"],angular.module("casino.profile").factory("BetsHistoryService",e)}(),function(){function e(e){function t(){a.bonusPreviewItem=a.bonusPreviewItem||{},a.bonusPreviewItem.fields=a.bonusPreviewItem.attributes.reduce(function(t,n){return t[n.field]={value:e("bonus_preview_localized_value")(n,{currency:a.currency}),localized_field:n.localized_field,order:n.order},t},{})}function n(e){a.onSelectBonus({bonusPreviewItem:e})}var a=this;a.$onChanges=t,a.onSelect=n,t()}e.$inject=["$filter"],angular.module("casino").component("bonusPreviewItem",{templateUrl:["$element","$attrs",function(e,t){return"/app/Users/Bonuses/BonusesPreview/BonusPreviewItem/_"+(t.template||"main")+".html"}],bindings:{type:"<",currency:"<",bonusPreviewItem:"<",itemIndex:"<",bonusesNumberInGroup:"<",onSelectBonus:"&"},controller:e})}(),function(){function e(e,t,n,a){function r(){a.data.limitsExistence.deposit&&(t.limits=a.data.limits.filter(s))}function o(){t.accumulated_loss=null,t.accumulated_loss_null=!1,t.limits=[],t.$close()}function i(){a.showModal()}function s(e){return c.includes(e.status)}var c=["active","unconfirmed_disable","confirmed_disable"];t.limits=[],t.accumulated_loss=null,t.accumulated_loss_null=!1,t.showSetLimitsModal=i,e.$on("limitsRefreshSuccess",r),function(){n.accumulated_loss(function(e){t.accumulated_loss=e,t.accumulated_loss_null=angular.equals({},e)}),r()}(),e.$on("authLogoutSuccess",o)}e.$inject=["$rootScope","$scope","Player","LimitsService"],angular.module("casino").controller("LoginLimitsCtrl",e)}(),function(){function e(e){function t(){e.show("",{classes:"login-limits",position:"right",duration:"0",templateUrl:"/app/modules/license/SGA/Login-limits/_login-limits.html"})}return{init:t}}e.$inject=["Notification"],angular.module("casino").factory("LoginLimitsService",e)}(),function(){function e(e,t,n){function a(a,o,i,s){t(function(){o&&o.provider||r.provider?(r.gameLicenseHint=n.getByProvider(r.provider),s&&s[r.gridItemNumber].game===o&&(e.$apply(function(){r.isShown=!r.gameLicenseHint}),r.isShown=r.gameLicenseHint)):(e.$apply(function(){r.isShown=!0}),r.isShown=!1)})}var r=this;r.isShown=!0,r.gameLicenseHint="",a(),e.$on("gameOpenSuccess",a)}e.$inject=["$scope","$timeout","GameLicenseHintService"],angular.module("licenseMGA").component("gameLicenseHint",{templateUrl:"/app/modules/license/Malta/GameLicenseHint/_game-license-hint.html",bindings:{provider:"=",gridItemNumber:"="},controller:e})}(),function(){function e(e){function t(t){var n;return e.MGA&&e.MGA&&e.MGA.game_license_hint.some(function(e){return e.provider.only&&e.provider.only.includes(t)?(n=e.translate_key,!0):e.provider.except&&!e.provider.except.includes(t)?(n=e.translate_key,!0):void 0}),n}return{getByProvider:t}}e.$inject=["SYSTEM"],angular.module("licenseMGA").factory("GameLicenseHintService",e)}();